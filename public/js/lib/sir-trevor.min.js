!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.SirTrevor=t()}}(function(){var t;return function e(t,n,r){function i(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return i(n?n:e)},l,l.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e){e.exports=t("./src/")},{"./src/":176}],2:[function(){!function(){if(!Array.prototype.find){var t=function(t){var e=Object(this),n=e.length<0?0:e.length>>>0;if(0===n)return void 0;if("function"!=typeof t||"[object Function]"!==Object.prototype.toString.call(t))throw new TypeError("Array#find: predicate must be a function");for(var r,i=arguments[1],o=0;n>o;o++)if(r=e[o],t.call(i,r,o,e))return r;return void 0};if(Object.defineProperty)try{Object.defineProperty(Array.prototype,"find",{value:t,configurable:!0,enumerable:!1,writable:!0})}catch(e){}Array.prototype.find||(Array.prototype.find=t)}}(this)},{}],3:[function(e,n,r){!function(e,i){"function"==typeof t&&t.amd?t("eventable",function(){return e.Eventable=i()}):"undefined"!=typeof r?n.exports=i():e.Eventable=i()}(this,function(){function t(t){var e,n=2;return function(){return--n>0?e=t.apply(this,arguments):t=null,e}}function e(t,e){i[t]=function(t,n,r){var i=this._listeners||(this._listeners={}),o=t._listenerId||(t._listenerId=(new Date).getTime());return i[o]=t,"object"==typeof n&&(r=this),t[e](n,r,this),this}}var n=[],r=n.slice,i={on:function(t,e,n){if(!s(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var r=this._events[t]||(this._events[t]=[]);return r.push({callback:e,context:n,ctx:n||this}),this},once:function(e,n,r){if(!s(this,"once",e,[n,r])||!n)return this;var i=this,o=t(function(){i.off(e,o),n.apply(this,arguments)});return o._callback=n,this.on(e,o,r)},off:function(t,e,n){var r,i,o,a,u,c,l,f;if(!this._events||!s(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events={},this;for(a=t?[t]:Object.keys(this._events),u=0,c=a.length;c>u;u++)if(t=a[u],o=this._events[t]){if(this._events[t]=r=[],e||n)for(l=0,f=o.length;f>l;l++)i=o[l],(e&&e!==i.callback&&e!==i.callback._callback||n&&n!==i.context)&&r.push(i);r.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=r.call(arguments,1);if(!s(this,"trigger",t,e))return this;var n=this._events[t],i=this._events.all;return n&&a(n,e),i&&a(i,arguments),this},stopListening:function(t,e,n){var r=this._listeners;if(!r)return this;var i=!e&&!n;"object"==typeof e&&(n=this),t&&((r={})[t._listenerId]=t);for(var o in r)r[o].off(e,n,this),i&&delete this._listeners[o];return this}},o=/\s+/,s=function(t,e,n,r){if(!n)return!0;if("object"==typeof n){for(var i in n)t[e].apply(t,[i,n[i]].concat(r));return!1}if(o.test(n)){for(var s=n.split(o),a=0,u=s.length;u>a;a++)t[e].apply(t,[s[a]].concat(r));return!1}return!0},a=function(t,e){var n,r=-1,i=t.length,o=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++r<i;)(n=t[r]).callback.call(n.ctx);return;case 1:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o);return;case 2:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o,s);return;case 3:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o,s,a);return;default:for(;++r<i;)(n=t[r]).callback.apply(n.ctx,e)}};return e("listenTo","on"),e("listenToOnce","once"),i.bind=i.on,i.unbind=i.off,i})},{}],4:[function(t,e){function n(t){var e=!0;if(!t)return e;var n=l.call(t),c=t.length;return n==s||n==u||n==o||n==a&&"number"==typeof c&&i(t.splice)?!c:(r(t,function(){return e=!1}),e)}var r=t("lodash.forown"),i=t("lodash.isfunction"),o="[object Arguments]",s="[object Array]",a="[object Object]",u="[object String]",c=Object.prototype,l=c.toString;e.exports=n},{"lodash.forown":5,"lodash.isfunction":28}],5:[function(t,e){var n=t("lodash._basecreatecallback"),r=t("lodash.keys"),i=t("lodash._objecttypes"),o=function(t,e,o){var s,a=t,u=a;if(!a)return u;if(!i[typeof a])return u;e=e&&"undefined"==typeof o?e:n(e,o,3);for(var c=-1,l=i[typeof a]&&r(a),f=l?l.length:0;++c<f;)if(s=l[c],e(a[s],s,t)===!1)return u;return u};e.exports=o},{"lodash._basecreatecallback":6,"lodash._objecttypes":24,"lodash.keys":25}],6:[function(t,e){function n(t,e,n){if("function"!=typeof t)return i;if("undefined"==typeof e||!("prototype"in t))return t;var l=t.__bindData__;if("undefined"==typeof l&&(s.funcNames&&(l=!t.name),l=l||!s.funcDecomp,!l)){var f=c.call(t);s.funcNames||(l=!a.test(f)),l||(l=u.test(f),o(t,l))}if(l===!1||l!==!0&&1&l[1])return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,o){return t.call(e,n,r,i,o)}}return r(t,e)}var r=t("lodash.bind"),i=t("lodash.identity"),o=t("lodash._setbinddata"),s=t("lodash.support"),a=/^\s*function[ \n\r\t]+\w/,u=/\bthis\b/,c=Function.prototype.toString;e.exports=n},{"lodash._setbinddata":7,"lodash.bind":10,"lodash.identity":21,"lodash.support":22}],7:[function(t,e){var n=t("lodash._isnative"),r=t("lodash.noop"),i={configurable:!1,enumerable:!1,value:null,writable:!1},o=function(){try{var t={},e=n(e=Object.defineProperty)&&e,r=e(t,t,t)&&e}catch(i){}return r}(),s=o?function(t,e){i.value=e,o(t,"__bindData__",i)}:r;e.exports=s},{"lodash._isnative":8,"lodash.noop":9}],8:[function(t,e){function n(t){return"function"==typeof t&&o.test(t)}var r=Object.prototype,i=r.toString,o=RegExp("^"+String(i).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$");e.exports=n},{}],9:[function(t,e){function n(){}e.exports=n},{}],10:[function(t,e){function n(t,e){return arguments.length>2?r(t,17,i(arguments,2),null,e):r(t,1,null,null,e)}var r=t("lodash._createwrapper"),i=t("lodash._slice");e.exports=n},{"lodash._createwrapper":11,"lodash._slice":20}],11:[function(t,e){function n(t,e,a,l,f,d){var h=1&e,p=2&e,m=4&e,v=16&e,b=32&e;if(!p&&!o(t))throw new TypeError;v&&!a.length&&(e&=-17,v=a=!1),b&&!l.length&&(e&=-33,b=l=!1);var g=t&&t.__bindData__;if(g&&g!==!0)return g=s(g),g[2]&&(g[2]=s(g[2])),g[3]&&(g[3]=s(g[3])),!h||1&g[1]||(g[4]=f),!h&&1&g[1]&&(e|=8),!m||4&g[1]||(g[5]=d),v&&u.apply(g[2]||(g[2]=[]),a),b&&c.apply(g[3]||(g[3]=[]),l),g[1]|=e,n.apply(null,g);var _=1==e||17===e?r:i;return _([t,e,a,l,f,d])}var r=t("lodash._basebind"),i=t("lodash._basecreatewrapper"),o=t("lodash.isfunction"),s=t("lodash._slice"),a=[],u=a.push,c=a.unshift;e.exports=n},{"lodash._basebind":12,"lodash._basecreatewrapper":16,"lodash._slice":20,"lodash.isfunction":28}],12:[function(t,e){function n(t){function e(){if(a){var t=s(a);u.apply(t,arguments)}if(this instanceof e){var o=r(n.prototype),l=n.apply(o,t||arguments);return i(l)?l:o}return n.apply(c,t||arguments)}var n=t[0],a=t[2],c=t[4];return o(e,t),e}var r=t("lodash._basecreate"),i=t("lodash.isobject"),o=t("lodash._setbinddata"),s=t("lodash._slice"),a=[],u=a.push;e.exports=n},{"lodash._basecreate":13,"lodash._setbinddata":7,"lodash._slice":20,"lodash.isobject":29}],13:[function(t,e){(function(n){function r(t){return o(t)?s(t):{}}var i=t("lodash._isnative"),o=t("lodash.isobject"),s=(t("lodash.noop"),i(s=Object.create)&&s);s||(r=function(){function t(){}return function(e){if(o(e)){t.prototype=e;var r=new t;t.prototype=null}return r||n.Object()}}()),e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"lodash._isnative":14,"lodash.isobject":29,"lodash.noop":15}],14:[function(t,e,n){arguments[4][8][0].apply(n,arguments)},{dup:8}],15:[function(t,e,n){arguments[4][9][0].apply(n,arguments)},{dup:9}],16:[function(t,e){function n(t){function e(){var t=p?d:this;if(l){var o=s(l);u.apply(o,arguments)}if((f||v)&&(o||(o=s(arguments)),f&&u.apply(o,f),v&&o.length<h))return c|=16,n([a,b?c:-4&c,o,null,d,h]);if(o||(o=arguments),m&&(a=t[g]),this instanceof e){t=r(a.prototype);var _=a.apply(t,o);return i(_)?_:t}return a.apply(t,o)}var a=t[0],c=t[1],l=t[2],f=t[3],d=t[4],h=t[5],p=1&c,m=2&c,v=4&c,b=8&c,g=a;return o(e,t),e}var r=t("lodash._basecreate"),i=t("lodash.isobject"),o=t("lodash._setbinddata"),s=t("lodash._slice"),a=[],u=a.push;e.exports=n},{"lodash._basecreate":17,"lodash._setbinddata":7,"lodash._slice":20,"lodash.isobject":29}],17:[function(t,e,n){arguments[4][13][0].apply(n,arguments)},{dup:13,"lodash._isnative":18,"lodash.isobject":29,"lodash.noop":19}],18:[function(t,e,n){arguments[4][8][0].apply(n,arguments)},{dup:8}],19:[function(t,e,n){arguments[4][9][0].apply(n,arguments)},{dup:9}],20:[function(t,e){function n(t,e,n){e||(e=0),"undefined"==typeof n&&(n=t?t.length:0);for(var r=-1,i=n-e||0,o=Array(0>i?0:i);++r<i;)o[r]=t[e+r];return o}e.exports=n},{}],21:[function(t,e){function n(t){return t}e.exports=n},{}],22:[function(t,e){(function(n){var r=t("lodash._isnative"),i=/\bthis\b/,o={};o.funcDecomp=!r(n.WinRTError)&&i.test(function(){return this}),o.funcNames="string"==typeof Function.name,e.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"lodash._isnative":23}],23:[function(t,e,n){arguments[4][8][0].apply(n,arguments)},{dup:8}],24:[function(t,e){var n={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1};e.exports=n},{}],25:[function(t,e){var n=t("lodash._isnative"),r=t("lodash.isobject"),i=t("lodash._shimkeys"),o=n(o=Object.keys)&&o,s=o?function(t){return r(t)?o(t):[]}:i;e.exports=s},{"lodash._isnative":26,"lodash._shimkeys":27,"lodash.isobject":29}],26:[function(t,e,n){arguments[4][8][0].apply(n,arguments)},{dup:8}],27:[function(t,e){var n=t("lodash._objecttypes"),r=Object.prototype,i=r.hasOwnProperty,o=function(t){var e,r=t,o=[];if(!r)return o;if(!n[typeof t])return o;for(e in r)i.call(r,e)&&o.push(e);return o};e.exports=o},{"lodash._objecttypes":24}],28:[function(t,e){function n(t){return"function"==typeof t}e.exports=n},{}],29:[function(t,e){function n(t){return!(!t||!r[typeof t])}var r=t("lodash._objecttypes");e.exports=n},{"lodash._objecttypes":30}],30:[function(t,e,n){arguments[4][24][0].apply(n,arguments)},{dup:24}],31:[function(t,e){function n(t){return"string"==typeof t||t&&"object"==typeof t&&o.call(t)==r||!1}var r="[object String]",i=Object.prototype,o=i.toString;e.exports=n},{}],32:[function(t,e){function n(t){return"undefined"==typeof t}e.exports=n},{}],33:[function(t,e){function n(t,e){if(t){var n=t[e];return r(n)?t[e]():n}}var r=t("lodash.isfunction");e.exports=n},{"lodash.isfunction":28}],34:[function(t,e){function n(t,e,n){var m=a.imports._.templateSettings||a;t=String(t||""),n=r({},n,m);var v,b=r({},n.imports,m.imports),g=o(b),_=u(b),y=0,k=n.interpolate||h,w="__p += '",x=RegExp((n.escape||h).source+"|"+k.source+"|"+(k===s?d:h).source+"|"+(n.evaluate||h).source+"|$","g");t.replace(x,function(e,n,r,o,s,a){return r||(r=o),w+=t.slice(y,a).replace(p,i),n&&(w+="' +\n__e("+n+") +\n'"),s&&(v=!0,w+="';\n"+s+";\n__p += '"),r&&(w+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),y=a+e.length,e}),w+="';\n";var S=n.variable,E=S;E||(S="obj",w="with ("+S+") {\n"+w+"\n}\n"),w=(v?w.replace(c,""):w).replace(l,"$1").replace(f,"$1;"),w="function("+S+") {\n"+(E?"":S+" || ("+S+" = {});\n")+"var __t, __p = '', __e = _.escape"+(v?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+w+"return __p\n}";try{var C=Function(g,"return "+w).apply(void 0,_)}catch(T){throw T.source=w,T}return e?C(e):(C.source=w,C)}var r=t("lodash.defaults"),i=(t("lodash.escape"),t("lodash._escapestringchar")),o=t("lodash.keys"),s=t("lodash._reinterpolate"),a=t("lodash.templatesettings"),u=t("lodash.values"),c=/\b__p \+= '';/g,l=/\b(__p \+=) '' \+/g,f=/(__e\(.*?\)|\b__t\)) \+\n'';/g,d=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,h=/($^)/,p=/['\n\r\t\u2028\u2029\\]/g;e.exports=n},{"lodash._escapestringchar":35,"lodash._reinterpolate":36,"lodash.defaults":37,"lodash.escape":39,"lodash.keys":44,"lodash.templatesettings":48,"lodash.values":49}],35:[function(t,e){function n(t){return"\\"+r[t]}var r={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"};e.exports=n},{}],36:[function(t,e){var n=/<%=([\s\S]+?)%>/g;e.exports=n},{}],37:[function(t,e){var n=t("lodash.keys"),r=t("lodash._objecttypes"),i=function(t,e,i){var o,s=t,a=s;if(!s)return a;for(var u=arguments,c=0,l="number"==typeof i?2:u.length;++c<l;)if(s=u[c],s&&r[typeof s])for(var f=-1,d=r[typeof s]&&n(s),h=d?d.length:0;++f<h;)o=d[f],"undefined"==typeof a[o]&&(a[o]=s[o]);return a};e.exports=i},{"lodash._objecttypes":38,"lodash.keys":44}],38:[function(t,e,n){arguments[4][24][0].apply(n,arguments)},{dup:24}],39:[function(t,e){function n(t){return null==t?"":String(t).replace(i,r)}var r=t("lodash._escapehtmlchar"),i=(t("lodash.keys"),t("lodash._reunescapedhtml"));e.exports=n},{"lodash._escapehtmlchar":40,"lodash._reunescapedhtml":42,"lodash.keys":44}],40:[function(t,e){function n(t){return r[t]}var r=t("lodash._htmlescapes");e.exports=n},{"lodash._htmlescapes":41}],41:[function(t,e){var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};e.exports=n},{}],42:[function(t,e){var n=t("lodash._htmlescapes"),r=t("lodash.keys"),i=RegExp("["+r(n).join("")+"]","g");e.exports=i},{"lodash._htmlescapes":43,"lodash.keys":44}],43:[function(t,e,n){arguments[4][41][0].apply(n,arguments)},{dup:41}],44:[function(t,e,n){arguments[4][25][0].apply(n,arguments)},{dup:25,"lodash._isnative":45,"lodash._shimkeys":46,"lodash.isobject":29}],45:[function(t,e,n){arguments[4][8][0].apply(n,arguments)},{dup:8}],46:[function(t,e,n){arguments[4][27][0].apply(n,arguments)},{dup:27,"lodash._objecttypes":47}],47:[function(t,e,n){arguments[4][24][0].apply(n,arguments)},{dup:24}],48:[function(t,e){var n=t("lodash.escape"),r=t("lodash._reinterpolate"),i={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:r,variable:"",imports:{_:{escape:n}}};e.exports=i},{"lodash._reinterpolate":36,"lodash.escape":39}],49:[function(t,e){function n(t){for(var e=-1,n=r(t),i=n.length,o=Array(i);++e<i;)o[e]=t[n[e]];return o}var r=t("lodash.keys");e.exports=n},{"lodash.keys":44}],50:[function(t,e){function n(t){var e=++r;return String(null==t?"":t)+e}var r=0;e.exports=n},{}],51:[function(t,e){"use strict";var n=t("object-keys"),r=function(t){return"undefined"!=typeof t&&null!==t},i=function(t){if(!r(t))throw new TypeError("target must be an object");var e,i,o,s,a=Object(t);for(e=1;e<arguments.length;++e)for(i=Object(arguments[e]),s=n(i),o=0;o<s.length;++o)a[s[o]]=i[s[o]];return a};i.shim=function(){return Object.assign||(Object.assign=i),Object.assign||i},e.exports=i},{"object-keys":52}],52:[function(t,e){"use strict";var n=Object.prototype.hasOwnProperty,r=Object.prototype.toString,i=t("./isArguments"),o=!{toString:null}.propertyIsEnumerable("toString"),s=function(){}.propertyIsEnumerable("prototype"),a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],u=function(t){var e=null!==t&&"object"==typeof t,u="[object Function]"===r.call(t),c=i(t),l=e&&"[object String]"===r.call(t),f=[];if(!e&&!u&&!c)throw new TypeError("Object.keys called on a non-object");var d=s&&u;if(l&&t.length>0&&!n.call(t,0))for(var h=0;h<t.length;++h)f.push(String(h));if(c&&t.length>0)for(var p=0;p<t.length;++p)f.push(String(p));else for(var m in t)d&&"prototype"===m||!n.call(t,m)||f.push(String(m));if(o)for(var v=t.constructor,b=v&&v.prototype===t,g=0;g<a.length;++g)b&&"constructor"===a[g]||!n.call(t,a[g])||f.push(a[g]);return f};u.shim=function(){return Object.keys||(Object.keys=u),Object.keys||u},e.exports=u},{"./isArguments":53}],53:[function(t,e){"use strict";var n=Object.prototype.toString;e.exports=function(t){var e=n.call(t),r="[object Arguments]"===e;return r||(r="[object Array]"!==e&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===n.call(t.callee)),r}},{}],54:[function(e,n,r){!function(e,i){"object"==typeof r&&"undefined"!=typeof n?n.exports=i():"function"==typeof t&&t.amd?t(i):e.Immutable=i()}(this,function(){"use strict";function t(t,e){e&&(t.prototype=Object.create(e.prototype)),t.prototype.constructor=t}function e(t){return t.value=!1,t}function n(t){t&&(t.value=!0)}function r(){}function i(t,e){e=e||0;for(var n=Math.max(0,t.length-e),r=new Array(n),i=0;n>i;i++)r[i]=t[i+e];return r}function o(t){return void 0===t.size&&(t.size=t.__iterate(a)),t.size}function s(t,e){return e>=0?+e:o(t)+ +e}function a(){return!0}function u(t,e,n){return(0===t||void 0!==n&&-n>=t)&&(void 0===e||void 0!==n&&e>=n)}function c(t,e){return f(t,e,0)}function l(t,e){return f(t,e,e)}function f(t,e,n){return void 0===t?n:0>t?Math.max(0,e+t):void 0===e?t:Math.min(e,t)}function d(t){return v(t)?t:B(t)}function h(t){return b(t)?t:D(t)}function p(t){return g(t)?t:I(t)}function m(t){return v(t)&&!_(t)?t:O(t)}function v(t){return!(!t||!t[hn])}function b(t){return!(!t||!t[pn])}function g(t){return!(!t||!t[mn])}function _(t){return b(t)||g(t)}function y(t){return!(!t||!t[vn])}function k(t){this.next=t}function w(t,e,n,r){var i=0===t?e:1===t?n:[e,n];return r?r.value=i:r={value:i,done:!1},r}function x(){return{value:void 0,done:!0}}function S(t){return!!T(t)}function E(t){return t&&"function"==typeof t.next}function C(t){var e=T(t);return e&&e.call(t)}function T(t){var e=t&&(yn&&t[yn]||t[kn]);return"function"==typeof e?e:void 0}function j(t){return t&&"number"==typeof t.length}function B(t){return null===t||void 0===t?z():v(t)?t.toSeq():R(t)}function D(t){return null===t||void 0===t?z().toKeyedSeq():v(t)?b(t)?t.toSeq():t.fromEntrySeq():q(t)}function I(t){return null===t||void 0===t?z():v(t)?b(t)?t.entrySeq():t.toIndexedSeq():U(t)}function O(t){return(null===t||void 0===t?z():v(t)?b(t)?t.entrySeq():t:U(t)).toSetSeq()}function M(t){this._array=t,this.size=t.length}function N(t){var e=Object.keys(t);this._object=t,this._keys=e,this.size=e.length}function L(t){this._iterable=t,this.size=t.length||t.size}function A(t){this._iterator=t,this._iteratorCache=[]}function $(t){return!(!t||!t[xn])}function z(){return Sn||(Sn=new M([]))}function q(t){var e=Array.isArray(t)?new M(t).fromEntrySeq():E(t)?new A(t).fromEntrySeq():S(t)?new L(t).fromEntrySeq():"object"==typeof t?new N(t):void 0;if(!e)throw new TypeError("Expected Array or iterable object of [k, v] entries, or keyed object: "+t);return e}function U(t){var e=P(t);if(!e)throw new TypeError("Expected Array or iterable object of values: "+t);return e}function R(t){var e=P(t)||"object"==typeof t&&new N(t);if(!e)throw new TypeError("Expected Array or iterable object of values, or keyed object: "+t);return e}function P(t){return j(t)?new M(t):E(t)?new A(t):S(t)?new L(t):void 0}function F(t,e,n,r){var i=t._cache;if(i){for(var o=i.length-1,s=0;o>=s;s++){var a=i[n?o-s:s];if(e(a[1],r?a[0]:s,t)===!1)return s+1}return s}return t.__iterateUncached(e,n)}function H(t,e,n,r){var i=t._cache;if(i){var o=i.length-1,s=0;return new k(function(){var t=i[n?o-s:s];return s++>o?x():w(e,r?t[0]:s-1,t[1])})}return t.__iteratorUncached(e,n)}function K(){throw TypeError("Abstract")}function W(){}function V(){}function Q(){}function J(t,e){return t===e||t!==t&&e!==e?!0:t&&e?("function"==typeof t.valueOf&&"function"==typeof e.valueOf&&(t=t.valueOf(),e=e.valueOf()),"function"==typeof t.equals&&"function"==typeof e.equals?t.equals(e):t===e||t!==t&&e!==e):!1}function G(t,e){return e?X(e,t,"",{"":t}):Y(t)}function X(t,e,n,r){return Array.isArray(e)?t.call(r,n,I(e).map(function(n,r){return X(t,n,r,e)})):Z(e)?t.call(r,n,D(e).map(function(n,r){return X(t,n,r,e)})):e}function Y(t){return Array.isArray(t)?I(t).map(Y).toList():Z(t)?D(t).map(Y).toMap():t}function Z(t){return t&&t.constructor===Object}function tt(t){return t>>>1&1073741824|3221225471&t}function et(t){if(t===!1||null===t||void 0===t)return 0;if("function"==typeof t.valueOf&&(t=t.valueOf(),t===!1||null===t||void 0===t))return 0;if(t===!0)return 1;var e=typeof t;if("number"===e){var n=0|t;for(n!==t&&(n^=4294967295*t);t>4294967295;)t/=4294967295,n^=t;return tt(n)}return"string"===e?t.length>Dn?nt(t):rt(t):"function"==typeof t.hashCode?t.hashCode():it(t)}function nt(t){var e=Mn[t];return void 0===e&&(e=rt(t),On===In&&(On=0,Mn={}),On++,Mn[t]=e),e}function rt(t){for(var e=0,n=0;n<t.length;n++)e=31*e+t.charCodeAt(n)|0;return tt(e)}function it(t){var e=Tn&&Tn.get(t);if(e)return e;if(e=t[Bn])return e;if(!Cn){if(e=t.propertyIsEnumerable&&t.propertyIsEnumerable[Bn])return e;if(e=ot(t))return e}if(Object.isExtensible&&!Object.isExtensible(t))throw new Error("Non-extensible objects are not allowed as keys.");if(e=++jn,1073741824&jn&&(jn=0),Tn)Tn.set(t,e);else if(Cn)Object.defineProperty(t,Bn,{enumerable:!1,configurable:!1,writable:!1,value:e});else if(t.propertyIsEnumerable&&t.propertyIsEnumerable===t.constructor.prototype.propertyIsEnumerable)t.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},t.propertyIsEnumerable[Bn]=e;else{if(!t.nodeType)throw new Error("Unable to set a non-enumerable property on object.");t[Bn]=e}return e}function ot(t){if(t&&t.nodeType>0)switch(t.nodeType){case 1:return t.uniqueID;case 9:return t.documentElement&&t.documentElement.uniqueID}}function st(t,e){if(!t)throw new Error(e)}function at(t){st(t!==1/0,"Cannot perform this action with an infinite size.")}function ut(t,e){this._iter=t,this._useKeys=e,this.size=t.size}function ct(t){this._iter=t,this.size=t.size}function lt(t){this._iter=t,this.size=t.size}function ft(t){this._iter=t,this.size=t.size}function dt(t){var e=Mt(t);return e._iter=t,e.size=t.size,e.flip=function(){return t},e.reverse=function(){var e=t.reverse.apply(this);return e.flip=function(){return t.reverse()},e},e.has=function(e){return t.contains(e)},e.contains=function(e){return t.has(e)},e.cacheResult=Nt,e.__iterateUncached=function(e,n){var r=this;return t.__iterate(function(t,n){return e(n,t,r)!==!1},n)},e.__iteratorUncached=function(e,n){if(e===_n){var r=t.__iterator(e,n);return new k(function(){var t=r.next();if(!t.done){var e=t.value[0];t.value[0]=t.value[1],t.value[1]=e}return t})}return t.__iterator(e===gn?bn:gn,n)},e}function ht(t,e,n){var r=Mt(t);return r.size=t.size,r.has=function(e){return t.has(e)},r.get=function(r,i){var o=t.get(r,ln);return o===ln?i:e.call(n,o,r,t)},r.__iterateUncached=function(r,i){var o=this;return t.__iterate(function(t,i,s){return r(e.call(n,t,i,s),i,o)!==!1},i)},r.__iteratorUncached=function(r,i){var o=t.__iterator(_n,i);return new k(function(){var i=o.next();if(i.done)return i;var s=i.value,a=s[0];return w(r,a,e.call(n,s[1],a,t),i)})},r}function pt(t,e){var n=Mt(t);return n._iter=t,n.size=t.size,n.reverse=function(){return t},t.flip&&(n.flip=function(){var e=dt(t);return e.reverse=function(){return t.flip()},e}),n.get=function(n,r){return t.get(e?n:-1-n,r)},n.has=function(n){return t.has(e?n:-1-n)},n.contains=function(e){return t.contains(e)},n.cacheResult=Nt,n.__iterate=function(e,n){var r=this;return t.__iterate(function(t,n){return e(t,n,r)},!n)},n.__iterator=function(e,n){return t.__iterator(e,!n)},n}function mt(t,e,n,r){var i=Mt(t);return r&&(i.has=function(r){var i=t.get(r,ln);return i!==ln&&!!e.call(n,i,r,t)},i.get=function(r,i){var o=t.get(r,ln);return o!==ln&&e.call(n,o,r,t)?o:i}),i.__iterateUncached=function(i,o){var s=this,a=0;return t.__iterate(function(t,o,u){return e.call(n,t,o,u)?(a++,i(t,r?o:a-1,s)):void 0},o),a},i.__iteratorUncached=function(i,o){var s=t.__iterator(_n,o),a=0;return new k(function(){for(;;){var o=s.next();if(o.done)return o;var u=o.value,c=u[0],l=u[1];if(e.call(n,l,c,t))return w(i,r?c:a++,l,o)}})},i}function vt(t,e,n){var r=$t().asMutable();return t.__iterate(function(i,o){r.update(e.call(n,i,o,t),0,function(t){return t+1})}),r.asImmutable()}function bt(t,e,n){var r=b(t),i=(y(t)?xe():$t()).asMutable();t.__iterate(function(o,s){i.update(e.call(n,o,s,t),function(t){return t=t||[],t.push(r?[s,o]:o),t})});var o=Ot(t);return i.map(function(e){return Bt(t,o(e))})}function gt(t,e,n,r){var i=t.size;if(u(e,n,i))return t;var o=c(e,i),a=l(n,i);if(o!==o||a!==a)return gt(t.toSeq().cacheResult(),e,n,r);var f=a-o;0>f&&(f=0);var d=Mt(t);return d.size=0===f?f:t.size&&f||void 0,!r&&$(t)&&f>=0&&(d.get=function(e,n){return e=s(this,e),e>=0&&f>e?t.get(e+o,n):n}),d.__iterateUncached=function(e,n){var i=this;if(0===f)return 0;if(n)return this.cacheResult().__iterate(e,n);var s=0,a=!0,u=0;return t.__iterate(function(t,n){return a&&(a=s++<o)?void 0:(u++,e(t,r?n:u-1,i)!==!1&&u!==f)}),u},d.__iteratorUncached=function(e,n){if(f&&n)return this.cacheResult().__iterator(e,n);var i=f&&t.__iterator(e,n),s=0,a=0;return new k(function(){for(;s++!==o;)i.next();if(++a>f)return x();var t=i.next();return r||e===gn?t:e===bn?w(e,a-1,void 0,t):w(e,a-1,t.value[1],t)})},d}function _t(t,e,n){var r=Mt(t);return r.__iterateUncached=function(r,i){var o=this;if(i)return this.cacheResult().__iterate(r,i);var s=0;return t.__iterate(function(t,i,a){return e.call(n,t,i,a)&&++s&&r(t,i,o)}),s},r.__iteratorUncached=function(r,i){var o=this;if(i)return this.cacheResult().__iterator(r,i);var s=t.__iterator(_n,i),a=!0;return new k(function(){if(!a)return x();var t=s.next();if(t.done)return t;var i=t.value,u=i[0],c=i[1];return e.call(n,c,u,o)?r===_n?t:w(r,u,c,t):(a=!1,x())})},r}function yt(t,e,n,r){var i=Mt(t);return i.__iterateUncached=function(i,o){var s=this;if(o)return this.cacheResult().__iterate(i,o);var a=!0,u=0;return t.__iterate(function(t,o,c){return a&&(a=e.call(n,t,o,c))?void 0:(u++,i(t,r?o:u-1,s))}),u},i.__iteratorUncached=function(i,o){var s=this;if(o)return this.cacheResult().__iterator(i,o);var a=t.__iterator(_n,o),u=!0,c=0;return new k(function(){var t,o,l;do{if(t=a.next(),t.done)return r||i===gn?t:i===bn?w(i,c++,void 0,t):w(i,c++,t.value[1],t);var f=t.value;o=f[0],l=f[1],u&&(u=e.call(n,l,o,s))}while(u);return i===_n?t:w(i,o,l,t)})},i}function kt(t,e){var n=b(t),r=[t].concat(e).map(function(t){return v(t)?n&&(t=h(t)):t=n?q(t):U(Array.isArray(t)?t:[t]),t}).filter(function(t){return 0!==t.size});if(0===r.length)return t;if(1===r.length){var i=r[0];if(i===t||n&&b(i)||g(t)&&g(i))return i}var o=new M(r);return n?o=o.toKeyedSeq():g(t)||(o=o.toSetSeq()),o=o.flatten(!0),o.size=r.reduce(function(t,e){if(void 0!==t){var n=e.size;if(void 0!==n)return t+n}},0),o}function wt(t,e,n){var r=Mt(t);return r.__iterateUncached=function(r,i){function o(t,u){var c=this;t.__iterate(function(t,i){return(!e||e>u)&&v(t)?o(t,u+1):r(t,n?i:s++,c)===!1&&(a=!0),!a},i)}var s=0,a=!1;return o(t,0),s},r.__iteratorUncached=function(r,i){var o=t.__iterator(r,i),s=[],a=0;return new k(function(){for(;o;){var t=o.next();if(t.done===!1){var u=t.value;if(r===_n&&(u=u[1]),e&&!(s.length<e)||!v(u))return n?t:w(r,a++,u,t);s.push(o),o=u.__iterator(r,i)}else o=s.pop()}return x()})},r}function xt(t,e,n){var r=Ot(t);return t.toSeq().map(function(i,o){return r(e.call(n,i,o,t))}).flatten(!0)}function St(t,e){var n=Mt(t);return n.size=t.size&&2*t.size-1,n.__iterateUncached=function(n,r){var i=this,o=0;return t.__iterate(function(t){return(!o||n(e,o++,i)!==!1)&&n(t,o++,i)!==!1},r),o},n.__iteratorUncached=function(n,r){var i,o=t.__iterator(gn,r),s=0;return new k(function(){return(!i||s%2)&&(i=o.next(),i.done)?i:s%2?w(n,s++,e):w(n,s++,i.value,i)})},n}function Et(t,e,n){e||(e=Lt);var r=b(t),i=0,o=t.toSeq().map(function(e,r){return[r,e,i++,n?n(e,r,t):e]}).toArray();return o.sort(function(t,n){return e(t[3],n[3])||t[2]-n[2]}).forEach(r?function(t,e){o[e].length=2}:function(t,e){o[e]=t[1]}),r?D(o):g(t)?I(o):O(o)}function Ct(t,e,n){if(e||(e=Lt),n){var r=t.toSeq().map(function(e,r){return[e,n(e,r,t)]}).reduce(function(t,n){return Tt(e,t[1],n[1])?n:t});return r&&r[0]}return t.reduce(function(t,n){return Tt(e,t,n)?n:t})}function Tt(t,e,n){var r=t(n,e);return 0===r&&n!==e&&(void 0===n||null===n||n!==n)||r>0}function jt(t,e,n){var r=Mt(t);return r.size=new M(n).map(function(t){return t.size}).min(),r.__iterate=function(t,e){for(var n,r=this.__iterator(gn,e),i=0;!(n=r.next()).done&&t(n.value,i++,this)!==!1;);return i},r.__iteratorUncached=function(t,r){var i=n.map(function(t){return t=d(t),C(r?t.reverse():t)}),o=0,s=!1;return new k(function(){var n;return s||(n=i.map(function(t){return t.next()}),s=n.some(function(t){return t.done})),s?x():w(t,o++,e.apply(null,n.map(function(t){return t.value})))})},r}function Bt(t,e){return $(t)?e:t.constructor(e)}function Dt(t){if(t!==Object(t))throw new TypeError("Expected [K, V] tuple: "+t)}function It(t){return at(t.size),o(t)}function Ot(t){return b(t)?h:g(t)?p:m}function Mt(t){return Object.create((b(t)?D:g(t)?I:O).prototype)}function Nt(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):B.prototype.cacheResult.call(this)}function Lt(t,e){return t>e?1:e>t?-1:0}function At(t){var e=C(t);if(!e){if(!j(t))throw new TypeError("Expected iterable or array-like: "+t);e=C(d(t))}return e}function $t(t){return null===t||void 0===t?Qt():zt(t)?t:Qt().withMutations(function(e){var n=h(t);at(n.size),n.forEach(function(t,n){return e.set(n,t)})})}function zt(t){return!(!t||!t[Nn])}function qt(t,e){this.ownerID=t,this.entries=e}function Ut(t,e,n){this.ownerID=t,this.bitmap=e,this.nodes=n}function Rt(t,e,n){this.ownerID=t,this.count=e,this.nodes=n}function Pt(t,e,n){this.ownerID=t,this.keyHash=e,this.entries=n}function Ft(t,e,n){this.ownerID=t,this.keyHash=e,this.entry=n}function Ht(t,e,n){this._type=e,this._reverse=n,this._stack=t._root&&Wt(t._root)}function Kt(t,e){return w(t,e[0],e[1])}function Wt(t,e){return{node:t,index:0,__prev:e}}function Vt(t,e,n,r){var i=Object.create(Ln);return i.size=t,i._root=e,i.__ownerID=n,i.__hash=r,i.__altered=!1,i}function Qt(){return An||(An=Vt(0))}function Jt(t,n,r){var i,o;if(t._root){var s=e(fn),a=e(dn);if(i=Gt(t._root,t.__ownerID,0,void 0,n,r,s,a),!a.value)return t;o=t.size+(s.value?r===ln?-1:1:0)}else{if(r===ln)return t;o=1,i=new qt(t.__ownerID,[[n,r]])}return t.__ownerID?(t.size=o,t._root=i,t.__hash=void 0,t.__altered=!0,t):i?Vt(o,i):Qt()}function Gt(t,e,r,i,o,s,a,u){return t?t.update(e,r,i,o,s,a,u):s===ln?t:(n(u),n(a),new Ft(e,i,[o,s]))}function Xt(t){return t.constructor===Ft||t.constructor===Pt}function Yt(t,e,n,r,i){if(t.keyHash===r)return new Pt(e,r,[t.entry,i]);var o,s=(0===n?t.keyHash:t.keyHash>>>n)&cn,a=(0===n?r:r>>>n)&cn,u=s===a?[Yt(t,e,n+an,r,i)]:(o=new Ft(e,r,i),a>s?[t,o]:[o,t]);return new Ut(e,1<<s|1<<a,u)}function Zt(t,e,n,i){t||(t=new r);for(var o=new Ft(t,et(n),[n,i]),s=0;s<e.length;s++){var a=e[s];o=o.update(t,0,void 0,a[0],a[1])}return o}function te(t,e,n,r){for(var i=0,o=0,s=new Array(n),a=0,u=1,c=e.length;c>a;a++,u<<=1){var l=e[a];void 0!==l&&a!==r&&(i|=u,s[o++]=l)}return new Ut(t,i,s)}function ee(t,e,n,r,i){for(var o=0,s=new Array(un),a=0;0!==n;a++,n>>>=1)s[a]=1&n?e[o++]:void 0;return s[r]=i,new Rt(t,o+1,s)}function ne(t,e,n){for(var r=[],i=0;i<n.length;i++){var o=n[i],s=h(o);v(o)||(s=s.map(function(t){return G(t)})),r.push(s)}return ie(t,e,r)}function re(t){return function(e,n){return e&&e.mergeDeepWith&&v(n)?e.mergeDeepWith(t,n):t?t(e,n):n}}function ie(t,e,n){return n=n.filter(function(t){return 0!==t.size}),0===n.length?t:0===t.size&&1===n.length?t.constructor(n[0]):t.withMutations(function(t){for(var r=e?function(n,r){t.update(r,ln,function(t){return t===ln?n:e(t,n)})}:function(e,n){t.set(n,e)},i=0;i<n.length;i++)n[i].forEach(r)})}function oe(t,e,n,r){var i=t===ln,o=e.next();if(o.done){var s=i?n:t,a=r(s);return a===s?t:a}st(i||t&&t.set,"invalid keyPath");var u=o.value,c=i?ln:t.get(u,ln),l=oe(c,e,n,r);return l===c?t:l===ln?t.remove(u):(i?Qt():t).set(u,l)}function se(t){return t-=t>>1&1431655765,t=(858993459&t)+(t>>2&858993459),t=t+(t>>4)&252645135,t+=t>>8,t+=t>>16,127&t}function ae(t,e,n,r){var o=r?t:i(t);return o[e]=n,o}function ue(t,e,n,r){var i=t.length+1;if(r&&e+1===i)return t[e]=n,
t;for(var o=new Array(i),s=0,a=0;i>a;a++)a===e?(o[a]=n,s=-1):o[a]=t[a+s];return o}function ce(t,e,n){var r=t.length-1;if(n&&e===r)return t.pop(),t;for(var i=new Array(r),o=0,s=0;r>s;s++)s===e&&(o=1),i[s]=t[s+o];return i}function le(t){var e=me();if(null===t||void 0===t)return e;if(fe(t))return t;var n=p(t),r=n.size;return 0===r?e:(at(r),r>0&&un>r?pe(0,r,an,null,new de(n.toArray())):e.withMutations(function(t){t.setSize(r),n.forEach(function(e,n){return t.set(n,e)})}))}function fe(t){return!(!t||!t[Un])}function de(t,e){this.array=t,this.ownerID=e}function he(t,e){function n(t,e,n){return 0===e?r(t,n):i(t,e,n)}function r(t,n){var r=n===a?u&&u.array:t&&t.array,i=n>o?0:o-n,c=s-n;return c>un&&(c=un),function(){if(i===c)return Fn;var t=e?--c:i++;return r&&r[t]}}function i(t,r,i){var a,u=t&&t.array,c=i>o?0:o-i>>r,l=(s-i>>r)+1;return l>un&&(l=un),function(){for(;;){if(a){var t=a();if(t!==Fn)return t;a=null}if(c===l)return Fn;var o=e?--l:c++;a=n(u&&u[o],r-an,i+(o<<r))}}}var o=t._origin,s=t._capacity,a=we(s),u=t._tail;return n(t._root,t._level,0)}function pe(t,e,n,r,i,o,s){var a=Object.create(Rn);return a.size=e-t,a._origin=t,a._capacity=e,a._level=n,a._root=r,a._tail=i,a.__ownerID=o,a.__hash=s,a.__altered=!1,a}function me(){return Pn||(Pn=pe(0,0,an))}function ve(t,n,r){if(n=s(t,n),n>=t.size||0>n)return t.withMutations(function(t){0>n?ye(t,n).set(0,r):ye(t,0,n+1).set(n,r)});n+=t._origin;var i=t._tail,o=t._root,a=e(dn);return n>=we(t._capacity)?i=be(i,t.__ownerID,0,n,r,a):o=be(o,t.__ownerID,t._level,n,r,a),a.value?t.__ownerID?(t._root=o,t._tail=i,t.__hash=void 0,t.__altered=!0,t):pe(t._origin,t._capacity,t._level,o,i):t}function be(t,e,r,i,o,s){var a=i>>>r&cn,u=t&&a<t.array.length;if(!u&&void 0===o)return t;var c;if(r>0){var l=t&&t.array[a],f=be(l,e,r-an,i,o,s);return f===l?t:(c=ge(t,e),c.array[a]=f,c)}return u&&t.array[a]===o?t:(n(s),c=ge(t,e),void 0===o&&a===c.array.length-1?c.array.pop():c.array[a]=o,c)}function ge(t,e){return e&&t&&e===t.ownerID?t:new de(t?t.array.slice():[],e)}function _e(t,e){if(e>=we(t._capacity))return t._tail;if(e<1<<t._level+an){for(var n=t._root,r=t._level;n&&r>0;)n=n.array[e>>>r&cn],r-=an;return n}}function ye(t,e,n){var i=t.__ownerID||new r,o=t._origin,s=t._capacity,a=o+e,u=void 0===n?s:0>n?s+n:o+n;if(a===o&&u===s)return t;if(a>=u)return t.clear();for(var c=t._level,l=t._root,f=0;0>a+f;)l=new de(l&&l.array.length?[void 0,l]:[],i),c+=an,f+=1<<c;f&&(a+=f,o+=f,u+=f,s+=f);for(var d=we(s),h=we(u);h>=1<<c+an;)l=new de(l&&l.array.length?[l]:[],i),c+=an;var p=t._tail,m=d>h?_e(t,u-1):h>d?new de([],i):p;if(p&&h>d&&s>a&&p.array.length){l=ge(l,i);for(var v=l,b=c;b>an;b-=an){var g=d>>>b&cn;v=v.array[g]=ge(v.array[g],i)}v.array[d>>>an&cn]=p}if(s>u&&(m=m&&m.removeAfter(i,0,u)),a>=h)a-=h,u-=h,c=an,l=null,m=m&&m.removeBefore(i,0,a);else if(a>o||d>h){for(f=0;l;){var _=a>>>c&cn;if(_!==h>>>c&cn)break;_&&(f+=(1<<c)*_),c-=an,l=l.array[_]}l&&a>o&&(l=l.removeBefore(i,c,a-f)),l&&d>h&&(l=l.removeAfter(i,c,h-f)),f&&(a-=f,u-=f)}return t.__ownerID?(t.size=u-a,t._origin=a,t._capacity=u,t._level=c,t._root=l,t._tail=m,t.__hash=void 0,t.__altered=!0,t):pe(a,u,c,l,m)}function ke(t,e,n){for(var r=[],i=0,o=0;o<n.length;o++){var s=n[o],a=p(s);a.size>i&&(i=a.size),v(s)||(a=a.map(function(t){return G(t)})),r.push(a)}return i>t.size&&(t=t.setSize(i)),ie(t,e,r)}function we(t){return un>t?0:t-1>>>an<<an}function xe(t){return null===t||void 0===t?Ce():Se(t)?t:Ce().withMutations(function(e){var n=h(t);at(n.size),n.forEach(function(t,n){return e.set(n,t)})})}function Se(t){return zt(t)&&y(t)}function Ee(t,e,n,r){var i=Object.create(xe.prototype);return i.size=t?t.size:0,i._map=t,i._list=e,i.__ownerID=n,i.__hash=r,i}function Ce(){return Hn||(Hn=Ee(Qt(),me()))}function Te(t,e,n){var r,i,o=t._map,s=t._list,a=o.get(e),u=void 0!==a;if(n===ln){if(!u)return t;s.size>=un&&s.size>=2*o.size?(i=s.filter(function(t,e){return void 0!==t&&a!==e}),r=i.toKeyedSeq().map(function(t){return t[0]}).flip().toMap(),t.__ownerID&&(r.__ownerID=i.__ownerID=t.__ownerID)):(r=o.remove(e),i=a===s.size-1?s.pop():s.set(a,void 0))}else if(u){if(n===s.get(a)[1])return t;r=o,i=s.set(a,[e,n])}else r=o.set(e,s.size),i=s.set(s.size,[e,n]);return t.__ownerID?(t.size=r.size,t._map=r,t._list=i,t.__hash=void 0,t):Ee(r,i)}function je(t){return null===t||void 0===t?Ie():Be(t)?t:Ie().unshiftAll(t)}function Be(t){return!(!t||!t[Kn])}function De(t,e,n,r){var i=Object.create(Wn);return i.size=t,i._head=e,i.__ownerID=n,i.__hash=r,i.__altered=!1,i}function Ie(){return Vn||(Vn=De(0))}function Oe(t){return null===t||void 0===t?Ae():Me(t)?t:Ae().withMutations(function(e){var n=m(t);at(n.size),n.forEach(function(t){return e.add(t)})})}function Me(t){return!(!t||!t[Qn])}function Ne(t,e){return t.__ownerID?(t.size=e.size,t._map=e,t):e===t._map?t:0===e.size?t.__empty():t.__make(e)}function Le(t,e){var n=Object.create(Jn);return n.size=t?t.size:0,n._map=t,n.__ownerID=e,n}function Ae(){return Gn||(Gn=Le(Qt()))}function $e(t){return null===t||void 0===t?Ue():ze(t)?t:Ue().withMutations(function(e){var n=m(t);at(n.size),n.forEach(function(t){return e.add(t)})})}function ze(t){return Me(t)&&y(t)}function qe(t,e){var n=Object.create(Xn);return n.size=t?t.size:0,n._map=t,n.__ownerID=e,n}function Ue(){return Yn||(Yn=qe(Ce()))}function Re(t,e){var n=function(t){return this instanceof n?void(this._map=$t(t)):new n(t)},r=Object.keys(t),i=n.prototype=Object.create(Zn);i.constructor=n,e&&(i._name=e),i._defaultValues=t,i._keys=r,i.size=r.length;try{r.forEach(function(t){Object.defineProperty(n.prototype,t,{get:function(){return this.get(t)},set:function(e){st(this.__ownerID,"Cannot set on an immutable record."),this.set(t,e)}})})}catch(o){}return n}function Pe(t,e,n){var r=Object.create(Object.getPrototypeOf(t));return r._map=e,r.__ownerID=n,r}function Fe(t){return t._name||t.constructor.name}function He(t,e){if(t===e)return!0;if(!v(e)||void 0!==t.size&&void 0!==e.size&&t.size!==e.size||void 0!==t.__hash&&void 0!==e.__hash&&t.__hash!==e.__hash||b(t)!==b(e)||g(t)!==g(e)||y(t)!==y(e))return!1;if(0===t.size&&0===e.size)return!0;var n=!_(t);if(y(t)){var r=t.entries();return e.every(function(t,e){var i=r.next().value;return i&&J(i[1],t)&&(n||J(i[0],e))})&&r.next().done}var i=!1;if(void 0===t.size)if(void 0===e.size)t.cacheResult();else{i=!0;var o=t;t=e,e=o}var s=!0,a=e.__iterate(function(e,r){return(n?t.has(e):i?J(e,t.get(r,ln)):J(t.get(r,ln),e))?void 0:(s=!1,!1)});return s&&t.size===a}function Ke(t,e,n){if(!(this instanceof Ke))return new Ke(t,e,n);if(st(0!==n,"Cannot step a Range by 0"),t=t||0,void 0===e&&(e=1/0),n=void 0===n?1:Math.abs(n),t>e&&(n=-n),this._start=t,this._end=e,this._step=n,this.size=Math.max(0,Math.ceil((e-t)/n-1)+1),0===this.size){if(tr)return tr;tr=this}}function We(t,e){if(!(this instanceof We))return new We(t,e);if(this._value=t,this.size=void 0===e?1/0:Math.max(0,e),0===this.size){if(er)return er;er=this}}function Ve(t,e){var n=function(n){t.prototype[n]=e[n]};return Object.keys(e).forEach(n),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(e).forEach(n),t}function Qe(t,e){return e}function Je(t,e){return[e,t]}function Ge(t){return function(){return!t.apply(this,arguments)}}function Xe(t){return function(){return-t.apply(this,arguments)}}function Ye(t){return"string"==typeof t?JSON.stringify(t):t}function Ze(){return i(arguments)}function tn(t,e){return e>t?1:t>e?-1:0}function en(t){if(t.size===1/0)return 0;var e=y(t),n=b(t),r=e?1:0,i=t.__iterate(n?e?function(t,e){r=31*r+rn(et(t),et(e))|0}:function(t,e){r=r+rn(et(t),et(e))|0}:e?function(t){r=31*r+et(t)|0}:function(t){r=r+et(t)|0});return nn(i,r)}function nn(t,e){return e=En(e,3432918353),e=En(e<<15|e>>>-15,461845907),e=En(e<<13|e>>>-13,5),e=(e+3864292196|0)^t,e=En(e^e>>>16,2246822507),e=En(e^e>>>13,3266489909),e=tt(e^e>>>16)}function rn(t,e){return t^e+2654435769+(t<<6)+(t>>2)|0}var on=Array.prototype.slice,sn="delete",an=5,un=1<<an,cn=un-1,ln={},fn={value:!1},dn={value:!1};t(h,d),t(p,d),t(m,d),d.isIterable=v,d.isKeyed=b,d.isIndexed=g,d.isAssociative=_,d.isOrdered=y,d.Keyed=h,d.Indexed=p,d.Set=m;var hn="@@__IMMUTABLE_ITERABLE__@@",pn="@@__IMMUTABLE_KEYED__@@",mn="@@__IMMUTABLE_INDEXED__@@",vn="@@__IMMUTABLE_ORDERED__@@",bn=0,gn=1,_n=2,yn="function"==typeof Symbol&&Symbol.iterator,kn="@@iterator",wn=yn||kn;k.prototype.toString=function(){return"[Iterator]"},k.KEYS=bn,k.VALUES=gn,k.ENTRIES=_n,k.prototype.inspect=k.prototype.toSource=function(){return this.toString()},k.prototype[wn]=function(){return this},t(B,d),B.of=function(){return B(arguments)},B.prototype.toSeq=function(){return this},B.prototype.toString=function(){return this.__toString("Seq {","}")},B.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},B.prototype.__iterate=function(t,e){return F(this,t,e,!0)},B.prototype.__iterator=function(t,e){return H(this,t,e,!0)},t(D,B),D.of=function(){return D(arguments)},D.prototype.toKeyedSeq=function(){return this},D.prototype.toSeq=function(){return this},t(I,B),I.of=function(){return I(arguments)},I.prototype.toIndexedSeq=function(){return this},I.prototype.toString=function(){return this.__toString("Seq [","]")},I.prototype.__iterate=function(t,e){return F(this,t,e,!1)},I.prototype.__iterator=function(t,e){return H(this,t,e,!1)},t(O,B),O.of=function(){return O(arguments)},O.prototype.toSetSeq=function(){return this},B.isSeq=$,B.Keyed=D,B.Set=O,B.Indexed=I;var xn="@@__IMMUTABLE_SEQ__@@";B.prototype[xn]=!0,t(M,I),M.prototype.get=function(t,e){return this.has(t)?this._array[s(this,t)]:e},M.prototype.__iterate=function(t,e){for(var n=this._array,r=n.length-1,i=0;r>=i;i++)if(t(n[e?r-i:i],i,this)===!1)return i+1;return i},M.prototype.__iterator=function(t,e){var n=this._array,r=n.length-1,i=0;return new k(function(){return i>r?x():w(t,i,n[e?r-i++:i++])})},t(N,D),N.prototype.get=function(t,e){return void 0===e||this.has(t)?this._object[t]:e},N.prototype.has=function(t){return this._object.hasOwnProperty(t)},N.prototype.__iterate=function(t,e){for(var n=this._object,r=this._keys,i=r.length-1,o=0;i>=o;o++){var s=r[e?i-o:o];if(t(n[s],s,this)===!1)return o+1}return o},N.prototype.__iterator=function(t,e){var n=this._object,r=this._keys,i=r.length-1,o=0;return new k(function(){var s=r[e?i-o:o];return o++>i?x():w(t,s,n[s])})},N.prototype[vn]=!0,t(L,I),L.prototype.__iterateUncached=function(t,e){if(e)return this.cacheResult().__iterate(t,e);var n=this._iterable,r=C(n),i=0;if(E(r))for(var o;!(o=r.next()).done&&t(o.value,i++,this)!==!1;);return i},L.prototype.__iteratorUncached=function(t,e){if(e)return this.cacheResult().__iterator(t,e);var n=this._iterable,r=C(n);if(!E(r))return new k(x);var i=0;return new k(function(){var e=r.next();return e.done?e:w(t,i++,e.value)})},t(A,I),A.prototype.__iterateUncached=function(t,e){if(e)return this.cacheResult().__iterate(t,e);for(var n=this._iterator,r=this._iteratorCache,i=0;i<r.length;)if(t(r[i],i++,this)===!1)return i;for(var o;!(o=n.next()).done;){var s=o.value;if(r[i]=s,t(s,i++,this)===!1)break}return i},A.prototype.__iteratorUncached=function(t,e){if(e)return this.cacheResult().__iterator(t,e);var n=this._iterator,r=this._iteratorCache,i=0;return new k(function(){if(i>=r.length){var e=n.next();if(e.done)return e;r[i]=e.value}return w(t,i,r[i++])})};var Sn;t(K,d),t(W,K),t(V,K),t(Q,K),K.Keyed=W,K.Indexed=V,K.Set=Q;var En="function"==typeof Math.imul&&-2===Math.imul(4294967295,2)?Math.imul:function(t,e){t=0|t,e=0|e;var n=65535&t,r=65535&e;return n*r+((t>>>16)*r+n*(e>>>16)<<16>>>0)|0},Cn=function(){try{return Object.defineProperty({},"x",{}),!0}catch(t){return!1}}(),Tn="function"==typeof WeakMap&&new WeakMap,jn=0,Bn="__immutablehash__";"function"==typeof Symbol&&(Bn=Symbol(Bn));var Dn=16,In=255,On=0,Mn={};t(ut,D),ut.prototype.get=function(t,e){return this._iter.get(t,e)},ut.prototype.has=function(t){return this._iter.has(t)},ut.prototype.valueSeq=function(){return this._iter.valueSeq()},ut.prototype.reverse=function(){var t=this,e=pt(this,!0);return this._useKeys||(e.valueSeq=function(){return t._iter.toSeq().reverse()}),e},ut.prototype.map=function(t,e){var n=this,r=ht(this,t,e);return this._useKeys||(r.valueSeq=function(){return n._iter.toSeq().map(t,e)}),r},ut.prototype.__iterate=function(t,e){var n,r=this;return this._iter.__iterate(this._useKeys?function(e,n){return t(e,n,r)}:(n=e?It(this):0,function(i){return t(i,e?--n:n++,r)}),e)},ut.prototype.__iterator=function(t,e){if(this._useKeys)return this._iter.__iterator(t,e);var n=this._iter.__iterator(gn,e),r=e?It(this):0;return new k(function(){var i=n.next();return i.done?i:w(t,e?--r:r++,i.value,i)})},ut.prototype[vn]=!0,t(ct,I),ct.prototype.contains=function(t){return this._iter.contains(t)},ct.prototype.__iterate=function(t,e){var n=this,r=0;return this._iter.__iterate(function(e){return t(e,r++,n)},e)},ct.prototype.__iterator=function(t,e){var n=this._iter.__iterator(gn,e),r=0;return new k(function(){var e=n.next();return e.done?e:w(t,r++,e.value,e)})},t(lt,O),lt.prototype.has=function(t){return this._iter.contains(t)},lt.prototype.__iterate=function(t,e){var n=this;return this._iter.__iterate(function(e){return t(e,e,n)},e)},lt.prototype.__iterator=function(t,e){var n=this._iter.__iterator(gn,e);return new k(function(){var e=n.next();return e.done?e:w(t,e.value,e.value,e)})},t(ft,D),ft.prototype.entrySeq=function(){return this._iter.toSeq()},ft.prototype.__iterate=function(t,e){var n=this;return this._iter.__iterate(function(e){return e?(Dt(e),t(e[1],e[0],n)):void 0},e)},ft.prototype.__iterator=function(t,e){var n=this._iter.__iterator(gn,e);return new k(function(){for(;;){var e=n.next();if(e.done)return e;var r=e.value;if(r)return Dt(r),t===_n?e:w(t,r[0],r[1],e)}})},ct.prototype.cacheResult=ut.prototype.cacheResult=lt.prototype.cacheResult=ft.prototype.cacheResult=Nt,t($t,W),$t.prototype.toString=function(){return this.__toString("Map {","}")},$t.prototype.get=function(t,e){return this._root?this._root.get(0,void 0,t,e):e},$t.prototype.set=function(t,e){return Jt(this,t,e)},$t.prototype.setIn=function(t,e){return this.updateIn(t,ln,function(){return e})},$t.prototype.remove=function(t){return Jt(this,t,ln)},$t.prototype.deleteIn=function(t){return this.updateIn(t,function(){return ln})},$t.prototype.update=function(t,e,n){return 1===arguments.length?t(this):this.updateIn([t],e,n)},$t.prototype.updateIn=function(t,e,n){n||(n=e,e=void 0);var r=oe(this,At(t),e,n);return r===ln?void 0:r},$t.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):Qt()},$t.prototype.merge=function(){return ne(this,void 0,arguments)},$t.prototype.mergeWith=function(t){var e=on.call(arguments,1);return ne(this,t,e)},$t.prototype.mergeIn=function(t){var e=on.call(arguments,1);return this.updateIn(t,Qt(),function(t){return t.merge.apply(t,e)})},$t.prototype.mergeDeep=function(){return ne(this,re(void 0),arguments)},$t.prototype.mergeDeepWith=function(t){var e=on.call(arguments,1);return ne(this,re(t),e)},$t.prototype.mergeDeepIn=function(t){var e=on.call(arguments,1);return this.updateIn(t,Qt(),function(t){return t.mergeDeep.apply(t,e)})},$t.prototype.sort=function(t){return xe(Et(this,t))},$t.prototype.sortBy=function(t,e){return xe(Et(this,e,t))},$t.prototype.withMutations=function(t){var e=this.asMutable();return t(e),e.wasAltered()?e.__ensureOwner(this.__ownerID):this},$t.prototype.asMutable=function(){return this.__ownerID?this:this.__ensureOwner(new r)},$t.prototype.asImmutable=function(){return this.__ensureOwner()},$t.prototype.wasAltered=function(){return this.__altered},$t.prototype.__iterator=function(t,e){return new Ht(this,t,e)},$t.prototype.__iterate=function(t,e){var n=this,r=0;return this._root&&this._root.iterate(function(e){return r++,t(e[1],e[0],n)},e),r},$t.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?Vt(this.size,this._root,t,this.__hash):(this.__ownerID=t,this.__altered=!1,this)},$t.isMap=zt;var Nn="@@__IMMUTABLE_MAP__@@",Ln=$t.prototype;Ln[Nn]=!0,Ln[sn]=Ln.remove,Ln.removeIn=Ln.deleteIn,qt.prototype.get=function(t,e,n,r){for(var i=this.entries,o=0,s=i.length;s>o;o++)if(J(n,i[o][0]))return i[o][1];return r},qt.prototype.update=function(t,e,r,o,s,a,u){for(var c=s===ln,l=this.entries,f=0,d=l.length;d>f&&!J(o,l[f][0]);f++);var h=d>f;if(h?l[f][1]===s:c)return this;if(n(u),(c||!h)&&n(a),!c||1!==l.length){if(!h&&!c&&l.length>=$n)return Zt(t,l,o,s);var p=t&&t===this.ownerID,m=p?l:i(l);return h?c?f===d-1?m.pop():m[f]=m.pop():m[f]=[o,s]:m.push([o,s]),p?(this.entries=m,this):new qt(t,m)}},Ut.prototype.get=function(t,e,n,r){void 0===e&&(e=et(n));var i=1<<((0===t?e:e>>>t)&cn),o=this.bitmap;return 0===(o&i)?r:this.nodes[se(o&i-1)].get(t+an,e,n,r)},Ut.prototype.update=function(t,e,n,r,i,o,s){void 0===n&&(n=et(r));var a=(0===e?n:n>>>e)&cn,u=1<<a,c=this.bitmap,l=0!==(c&u);if(!l&&i===ln)return this;var f=se(c&u-1),d=this.nodes,h=l?d[f]:void 0,p=Gt(h,t,e+an,n,r,i,o,s);if(p===h)return this;if(!l&&p&&d.length>=zn)return ee(t,d,c,a,p);if(l&&!p&&2===d.length&&Xt(d[1^f]))return d[1^f];if(l&&p&&1===d.length&&Xt(p))return p;var m=t&&t===this.ownerID,v=l?p?c:c^u:c|u,b=l?p?ae(d,f,p,m):ce(d,f,m):ue(d,f,p,m);return m?(this.bitmap=v,this.nodes=b,this):new Ut(t,v,b)},Rt.prototype.get=function(t,e,n,r){void 0===e&&(e=et(n));var i=(0===t?e:e>>>t)&cn,o=this.nodes[i];return o?o.get(t+an,e,n,r):r},Rt.prototype.update=function(t,e,n,r,i,o,s){void 0===n&&(n=et(r));var a=(0===e?n:n>>>e)&cn,u=i===ln,c=this.nodes,l=c[a];if(u&&!l)return this;var f=Gt(l,t,e+an,n,r,i,o,s);if(f===l)return this;var d=this.count;if(l){if(!f&&(d--,qn>d))return te(t,c,d,a)}else d++;var h=t&&t===this.ownerID,p=ae(c,a,f,h);return h?(this.count=d,this.nodes=p,this):new Rt(t,d,p)},Pt.prototype.get=function(t,e,n,r){for(var i=this.entries,o=0,s=i.length;s>o;o++)if(J(n,i[o][0]))return i[o][1];return r},Pt.prototype.update=function(t,e,r,o,s,a,u){void 0===r&&(r=et(o));var c=s===ln;if(r!==this.keyHash)return c?this:(n(u),n(a),Yt(this,t,e,r,[o,s]));for(var l=this.entries,f=0,d=l.length;d>f&&!J(o,l[f][0]);f++);var h=d>f;if(h?l[f][1]===s:c)return this;if(n(u),(c||!h)&&n(a),c&&2===d)return new Ft(t,this.keyHash,l[1^f]);var p=t&&t===this.ownerID,m=p?l:i(l);return h?c?f===d-1?m.pop():m[f]=m.pop():m[f]=[o,s]:m.push([o,s]),p?(this.entries=m,this):new Pt(t,this.keyHash,m)},Ft.prototype.get=function(t,e,n,r){return J(n,this.entry[0])?this.entry[1]:r},Ft.prototype.update=function(t,e,r,i,o,s,a){var u=o===ln,c=J(i,this.entry[0]);return(c?o===this.entry[1]:u)?this:(n(a),u?void n(s):c?t&&t===this.ownerID?(this.entry[1]=o,this):new Ft(t,this.keyHash,[i,o]):(n(s),Yt(this,t,e,et(i),[i,o])))},qt.prototype.iterate=Pt.prototype.iterate=function(t,e){for(var n=this.entries,r=0,i=n.length-1;i>=r;r++)if(t(n[e?i-r:r])===!1)return!1},Ut.prototype.iterate=Rt.prototype.iterate=function(t,e){for(var n=this.nodes,r=0,i=n.length-1;i>=r;r++){var o=n[e?i-r:r];if(o&&o.iterate(t,e)===!1)return!1}},Ft.prototype.iterate=function(t){return t(this.entry)},t(Ht,k),Ht.prototype.next=function(){for(var t=this._type,e=this._stack;e;){var n,r=e.node,i=e.index++;if(r.entry){if(0===i)return Kt(t,r.entry)}else if(r.entries){if(n=r.entries.length-1,n>=i)return Kt(t,r.entries[this._reverse?n-i:i])}else if(n=r.nodes.length-1,n>=i){var o=r.nodes[this._reverse?n-i:i];if(o){if(o.entry)return Kt(t,o.entry);e=this._stack=Wt(o,e)}continue}e=this._stack=this._stack.__prev}return x()};var An,$n=un/4,zn=un/2,qn=un/4;t(le,V),le.of=function(){return this(arguments)},le.prototype.toString=function(){return this.__toString("List [","]")},le.prototype.get=function(t,e){if(t=s(this,t),0>t||t>=this.size)return e;t+=this._origin;var n=_e(this,t);return n&&n.array[t&cn]},le.prototype.set=function(t,e){return ve(this,t,e)},le.prototype.remove=function(t){return this.has(t)?0===t?this.shift():t===this.size-1?this.pop():this.splice(t,1):this},le.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=an,this._root=this._tail=null,this.__hash=void 0,this.__altered=!0,this):me()},le.prototype.push=function(){var t=arguments,e=this.size;return this.withMutations(function(n){ye(n,0,e+t.length);for(var r=0;r<t.length;r++)n.set(e+r,t[r])})},le.prototype.pop=function(){return ye(this,0,-1)},le.prototype.unshift=function(){var t=arguments;return this.withMutations(function(e){ye(e,-t.length);for(var n=0;n<t.length;n++)e.set(n,t[n])})},le.prototype.shift=function(){return ye(this,1)},le.prototype.merge=function(){return ke(this,void 0,arguments)},le.prototype.mergeWith=function(t){var e=on.call(arguments,1);return ke(this,t,e)},le.prototype.mergeDeep=function(){return ke(this,re(void 0),arguments)},le.prototype.mergeDeepWith=function(t){var e=on.call(arguments,1);return ke(this,re(t),e)},le.prototype.setSize=function(t){return ye(this,0,t)},le.prototype.slice=function(t,e){var n=this.size;return u(t,e,n)?this:ye(this,c(t,n),l(e,n))},le.prototype.__iterator=function(t,e){var n=0,r=he(this,e);return new k(function(){var e=r();return e===Fn?x():w(t,n++,e)})},le.prototype.__iterate=function(t,e){for(var n,r=0,i=he(this,e);(n=i())!==Fn&&t(n,r++,this)!==!1;);return r},le.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?pe(this._origin,this._capacity,this._level,this._root,this._tail,t,this.__hash):(this.__ownerID=t,this)},le.isList=fe;var Un="@@__IMMUTABLE_LIST__@@",Rn=le.prototype;Rn[Un]=!0,Rn[sn]=Rn.remove,Rn.setIn=Ln.setIn,Rn.deleteIn=Rn.removeIn=Ln.removeIn,Rn.update=Ln.update,Rn.updateIn=Ln.updateIn,Rn.mergeIn=Ln.mergeIn,Rn.mergeDeepIn=Ln.mergeDeepIn,Rn.withMutations=Ln.withMutations,Rn.asMutable=Ln.asMutable,Rn.asImmutable=Ln.asImmutable,Rn.wasAltered=Ln.wasAltered,de.prototype.removeBefore=function(t,e,n){if(n===e?1<<e:0||0===this.array.length)return this;var r=n>>>e&cn;if(r>=this.array.length)return new de([],t);var i,o=0===r;if(e>0){var s=this.array[r];if(i=s&&s.removeBefore(t,e-an,n),i===s&&o)return this}if(o&&!i)return this;var a=ge(this,t);if(!o)for(var u=0;r>u;u++)a.array[u]=void 0;return i&&(a.array[r]=i),a},de.prototype.removeAfter=function(t,e,n){if(n===e?1<<e:0||0===this.array.length)return this;var r=n-1>>>e&cn;if(r>=this.array.length)return this;var i,o=r===this.array.length-1;if(e>0){var s=this.array[r];if(i=s&&s.removeAfter(t,e-an,n),i===s&&o)return this}if(o&&!i)return this;var a=ge(this,t);return o||a.array.pop(),i&&(a.array[r]=i),a};var Pn,Fn={};t(xe,$t),xe.of=function(){return this(arguments)},xe.prototype.toString=function(){return this.__toString("OrderedMap {","}")},xe.prototype.get=function(t,e){var n=this._map.get(t);return void 0!==n?this._list.get(n)[1]:e},xe.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this):Ce()},xe.prototype.set=function(t,e){return Te(this,t,e)},xe.prototype.remove=function(t){return Te(this,t,ln)},xe.prototype.wasAltered=function(){return this._map.wasAltered()||this._list.wasAltered()},xe.prototype.__iterate=function(t,e){var n=this;return this._list.__iterate(function(e){return e&&t(e[1],e[0],n)},e)},xe.prototype.__iterator=function(t,e){return this._list.fromEntrySeq().__iterator(t,e)},xe.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map.__ensureOwner(t),n=this._list.__ensureOwner(t);return t?Ee(e,n,t,this.__hash):(this.__ownerID=t,this._map=e,this._list=n,this)},xe.isOrderedMap=Se,xe.prototype[vn]=!0,xe.prototype[sn]=xe.prototype.remove;var Hn;t(je,V),je.of=function(){return this(arguments)},je.prototype.toString=function(){return this.__toString("Stack [","]")},je.prototype.get=function(t,e){for(var n=this._head;n&&t--;)n=n.next;return n?n.value:e},je.prototype.peek=function(){return this._head&&this._head.value},je.prototype.push=function(){if(0===arguments.length)return this;for(var t=this.size+arguments.length,e=this._head,n=arguments.length-1;n>=0;n--)e={value:arguments[n],next:e};return this.__ownerID?(this.size=t,this._head=e,this.__hash=void 0,this.__altered=!0,this):De(t,e)},je.prototype.pushAll=function(t){if(t=p(t),0===t.size)return this;at(t.size);var e=this.size,n=this._head;return t.reverse().forEach(function(t){e++,n={value:t,next:n}}),this.__ownerID?(this.size=e,this._head=n,this.__hash=void 0,this.__altered=!0,this):De(e,n)},je.prototype.pop=function(){return this.slice(1)},je.prototype.unshift=function(){return this.push.apply(this,arguments)},je.prototype.unshiftAll=function(t){return this.pushAll(t)},je.prototype.shift=function(){return this.pop.apply(this,arguments)},je.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):Ie()},je.prototype.slice=function(t,e){if(u(t,e,this.size))return this;var n=c(t,this.size),r=l(e,this.size);if(r!==this.size)return V.prototype.slice.call(this,t,e);for(var i=this.size-n,o=this._head;n--;)o=o.next;return this.__ownerID?(this.size=i,this._head=o,this.__hash=void 0,this.__altered=!0,this):De(i,o)},je.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?De(this.size,this._head,t,this.__hash):(this.__ownerID=t,this.__altered=!1,this)},je.prototype.__iterate=function(t,e){if(e)return this.toSeq().cacheResult.__iterate(t,e);for(var n=0,r=this._head;r&&t(r.value,n++,this)!==!1;)r=r.next;return n},je.prototype.__iterator=function(t,e){if(e)return this.toSeq().cacheResult().__iterator(t,e);var n=0,r=this._head;return new k(function(){if(r){var e=r.value;return r=r.next,w(t,n++,e)}return x()})},je.isStack=Be;var Kn="@@__IMMUTABLE_STACK__@@",Wn=je.prototype;Wn[Kn]=!0,Wn.withMutations=Ln.withMutations,Wn.asMutable=Ln.asMutable,Wn.asImmutable=Ln.asImmutable,Wn.wasAltered=Ln.wasAltered;var Vn;t(Oe,Q),Oe.of=function(){return this(arguments)},Oe.fromKeys=function(t){return this(h(t).keySeq())},Oe.prototype.toString=function(){return this.__toString("Set {","}")},Oe.prototype.has=function(t){return this._map.has(t)},Oe.prototype.add=function(t){return Ne(this,this._map.set(t,!0))},Oe.prototype.remove=function(t){return Ne(this,this._map.remove(t))},Oe.prototype.clear=function(){return Ne(this,this._map.clear())},Oe.prototype.union=function(){var t=on.call(arguments,0);return t=t.filter(function(t){return 0!==t.size}),0===t.length?this:0===this.size&&1===t.length?this.constructor(t[0]):this.withMutations(function(e){for(var n=0;n<t.length;n++)m(t[n]).forEach(function(t){return e.add(t)})})},Oe.prototype.intersect=function(){var t=on.call(arguments,0);if(0===t.length)return this;t=t.map(function(t){return m(t)});var e=this;return this.withMutations(function(n){e.forEach(function(e){t.every(function(t){return t.contains(e)})||n.remove(e)})})},Oe.prototype.subtract=function(){var t=on.call(arguments,0);if(0===t.length)return this;t=t.map(function(t){return m(t)});var e=this;return this.withMutations(function(n){e.forEach(function(e){t.some(function(t){return t.contains(e)})&&n.remove(e)})})},Oe.prototype.merge=function(){return this.union.apply(this,arguments)},Oe.prototype.mergeWith=function(){var t=on.call(arguments,1);return this.union.apply(this,t)},Oe.prototype.sort=function(t){return $e(Et(this,t))},Oe.prototype.sortBy=function(t,e){return $e(Et(this,e,t))},Oe.prototype.wasAltered=function(){return this._map.wasAltered()},Oe.prototype.__iterate=function(t,e){var n=this;return this._map.__iterate(function(e,r){return t(r,r,n)},e)},Oe.prototype.__iterator=function(t,e){return this._map.map(function(t,e){return e}).__iterator(t,e)},Oe.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map.__ensureOwner(t);return t?this.__make(e,t):(this.__ownerID=t,this._map=e,this)},Oe.isSet=Me;var Qn="@@__IMMUTABLE_SET__@@",Jn=Oe.prototype;Jn[Qn]=!0,Jn[sn]=Jn.remove,Jn.mergeDeep=Jn.merge,Jn.mergeDeepWith=Jn.mergeWith,Jn.withMutations=Ln.withMutations,Jn.asMutable=Ln.asMutable,Jn.asImmutable=Ln.asImmutable,Jn.__empty=Ae,Jn.__make=Le;var Gn;t($e,Oe),$e.of=function(){return this(arguments)},$e.fromKeys=function(t){return this(h(t).keySeq())},$e.prototype.toString=function(){return this.__toString("OrderedSet {","}")},$e.isOrderedSet=ze;var Xn=$e.prototype;Xn[vn]=!0,Xn.__empty=Ue,Xn.__make=qe;var Yn;t(Re,W),Re.prototype.toString=function(){return this.__toString(Fe(this)+" {","}")},Re.prototype.has=function(t){return this._defaultValues.hasOwnProperty(t)},Re.prototype.get=function(t,e){if(!this.has(t))return e;var n=this._defaultValues[t];return this._map?this._map.get(t,n):n},Re.prototype.clear=function(){if(this.__ownerID)return this._map&&this._map.clear(),this;var t=Object.getPrototypeOf(this).constructor;return t._empty||(t._empty=Pe(this,Qt()))},Re.prototype.set=function(t,e){if(!this.has(t))throw new Error('Cannot set unknown key "'+t+'" on '+Fe(this));var n=this._map&&this._map.set(t,e);return this.__ownerID||n===this._map?this:Pe(this,n)},Re.prototype.remove=function(t){if(!this.has(t))return this;var e=this._map&&this._map.remove(t);return this.__ownerID||e===this._map?this:Pe(this,e)},Re.prototype.wasAltered=function(){return this._map.wasAltered()},Re.prototype.__iterator=function(t,e){var n=this;return h(this._defaultValues).map(function(t,e){return n.get(e)}).__iterator(t,e)},Re.prototype.__iterate=function(t,e){var n=this;return h(this._defaultValues).map(function(t,e){return n.get(e)}).__iterate(t,e)},Re.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map&&this._map.__ensureOwner(t);return t?Pe(this,e,t):(this.__ownerID=t,this._map=e,this)};var Zn=Re.prototype;Zn[sn]=Zn.remove,Zn.deleteIn=Zn.removeIn=Ln.removeIn,Zn.merge=Ln.merge,Zn.mergeWith=Ln.mergeWith,Zn.mergeIn=Ln.mergeIn,Zn.mergeDeep=Ln.mergeDeep,Zn.mergeDeepWith=Ln.mergeDeepWith,Zn.mergeDeepIn=Ln.mergeDeepIn,Zn.setIn=Ln.setIn,Zn.update=Ln.update,Zn.updateIn=Ln.updateIn,Zn.withMutations=Ln.withMutations,Zn.asMutable=Ln.asMutable,Zn.asImmutable=Ln.asImmutable,t(Ke,I),Ke.prototype.toString=function(){return 0===this.size?"Range []":"Range [ "+this._start+"..."+this._end+(this._step>1?" by "+this._step:"")+" ]"},Ke.prototype.get=function(t,e){return this.has(t)?this._start+s(this,t)*this._step:e},Ke.prototype.contains=function(t){var e=(t-this._start)/this._step;return e>=0&&e<this.size&&e===Math.floor(e)},Ke.prototype.slice=function(t,e){return u(t,e,this.size)?this:(t=c(t,this.size),e=l(e,this.size),t>=e?new Ke(0,0):new Ke(this.get(t,this._end),this.get(e,this._end),this._step))},Ke.prototype.indexOf=function(t){var e=t-this._start;if(e%this._step===0){var n=e/this._step;if(n>=0&&n<this.size)return n}return-1},Ke.prototype.lastIndexOf=function(t){return this.indexOf(t)},Ke.prototype.__iterate=function(t,e){for(var n=this.size-1,r=this._step,i=e?this._start+n*r:this._start,o=0;n>=o;o++){if(t(i,o,this)===!1)return o+1;i+=e?-r:r}return o},Ke.prototype.__iterator=function(t,e){var n=this.size-1,r=this._step,i=e?this._start+n*r:this._start,o=0;return new k(function(){var s=i;return i+=e?-r:r,o>n?x():w(t,o++,s)})},Ke.prototype.equals=function(t){return t instanceof Ke?this._start===t._start&&this._end===t._end&&this._step===t._step:He(this,t)};var tr;t(We,I),We.prototype.toString=function(){return 0===this.size?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"},We.prototype.get=function(t,e){return this.has(t)?this._value:e},We.prototype.contains=function(t){return J(this._value,t)},We.prototype.slice=function(t,e){var n=this.size;return u(t,e,n)?this:new We(this._value,l(e,n)-c(t,n))},We.prototype.reverse=function(){return this},We.prototype.indexOf=function(t){return J(this._value,t)?0:-1},We.prototype.lastIndexOf=function(t){return J(this._value,t)?this.size:-1},We.prototype.__iterate=function(t){for(var e=0;e<this.size;e++)if(t(this._value,e,this)===!1)return e+1;return e},We.prototype.__iterator=function(t){var e=this,n=0;return new k(function(){return n<e.size?w(t,n++,e._value):x()})},We.prototype.equals=function(t){return t instanceof We?J(this._value,t._value):He(t)};var er;d.Iterator=k,Ve(d,{toArray:function(){at(this.size);var t=new Array(this.size||0);

return this.valueSeq().__iterate(function(e,n){t[n]=e}),t},toIndexedSeq:function(){return new ct(this)},toJS:function(){return this.toSeq().map(function(t){return t&&"function"==typeof t.toJS?t.toJS():t}).__toJS()},toJSON:function(){return this.toSeq().map(function(t){return t&&"function"==typeof t.toJSON?t.toJSON():t}).__toJS()},toKeyedSeq:function(){return new ut(this,!0)},toMap:function(){return $t(this.toKeyedSeq())},toObject:function(){at(this.size);var t={};return this.__iterate(function(e,n){t[n]=e}),t},toOrderedMap:function(){return xe(this.toKeyedSeq())},toOrderedSet:function(){return $e(b(this)?this.valueSeq():this)},toSet:function(){return Oe(b(this)?this.valueSeq():this)},toSetSeq:function(){return new lt(this)},toSeq:function(){return g(this)?this.toIndexedSeq():b(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return je(b(this)?this.valueSeq():this)},toList:function(){return le(b(this)?this.valueSeq():this)},toString:function(){return"[Iterable]"},__toString:function(t,e){return 0===this.size?t+e:t+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+e},concat:function(){var t=on.call(arguments,0);return Bt(this,kt(this,t))},contains:function(t){return this.some(function(e){return J(e,t)})},entries:function(){return this.__iterator(_n)},every:function(t,e){at(this.size);var n=!0;return this.__iterate(function(r,i,o){return t.call(e,r,i,o)?void 0:(n=!1,!1)}),n},filter:function(t,e){return Bt(this,mt(this,t,e,!0))},find:function(t,e,n){var r=this.findEntry(t,e);return r?r[1]:n},findEntry:function(t,e){var n;return this.__iterate(function(r,i,o){return t.call(e,r,i,o)?(n=[i,r],!1):void 0}),n},findLastEntry:function(t,e){return this.toSeq().reverse().findEntry(t,e)},forEach:function(t,e){return at(this.size),this.__iterate(e?t.bind(e):t)},join:function(t){at(this.size),t=void 0!==t?""+t:",";var e="",n=!0;return this.__iterate(function(r){n?n=!1:e+=t,e+=null!==r&&void 0!==r?r:""}),e},keys:function(){return this.__iterator(bn)},map:function(t,e){return Bt(this,ht(this,t,e))},reduce:function(t,e,n){at(this.size);var r,i;return arguments.length<2?i=!0:r=e,this.__iterate(function(e,o,s){i?(i=!1,r=e):r=t.call(n,r,e,o,s)}),r},reduceRight:function(){var t=this.toKeyedSeq().reverse();return t.reduce.apply(t,arguments)},reverse:function(){return Bt(this,pt(this,!0))},slice:function(t,e){return Bt(this,gt(this,t,e,!0))},some:function(t,e){return!this.every(Ge(t),e)},sort:function(t){return Bt(this,Et(this,t))},values:function(){return this.__iterator(gn)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return void 0!==this.size?0===this.size:!this.some(function(){return!0})},count:function(t,e){return o(t?this.toSeq().filter(t,e):this)},countBy:function(t,e){return vt(this,t,e)},equals:function(t){return He(this,t)},entrySeq:function(){var t=this;if(t._cache)return new M(t._cache);var e=t.toSeq().map(Je).toIndexedSeq();return e.fromEntrySeq=function(){return t.toSeq()},e},filterNot:function(t,e){return this.filter(Ge(t),e)},findLast:function(t,e,n){return this.toKeyedSeq().reverse().find(t,e,n)},first:function(){return this.find(a)},flatMap:function(t,e){return Bt(this,xt(this,t,e))},flatten:function(t){return Bt(this,wt(this,t,!0))},fromEntrySeq:function(){return new ft(this)},get:function(t,e){return this.find(function(e,n){return J(n,t)},void 0,e)},getIn:function(t,e){for(var n,r=this,i=At(t);!(n=i.next()).done;){var o=n.value;if(r=r&&r.get?r.get(o,ln):ln,r===ln)return e}return r},groupBy:function(t,e){return bt(this,t,e)},has:function(t){return this.get(t,ln)!==ln},hasIn:function(t){return this.getIn(t,ln)!==ln},isSubset:function(t){return t="function"==typeof t.contains?t:d(t),this.every(function(e){return t.contains(e)})},isSuperset:function(t){return t.isSubset(this)},keySeq:function(){return this.toSeq().map(Qe).toIndexedSeq()},last:function(){return this.toSeq().reverse().first()},max:function(t){return Ct(this,t)},maxBy:function(t,e){return Ct(this,e,t)},min:function(t){return Ct(this,t?Xe(t):tn)},minBy:function(t,e){return Ct(this,e?Xe(e):tn,t)},rest:function(){return this.slice(1)},skip:function(t){return this.slice(Math.max(0,t))},skipLast:function(t){return Bt(this,this.toSeq().reverse().skip(t).reverse())},skipWhile:function(t,e){return Bt(this,yt(this,t,e,!0))},skipUntil:function(t,e){return this.skipWhile(Ge(t),e)},sortBy:function(t,e){return Bt(this,Et(this,e,t))},take:function(t){return this.slice(0,Math.max(0,t))},takeLast:function(t){return Bt(this,this.toSeq().reverse().take(t).reverse())},takeWhile:function(t,e){return Bt(this,_t(this,t,e))},takeUntil:function(t,e){return this.takeWhile(Ge(t),e)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=en(this))}});var nr=d.prototype;nr[hn]=!0,nr[wn]=nr.values,nr.__toJS=nr.toArray,nr.__toStringMapper=Ye,nr.inspect=nr.toSource=function(){return this.toString()},nr.chain=nr.flatMap,function(){try{Object.defineProperty(nr,"length",{get:function(){if(!d.noLengthWarning){var t;try{throw new Error}catch(e){t=e.stack}if(-1===t.indexOf("_wrapObject"))return console&&console.warn&&console.warn("iterable.length has been deprecated, use iterable.size or iterable.count(). This warning will become a silent error in a future version. "+t),this.size}}})}catch(t){}}(),Ve(h,{flip:function(){return Bt(this,dt(this))},findKey:function(t,e){var n=this.findEntry(t,e);return n&&n[0]},findLastKey:function(t,e){return this.toSeq().reverse().findKey(t,e)},keyOf:function(t){return this.findKey(function(e){return J(e,t)})},lastKeyOf:function(t){return this.findLastKey(function(e){return J(e,t)})},mapEntries:function(t,e){var n=this,r=0;return Bt(this,this.toSeq().map(function(i,o){return t.call(e,[o,i],r++,n)}).fromEntrySeq())},mapKeys:function(t,e){var n=this;return Bt(this,this.toSeq().flip().map(function(r,i){return t.call(e,r,i,n)}).flip())}});var rr=h.prototype;rr[pn]=!0,rr[wn]=nr.entries,rr.__toJS=nr.toObject,rr.__toStringMapper=function(t,e){return e+": "+Ye(t)},Ve(p,{toKeyedSeq:function(){return new ut(this,!1)},filter:function(t,e){return Bt(this,mt(this,t,e,!1))},findIndex:function(t,e){var n=this.findEntry(t,e);return n?n[0]:-1},indexOf:function(t){var e=this.toKeyedSeq().keyOf(t);return void 0===e?-1:e},lastIndexOf:function(t){return this.toSeq().reverse().indexOf(t)},reverse:function(){return Bt(this,pt(this,!1))},slice:function(t,e){return Bt(this,gt(this,t,e,!1))},splice:function(t,e){var n=arguments.length;if(e=Math.max(0|e,0),0===n||2===n&&!e)return this;t=c(t,this.size);var r=this.slice(0,t);return Bt(this,1===n?r:r.concat(i(arguments,2),this.slice(t+e)))},findLastIndex:function(t,e){var n=this.toKeyedSeq().findLastKey(t,e);return void 0===n?-1:n},first:function(){return this.get(0)},flatten:function(t){return Bt(this,wt(this,t,!1))},get:function(t,e){return t=s(this,t),0>t||this.size===1/0||void 0!==this.size&&t>this.size?e:this.find(function(e,n){return n===t},void 0,e)},has:function(t){return t=s(this,t),t>=0&&(void 0!==this.size?this.size===1/0||t<this.size:-1!==this.indexOf(t))},interpose:function(t){return Bt(this,St(this,t))},interleave:function(){var t=[this].concat(i(arguments)),e=jt(this.toSeq(),I.of,t),n=e.flatten(!0);return e.size&&(n.size=e.size*t.length),Bt(this,n)},last:function(){return this.get(-1)},skipWhile:function(t,e){return Bt(this,yt(this,t,e,!1))},zip:function(){var t=[this].concat(i(arguments));return Bt(this,jt(this,Ze,t))},zipWith:function(t){var e=i(arguments);return e[0]=this,Bt(this,jt(this,t,e))}}),p.prototype[mn]=!0,p.prototype[vn]=!0,Ve(m,{get:function(t,e){return this.has(t)?t:e},contains:function(t){return this.has(t)},keySeq:function(){return this.valueSeq()}}),m.prototype.has=nr.contains,Ve(D,h.prototype),Ve(I,p.prototype),Ve(O,m.prototype),Ve(W,h.prototype),Ve(V,p.prototype),Ve(Q,m.prototype);var ir={Iterable:d,Seq:B,Collection:K,Map:$t,OrderedMap:xe,List:le,Stack:je,Set:Oe,OrderedSet:$e,Record:Re,Range:Ke,Repeat:We,is:J,fromJS:G};return ir})},{}],55:[function(t,e){function n(t,e,n,o){return"boolean"!=typeof e&&null!=e&&(o=n,n="function"!=typeof e&&o&&o[e]===t?null:e,e=!1),null!=n&&(t=i(t,n,o)),r(t,e)}var r=t("../internals/baseFlatten"),i=t("../collections/map");e.exports=n},{"../collections/map":59,"../internals/baseFlatten":68}],56:[function(t,e){function n(t,e,n){var a=0,u=t?t.length:0;if("number"!=typeof e&&null!=e){var c=u;for(e=i(e,n,3);c--&&e(t[c],c,t);)a++}else if(a=e,null==a||n)return t?t[u-1]:r;return o(t,s(0,u-a))}var r,i=t("../functions/createCallback"),o=t("../internals/slice"),s=Math.max;e.exports=n},{"../functions/createCallback":62,"../internals/slice":82}],57:[function(t,e){function n(t){for(var e=arguments,n=0,r=e.length,o=t?t.length:0;++n<r;)for(var s=-1,a=e[n];++s<o;)t[s]===a&&(i.call(t,s--,1),o--);return t}var r=[],i=r.splice;e.exports=n},{}],58:[function(t,e){function n(t,e,n){var u=-1,c=r,l=t?t.length:0,f=!1;return n=(0>n?a(0,l+n):n)||0,o(t)?f=c(t,e,n)>-1:"number"==typeof l?f=(s(t)?t.indexOf(e,n):c(t,e,n))>-1:i(t,function(t){return++u>=n?!(f=t===e):void 0}),f}var r=t("../internals/baseIndexOf"),i=t("../objects/forOwn"),o=t("../objects/isArray"),s=t("../objects/isString"),a=Math.max;e.exports=n},{"../internals/baseIndexOf":69,"../objects/forOwn":86,"../objects/isArray":88,"../objects/isString":91}],59:[function(t,e){function n(t,e,n){var o=-1,s=t?t.length:0;if(e=r(e,n,3),"number"==typeof s)for(var a=Array(s);++o<s;)a[o]=e(t[o],o,t);else a=[],i(t,function(t,n,r){a[++o]=e(t,n,r)});return a}var r=t("../functions/createCallback"),i=t("../objects/forOwn");e.exports=n},{"../functions/createCallback":62,"../objects/forOwn":86}],60:[function(t,e){function n(t){return t&&"number"==typeof t.length?r(t):i(t)}var r=(t("../objects/isString"),t("../internals/slice")),i=t("../objects/values");e.exports=n},{"../internals/slice":82,"../objects/isString":91,"../objects/values":93}],61:[function(t,e){function n(t,e){return arguments.length>2?r(t,17,i(arguments,2),null,e):r(t,1,null,null,e)}var r=t("../internals/createWrapper"),i=t("../internals/slice");e.exports=n},{"../internals/createWrapper":71,"../internals/slice":82}],62:[function(t,e){function n(t,e,n){var u=typeof t;if(null==t||"function"==u)return r(t,e,n);if("object"!=u)return a(t);var c=s(t),l=c[0],f=t[l];return 1!=c.length||f!==f||o(f)?function(e){for(var n=c.length,r=!1;n--&&(r=i(e[c[n]],t[c[n]],null,!0)););return r}:function(t){var e=t[l];return f===e&&(0!==f||1/f==1/e)}}var r=t("../internals/baseCreateCallback"),i=t("../internals/baseIsEqual"),o=t("../objects/isObject"),s=t("../objects/keys"),a=t("../utilities/property");e.exports=n},{"../internals/baseCreateCallback":66,"../internals/baseIsEqual":70,"../objects/isObject":90,"../objects/keys":92,"../utilities/property":98}],63:[function(t,e){var n=[];e.exports=n},{}],64:[function(t,e){function n(t){function e(){if(a){var t=s(a);u.apply(t,arguments)}if(this instanceof e){var o=r(n.prototype),l=n.apply(o,t||arguments);return i(l)?l:o}return n.apply(c,t||arguments)}var n=t[0],a=t[2],c=t[4];return o(e,t),e}var r=t("./baseCreate"),i=t("../objects/isObject"),o=t("./setBindData"),s=t("./slice"),a=[],u=a.push;e.exports=n},{"../objects/isObject":90,"./baseCreate":65,"./setBindData":80,"./slice":82}],65:[function(t,e){function n(t){return i(t)?o(t):{}}var r=t("./isNative"),i=t("../objects/isObject"),o=(t("../utilities/noop"),r(o=Object.create)&&o);o||(n=function(){function t(){}return function(e){if(i(e)){t.prototype=e;var n=new t;t.prototype=null}return n||window.Object()}}()),e.exports=n},{"../objects/isObject":90,"../utilities/noop":97,"./isNative":75}],66:[function(t,e){function n(t,e,n){if("function"!=typeof t)return i;if("undefined"==typeof e||!("prototype"in t))return t;var l=t.__bindData__;if("undefined"==typeof l&&(s.funcNames&&(l=!t.name),l=l||!s.funcDecomp,!l)){var f=c.call(t);s.funcNames||(l=!a.test(f)),l||(l=u.test(f),o(t,l))}if(l===!1||l!==!0&&1&l[1])return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,o){return t.call(e,n,r,i,o)}}return r(t,e)}var r=t("../functions/bind"),i=t("../utilities/identity"),o=t("./setBindData"),s=t("../support"),a=/^\s*function[ \n\r\t]+\w/,u=/\bthis\b/,c=Function.prototype.toString;e.exports=n},{"../functions/bind":61,"../support":94,"../utilities/identity":96,"./setBindData":80}],67:[function(t,e){function n(t){function e(){var t=p?d:this;if(l){var o=s(l);u.apply(o,arguments)}if((f||v)&&(o||(o=s(arguments)),f&&u.apply(o,f),v&&o.length<h))return c|=16,n([a,b?c:-4&c,o,null,d,h]);if(o||(o=arguments),m&&(a=t[g]),this instanceof e){t=r(a.prototype);var _=a.apply(t,o);return i(_)?_:t}return a.apply(t,o)}var a=t[0],c=t[1],l=t[2],f=t[3],d=t[4],h=t[5],p=1&c,m=2&c,v=4&c,b=8&c,g=a;return o(e,t),e}var r=t("./baseCreate"),i=t("../objects/isObject"),o=t("./setBindData"),s=t("./slice"),a=[],u=a.push;e.exports=n},{"../objects/isObject":90,"./baseCreate":65,"./setBindData":80,"./slice":82}],68:[function(t,e){function n(t,e,o,s){for(var a=(s||0)-1,u=t?t.length:0,c=[];++a<u;){var l=t[a];if(l&&"object"==typeof l&&"number"==typeof l.length&&(i(l)||r(l))){e||(l=n(l,e,o));var f=-1,d=l.length,h=c.length;for(c.length+=d;++f<d;)c[h++]=l[f]}else o||c.push(l)}return c}var r=t("../objects/isArguments"),i=t("../objects/isArray");e.exports=n},{"../objects/isArguments":87,"../objects/isArray":88}],69:[function(t,e){function n(t,e,n){for(var r=(n||0)-1,i=t?t.length:0;++r<i;)if(t[r]===e)return r;return-1}e.exports=n},{}],70:[function(t,e){function n(t,e,v,_,y,k){if(v){var w=v(t,e);if("undefined"!=typeof w)return!!w}if(t===e)return 0!==t||1/t==1/e;var x=typeof t,S=typeof e;if(!(t!==t||t&&s[x]||e&&s[S]))return!1;if(null==t||null==e)return t===e;var E=b.call(t),C=b.call(e);if(E==u&&(E=h),C==u&&(C=h),E!=C)return!1;switch(E){case l:case f:return+t==+e;case d:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case p:case m:return t==String(e)}var T=E==c;if(!T){var j=g.call(t,"__wrapped__"),B=g.call(e,"__wrapped__");if(j||B)return n(j?t.__wrapped__:t,B?e.__wrapped__:e,v,_,y,k);if(E!=h)return!1;var D=t.constructor,I=e.constructor;if(D!=I&&!(o(D)&&D instanceof D&&o(I)&&I instanceof I)&&"constructor"in t&&"constructor"in e)return!1}var O=!y;y||(y=i()),k||(k=i());for(var M=y.length;M--;)if(y[M]==t)return k[M]==e;var N=0;if(w=!0,y.push(t),k.push(e),T){if(M=t.length,N=e.length,w=N==M,w||_)for(;N--;){var L=M,A=e[N];if(_)for(;L--&&!(w=n(t[L],A,v,_,y,k)););else if(!(w=n(t[N],A,v,_,y,k)))break}}else r(e,function(e,r,i){return g.call(i,r)?(N++,w=g.call(t,r)&&n(t[r],e,v,_,y,k)):void 0}),w&&!_&&r(t,function(t,e,n){return g.call(n,e)?w=--N>-1:void 0});return y.pop(),k.pop(),O&&(a(y),a(k)),w}var r=t("../objects/forIn"),i=t("./getArray"),o=t("../objects/isFunction"),s=t("./objectTypes"),a=t("./releaseArray"),u="[object Arguments]",c="[object Array]",l="[object Boolean]",f="[object Date]",d="[object Number]",h="[object Object]",p="[object RegExp]",m="[object String]",v=Object.prototype,b=v.toString,g=v.hasOwnProperty;e.exports=n},{"../objects/forIn":85,"../objects/isFunction":89,"./getArray":73,"./objectTypes":77,"./releaseArray":79}],71:[function(t,e){function n(t,e,a,l,f,d){var h=1&e,p=2&e,m=4&e,v=16&e,b=32&e;if(!p&&!o(t))throw new TypeError;v&&!a.length&&(e&=-17,v=a=!1),b&&!l.length&&(e&=-33,b=l=!1);var g=t&&t.__bindData__;if(g&&g!==!0)return g=s(g),g[2]&&(g[2]=s(g[2])),g[3]&&(g[3]=s(g[3])),!h||1&g[1]||(g[4]=f),!h&&1&g[1]&&(e|=8),!m||4&g[1]||(g[5]=d),v&&u.apply(g[2]||(g[2]=[]),a),b&&c.apply(g[3]||(g[3]=[]),l),g[1]|=e,n.apply(null,g);var _=1==e||17===e?r:i;return _([t,e,a,l,f,d])}var r=t("./baseBind"),i=t("./baseCreateWrapper"),o=t("../objects/isFunction"),s=t("./slice"),a=[],u=a.push,c=a.unshift;e.exports=n},{"../objects/isFunction":89,"./baseBind":64,"./baseCreateWrapper":67,"./slice":82}],72:[function(t,e){function n(t){return r[t]}var r=t("./htmlEscapes");e.exports=n},{"./htmlEscapes":74}],73:[function(t,e){function n(){return r.pop()||[]}var r=t("./arrayPool");e.exports=n},{"./arrayPool":63}],74:[function(t,e){var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};e.exports=n},{}],75:[function(t,e){function n(t){return"function"==typeof t&&o.test(t)}var r=Object.prototype,i=r.toString,o=RegExp("^"+String(i).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$");e.exports=n},{}],76:[function(t,e){var n=40;e.exports=n},{}],77:[function(t,e){var n={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1};e.exports=n},{}],78:[function(t,e){var n=t("./htmlEscapes"),r=t("../objects/keys"),i=RegExp("["+r(n).join("")+"]","g");e.exports=i},{"../objects/keys":92,"./htmlEscapes":74}],79:[function(t,e){function n(t){t.length=0,r.length<i&&r.push(t)}var r=t("./arrayPool"),i=t("./maxPoolSize");e.exports=n},{"./arrayPool":63,"./maxPoolSize":76}],80:[function(t,e){var n=t("./isNative"),r=t("../utilities/noop"),i={configurable:!1,enumerable:!1,value:null,writable:!1},o=function(){try{var t={},e=n(e=Object.defineProperty)&&e,r=e(t,t,t)&&e}catch(i){}return r}(),s=o?function(t,e){i.value=e,o(t,"__bindData__",i)}:r;e.exports=s},{"../utilities/noop":97,"./isNative":75}],81:[function(t,e){var n=t("./objectTypes"),r=Object.prototype,i=r.hasOwnProperty,o=function(t){var e,r=t,o=[];if(!r)return o;if(!n[typeof t])return o;for(e in r)i.call(r,e)&&o.push(e);return o};e.exports=o},{"./objectTypes":77}],82:[function(t,e){function n(t,e,n){e||(e=0),"undefined"==typeof n&&(n=t?t.length:0);for(var r=-1,i=n-e||0,o=Array(0>i?0:i);++r<i;)o[r]=t[e+r];return o}e.exports=n},{}],83:[function(t,e){var n=t("../internals/baseCreateCallback"),r=t("./keys"),i=t("../internals/objectTypes"),o=function(t,e,o){var s,a=t,u=a;if(!a)return u;var c=arguments,l=0,f="number"==typeof o?2:c.length;if(f>3&&"function"==typeof c[f-2])var d=n(c[--f-1],c[f--],2);else f>2&&"function"==typeof c[f-1]&&(d=c[--f]);for(;++l<f;)if(a=c[l],a&&i[typeof a])for(var h=-1,p=i[typeof a]&&r(a),m=p?p.length:0;++h<m;)s=p[h],u[s]=d?d(u[s],a[s]):a[s];return u};e.exports=o},{"../internals/baseCreateCallback":66,"../internals/objectTypes":77,"./keys":92}],84:[function(t,e){var n=t("./keys"),r=t("../internals/objectTypes"),i=function(t,e,i){var o,s=t,a=s;if(!s)return a;for(var u=arguments,c=0,l="number"==typeof i?2:u.length;++c<l;)if(s=u[c],s&&r[typeof s])for(var f=-1,d=r[typeof s]&&n(s),h=d?d.length:0;++f<h;)o=d[f],"undefined"==typeof a[o]&&(a[o]=s[o]);return a};e.exports=i},{"../internals/objectTypes":77,"./keys":92}],85:[function(t,e){var n=t("../internals/baseCreateCallback"),r=t("../internals/objectTypes"),i=function(t,e,i){var o,s=t,a=s;if(!s)return a;if(!r[typeof s])return a;e=e&&"undefined"==typeof i?e:n(e,i,3);for(o in s)if(e(s[o],o,t)===!1)return a;return a};e.exports=i},{"../internals/baseCreateCallback":66,"../internals/objectTypes":77}],86:[function(t,e){var n=t("../internals/baseCreateCallback"),r=t("./keys"),i=t("../internals/objectTypes"),o=function(t,e,o){var s,a=t,u=a;if(!a)return u;if(!i[typeof a])return u;e=e&&"undefined"==typeof o?e:n(e,o,3);for(var c=-1,l=i[typeof a]&&r(a),f=l?l.length:0;++c<f;)if(s=l[c],e(a[s],s,t)===!1)return u;return u};e.exports=o},{"../internals/baseCreateCallback":66,"../internals/objectTypes":77,"./keys":92}],87:[function(t,e){function n(t){return t&&"object"==typeof t&&"number"==typeof t.length&&o.call(t)==r||!1}var r="[object Arguments]",i=Object.prototype,o=i.toString;e.exports=n},{}],88:[function(t,e){var n=t("../internals/isNative"),r="[object Array]",i=Object.prototype,o=i.toString,s=n(s=Array.isArray)&&s,a=s||function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&o.call(t)==r||!1};e.exports=a},{"../internals/isNative":75}],89:[function(t,e){function n(t){return"function"==typeof t}e.exports=n},{}],90:[function(t,e){function n(t){return!(!t||!r[typeof t])}var r=t("../internals/objectTypes");e.exports=n},{"../internals/objectTypes":77}],91:[function(t,e){function n(t){return"string"==typeof t||t&&"object"==typeof t&&o.call(t)==r||!1}var r="[object String]",i=Object.prototype,o=i.toString;e.exports=n},{}],92:[function(t,e){var n=t("../internals/isNative"),r=t("./isObject"),i=t("../internals/shimKeys"),o=n(o=Object.keys)&&o,s=o?function(t){return r(t)?o(t):[]}:i;e.exports=s},{"../internals/isNative":75,"../internals/shimKeys":81,"./isObject":90}],93:[function(t,e){function n(t){for(var e=-1,n=r(t),i=n.length,o=Array(i);++e<i;)o[e]=t[n[e]];return o}var r=t("./keys");e.exports=n},{"./keys":92}],94:[function(t,e){var n=t("./internals/isNative"),r=/\bthis\b/,i={};i.funcDecomp=!n(window.WinRTError)&&r.test(function(){return this}),i.funcNames="string"==typeof Function.name,e.exports=i},{"./internals/isNative":75}],95:[function(t,e){function n(t){return null==t?"":String(t).replace(i,r)}var r=t("../internals/escapeHtmlChar"),i=(t("../objects/keys"),t("../internals/reUnescapedHtml"));e.exports=n},{"../internals/escapeHtmlChar":72,"../internals/reUnescapedHtml":78,"../objects/keys":92}],96:[function(t,e){function n(t){return t}e.exports=n},{}],97:[function(t,e){function n(){}e.exports=n},{}],98:[function(t,e){function n(t){return function(e){return e[t]}}e.exports=n},{}],99:[function(t,e){var n=t("./api/command-patch"),r=t("./api/command"),i=t("./api/node"),o=t("./api/selection"),s=t("./api/simple-command");e.exports=function(t){this.CommandPatch=n(t),this.Command=r(t),this.Node=i,this.Selection=o(t),this.SimpleCommand=s(this,t)}},{"./api/command":101,"./api/command-patch":100,"./api/node":102,"./api/selection":103,"./api/simple-command":104}],100:[function(t,e){"use strict";e.exports=function(t){function e(t){this.commandName=t}return e.prototype.execute=function(e){t.transactionManager.run(function(){document.execCommand(this.commandName,!1,e||null)}.bind(this))},e.prototype.queryState=function(){return document.queryCommandState(this.commandName)},e.prototype.queryEnabled=function(){return document.queryCommandEnabled(this.commandName)},e}},{}],101:[function(t,e){"use strict";e.exports=function(t){function e(e){this.commandName=e,this.patch=t.commandPatches[this.commandName]}return e.prototype.execute=function(e){this.patch?this.patch.execute(e):t.transactionManager.run(function(){document.execCommand(this.commandName,!1,e||null)}.bind(this))},e.prototype.queryState=function(){return this.patch?this.patch.queryState():document.queryCommandState(this.commandName)},e.prototype.queryEnabled=function(){return this.patch?this.patch.queryEnabled():document.queryCommandEnabled(this.commandName)},e}},{}],102:[function(t,e){"use strict";function n(t){this.node=t}n.prototype.getAncestor=function(t,e){var n=function(e){return t===e};if(!n(this.node))for(var r=this.node.parentNode;r&&!n(r);){if(e(r))return r;r=r.parentNode}},n.prototype.nextAll=function(){for(var t=[],e=this.node.nextSibling;e;)t.push(e),e=e.nextSibling;return t},e.exports=n},{}],103:[function(t,e){t("../element");e.exports=function(t){function e(){for(var e=document,n=t.el.parentNode;n&&n.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&n.nodeType!==Node.DOCUMENT_NODE;)n=n.parentNode;if(n&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&n.getSelection&&(e=n),this.selection=e.getSelection(),this.selection.rangeCount){this.range=document.createRange();var r=document.createRange();this.range.setStart(this.selection.anchorNode,this.selection.anchorOffset),r.setStart(this.selection.focusNode,this.selection.focusOffset),this.range.compareBoundaryPoints(Range.START_TO_START,r)<=0?this.range.setEnd(this.selection.focusNode,this.selection.focusOffset):(this.range=r,this.range.setEnd(this.selection.anchorNode,this.selection.anchorOffset))}}return e.prototype.getContaining=function(e){var n=this.range;if(n){var r=new t.api.Node(this.range.commonAncestorContainer),i=r.node&&t.el===r.node;return!i&&e(r.node)?r.node:r.getAncestor(t.el,e)}},e.prototype.placeMarkers=function(){var e=this.range;if(e&&t.el.offsetParent){var n=document.createRange();n.selectNodeContents(t.el);var r=this.range.compareBoundaryPoints(Range.START_TO_START,n)>=0,i=this.range.compareBoundaryPoints(Range.END_TO_END,n)<=0;if(r&&i){var o=document.createElement("em");o.classList.add("scribe-marker");var s=document.createElement("em");s.classList.add("scribe-marker");var a=this.range.cloneRange();if(a.collapse(!1),a.insertNode(s),s.nextSibling&&s.nextSibling.nodeType===Node.TEXT_NODE&&""===s.nextSibling.data&&s.parentNode.removeChild(s.nextSibling),s.previousSibling&&s.previousSibling.nodeType===Node.TEXT_NODE&&""===s.previousSibling.data&&s.parentNode.removeChild(s.previousSibling),!this.range.collapsed){var u=this.range.cloneRange();u.collapse(!0),u.insertNode(o),o.nextSibling&&o.nextSibling.nodeType===Node.TEXT_NODE&&""===o.nextSibling.data&&o.parentNode.removeChild(o.nextSibling),o.previousSibling&&o.previousSibling.nodeType===Node.TEXT_NODE&&""===o.previousSibling.data&&o.parentNode.removeChild(o.previousSibling)}this.selection.removeAllRanges(),this.selection.addRange(this.range)}}},e.prototype.getMarkers=function(){return t.el.querySelectorAll("em.scribe-marker")},e.prototype.removeMarkers=function(){var t=this.getMarkers();Array.prototype.forEach.call(t,function(t){t.parentNode.removeChild(t)})},e.prototype.selectMarkers=function(t){var e=this.getMarkers();if(e.length){var n=document.createRange();n.setStartBefore(e[0]),n.setEndAfter(e.length>=2?e[1]:e[0]),t||this.removeMarkers(),this.selection.removeAllRanges(),this.selection.addRange(n)}},e.prototype.isCaretOnNewLine=function(){function t(t){for(var e=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,null,!1),n=e.root;n;){var r=n.childNodes.length;if(r>1||1===r&&""!==n.textContent.trim())return!1;if(0===r)return""===n.textContent.trim();n=e.nextNode()}}var e=this.getContaining(function(t){return"P"===t.nodeName});return e?t(e):!1},e}},{"../element":106}],104:[function(t,e){"use strict";e.exports=function(t,e){function n(t,n){e.api.Command.call(this,t),this._nodeName=n}return n.prototype=Object.create(t.Command.prototype),n.prototype.constructor=n,n.prototype.queryState=function(){var t=new e.api.Selection;return e.api.Command.prototype.queryState.call(this)&&!!t.getContaining(function(t){return t.nodeName===this._nodeName}.bind(this))},n}},{}],105:[function(t,e){function n(t,e){function n(t){var e=r(t.map(function(t){var e=i(t.addedNodes),n=i(t.removedNodes);return e.concat(n)})),n=e.filter(function(t){return!s.isEmptyTextNode(t)}).filter(function(t){return!o.isSelectionMarkerNode(t)});return n.length>0}var a=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,u=!1,c=new a(function(t){if(!u&&n(t)){u=!0;try{e()}catch(r){throw r}finally{setTimeout(function(){u=!1},0)}}});return c.observe(t,{attributes:!0,childList:!0,subtree:!0}),c}var r=t("lodash-amd/modern/arrays/flatten"),i=t("lodash-amd/modern/collections/toArray"),o=t("./element"),s=t("./node");e.exports=n},{"./element":106,"./node":108,"lodash-amd/modern/arrays/flatten":55,"lodash-amd/modern/collections/toArray":60}],106:[function(t,e){function n(t){return s(a,t.nodeName)}function r(t){return t.nodeType===Node.ELEMENT_NODE&&"scribe-marker"===t.className}function i(t){return t.nodeType===Node.ELEMENT_NODE&&"caret-position"===t.className}function o(t,e){for(;e.childNodes.length>0;)t.insertBefore(e.childNodes[0],e);t.removeChild(e)}var s=t("lodash-amd/modern/collections/contains"),a=["ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","CANVAS","DD","DIV","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","LI","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TD","TH","TFOOT","UL","VIDEO"];e.exports={isBlockElement:n,isSelectionMarkerNode:r,isCaretPositionNode:i,unwrap:o}},{"lodash-amd/modern/collections/contains":58}],107:[function(t,e){function n(){this._listeners={}}var r=(t("lodash-amd/modern/arrays/pull"),t("immutable/dist/immutable"));n.prototype.on=function(t,e){var n=this._listeners[t]||r.Set();this._listeners[t]=n.add(e)},n.prototype.off=function(t,e){var n=this._listeners[t]||r.Set();n=e?n["delete"](e):n.clear()},n.prototype.trigger=function(t,e){for(var n=t.split(":");n.length;){var i=n.join(":"),o=this._listeners[i]||r.Set();o.forEach(function(t){t.apply(null,e)}),n.splice(n.length-1,1)}},e.exports=n},{"immutable/dist/immutable":54,"lodash-amd/modern/arrays/pull":57}],108:[function(t,e){"use strict";function n(t){return t.nodeType===Node.TEXT_NODE&&""===t.textContent}function r(t,e){return e.parentNode.insertBefore(t,e.nextSibling)}function i(t){return t.parentNode.removeChild(t)}e.exports={isEmptyTextNode:n,insertAfter:r,removeNode:i}},{}],109:[function(t,e){var n=t("./commands/indent"),r=t("./commands/insert-list"),i=t("./commands/outdent"),o=t("./commands/redo"),s=t("./commands/subscript"),a=t("./commands/superscript"),u=t("./commands/undo");e.exports={indent:n,insertList:r,outdent:i,redo:o,subscript:s,superscript:a,undo:u}},{"./commands/indent":110,"./commands/insert-list":111,"./commands/outdent":112,"./commands/redo":113,"./commands/subscript":114,"./commands/superscript":115,"./commands/undo":116}],110:[function(t,e){"use strict";e.exports=function(){return function(t){var e=new t.api.Command("indent");e.queryEnabled=function(){var e=new t.api.Selection,n=e.getContaining(function(t){return"UL"===t.nodeName||"OL"===t.nodeName});return t.api.Command.prototype.queryEnabled.call(this)&&t.allowsBlockElements()&&!n},t.commands.indent=e}}},{}],111:[function(t,e){"use strict";e.exports=function(){return function(t){var e=function(e){t.api.Command.call(this,e)};e.prototype=Object.create(t.api.Command.prototype),e.prototype.constructor=e,e.prototype.execute=function(e){function n(t){if(t.length>0){var e=document.createElement(o.nodeName);t.forEach(function(t){e.appendChild(t)}),o.parentNode.insertBefore(e,o.nextElementSibling)}}if(this.queryState()){var r=new t.api.Selection,i=r.range,o=r.getContaining(function(t){return"OL"===t.nodeName||"UL"===t.nodeName}),s=r.getContaining(function(t){return"LI"===t.nodeName});t.transactionManager.run(function(){if(s){var e=new t.api.Node(s).nextAll();n(e),r.placeMarkers();var a=document.createElement("p");a.innerHTML=s.innerHTML,o.parentNode.insertBefore(a,o.nextElementSibling),s.parentNode.removeChild(s)}else{var u=Array.prototype.map.call(o.querySelectorAll("li"),function(t){return i.intersectsNode(t)&&t}).filter(function(t){return t}),c=u.slice(-1)[0],l=new t.api.Node(c).nextAll();n(l),r.placeMarkers();var f=document.createDocumentFragment();u.forEach(function(t){var e=document.createElement("p");e.innerHTML=t.innerHTML,f.appendChild(e)}),o.parentNode.insertBefore(f,o.nextElementSibling),u.forEach(function(t){t.parentNode.removeChild(t)})}0===o.childNodes.length&&o.parentNode.removeChild(o),r.selectMarkers()}.bind(this))}else t.api.Command.prototype.execute.call(this,e)},e.prototype.queryEnabled=function(){return t.api.Command.prototype.queryEnabled.call(this)&&t.allowsBlockElements()},t.commands.insertOrderedList=new e("insertOrderedList"),t.commands.insertUnorderedList=new e("insertUnorderedList")}}},{}],112:[function(t,e){"use strict";e.exports=function(){return function(t){var e=new t.api.Command("outdent");e.queryEnabled=function(){var e=new t.api.Selection,n=e.getContaining(function(t){return"UL"===t.nodeName||"OL"===t.nodeName});return t.api.Command.prototype.queryEnabled.call(this)&&t.allowsBlockElements()&&!n},t.commands.outdent=e}}},{}],113:[function(t,e){"use strict";e.exports=function(){return function(t){var e=new t.api.Command("redo");e.execute=function(){var e=t.undoManager.redo();"undefined"!=typeof e&&t.restoreFromHistory(e)},e.queryEnabled=function(){return t.undoManager.position<t.undoManager.stack.length-1},t.commands.redo=e,t.options.undo.enabled&&t.el.addEventListener("keydown",function(t){t.shiftKey&&(t.metaKey||t.ctrlKey)&&90===t.keyCode&&(t.preventDefault(),e.execute())})}}},{}],114:[function(t,e){"use strict";e.exports=function(){return function(t){var e=new t.api.Command("subscript");t.commands.subscript=e}}},{}],115:[function(t,e){"use strict";e.exports=function(){return function(t){
var e=new t.api.Command("superscript");t.commands.superscript=e}}},{}],116:[function(t,e){"use strict";e.exports=function(){return function(t){var e=new t.api.Command("undo");e.execute=function(){var e=t.undoManager.undo();"undefined"!=typeof e&&t.restoreFromHistory(e)},e.queryEnabled=function(){return t.undoManager.position>1},t.commands.undo=e,t.options.undo.enabled&&t.el.addEventListener("keydown",function(t){t.shiftKey||!t.metaKey&&!t.ctrlKey||90!==t.keyCode||(t.preventDefault(),e.execute())})}}},{}],117:[function(t,e){var n=t("lodash-amd/modern/collections/contains"),r=t("../../dom-observer");e.exports=function(){return function(t){var e=function(){setTimeout(function(){t.pushHistory()}.bind(t),0),t.el.removeEventListener("focus",e)}.bind(t);t.el.addEventListener("focus",e),t.el.addEventListener("focus",function(){function e(t){var n=document.createTreeWalker(t,NodeFilter.SHOW_ALL,null,!1),r=n.currentNode;return n.firstChild()?"BR"===n.currentNode.nodeName?r:e(n.currentNode):n.currentNode}var n=new t.api.Selection;if(n.range){var r=t.allowsBlockElements()&&n.range.startContainer===t.el;if(r){var i=e(t.el.firstChild),o=n.range;o.setStart(i,0),o.setEnd(i,0),n.selection.removeAllRanges(),n.selection.addRange(o)}}}.bind(t));var i=function(){if(!t._skipFormatters){var e=new t.api.Selection,n=e.range,r=function(){n&&e.placeMarkers(),t.setHTML(t._htmlFormatterFactory.format(t.getHTML())),e.selectMarkers()}.bind(t);n?(t.undoManager&&t.undoManager.undo(),t.transactionManager.run(r)):r()}delete t._skipFormatters}.bind(t);r(t.el,i),t.allowsBlockElements()&&t.el.addEventListener("keydown",function(e){if(13===e.keyCode){var n=new t.api.Selection,r=n.range,i=n.getContaining(function(t){return/^(H[1-6])$/.test(t.nodeName)});if(i&&r.collapsed){var o=r.cloneRange();o.setEndAfter(i,0);var s=o.cloneContents();""===s.firstChild.textContent&&(e.preventDefault(),t.transactionManager.run(function(){var t=document.createElement("p"),e=document.createElement("br");t.appendChild(e),i.parentNode.insertBefore(t,i.nextElementSibling),r.setStart(t,0),r.setEnd(t,0),n.selection.removeAllRanges(),n.selection.addRange(r)}))}}}),t.allowsBlockElements()&&t.el.addEventListener("keydown",function(e){if(13===e.keyCode||8===e.keyCode){var n=new t.api.Selection,r=n.range;if(r.collapsed){var i=n.getContaining(function(t){return"LI"===t.nodeName});if(i&&""===i.textContent.trim()){e.preventDefault();var o=n.getContaining(function(t){return"UL"===t.nodeName||"OL"===t.nodeName}),s=t.getCommand("OL"===o.nodeName?"insertOrderedList":"insertUnorderedList");s.execute()}}}}),t.el.addEventListener("paste",function(e){if(e.clipboardData)e.preventDefault(),n(e.clipboardData.types,"text/html")?t.insertHTML(e.clipboardData.getData("text/html")):t.insertPlainText(e.clipboardData.getData("text/plain"));else{var r=new t.api.Selection;r.placeMarkers();var i=document.createElement("div");document.body.appendChild(i),i.setAttribute("contenteditable",!0),i.focus(),setTimeout(function(){var e=i.innerHTML;i.parentNode.removeChild(i),r.selectMarkers(),t.el.focus(),t.insertHTML(e)},1)}})}}},{"../../dom-observer":105,"lodash-amd/modern/collections/contains":58}],118:[function(t,e){function n(t,e){var n=Array.prototype.reduce.call(e.childNodes,function(e,n){function r(){var t=[n];e.push(t)}var o=i(e);if(o){var s=t.element.isBlockElement(o[0]);s===t.element.isBlockElement(n)?o.push(n):r()}else r();return e},[]),r=n.filter(function(e){var n=t.element.isBlockElement(e[0]);return!n});r.forEach(function(t){var e=document.createElement("p");t[0].parentNode.insertBefore(e,t[0]),t.forEach(function(t){e.appendChild(t)})}),e._isWrapped=!0}function r(t,e){for(var i=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,null,!1),o=i.firstChild();o;){if("BLOCKQUOTE"===o.nodeName&&!o._isWrapped){n(t,o),r(t,e);break}o=i.nextSibling()}}var i=t("lodash-amd/modern/arrays/last");e.exports=function(){return function(t){t.registerHTMLFormatter("normalize",function(e){var i=document.createElement("div");return i.innerHTML=e,n(t,i),r(t,i),i.innerHTML})}}},{"lodash-amd/modern/arrays/last":56}],119:[function(t,e){function n(t,e){return t.isCaretPositionNode(e)?!0:""===e.parentNode.textContent.trim()}function r(t,e){function s(e){return 0===e.children.length&&t.isBlockElement(e)||1===e.children.length&&t.isSelectionMarkerNode(e.children[0])?!0:t.isBlockElement(e)||0!==e.children.length?!1:n(t,e)}for(var a=e.firstElementChild;a;)t.isSelectionMarkerNode(a)||(s(a)&&""===a.textContent.trim()&&!i(o,a.nodeName)?a.appendChild(document.createElement("br")):a.children.length>0&&r(t,a)),a=a.nextElementSibling}var i=(t("../../../../element"),t("lodash-amd/modern/collections/contains")),o=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];e.exports=function(){return function(t){t.registerHTMLFormatter("normalize",function(e){var n=document.createElement("div");return n.innerHTML=e,r(t.element,n),n.innerHTML})}}},{"../../../../element":106,"lodash-amd/modern/collections/contains":58}],120:[function(t,e){"use strict";e.exports=function(){return function(t){var e=/(\s|&nbsp;)+/g;t.registerHTMLFormatter("export",function(t){return t.replace(e," ")})}}},{}],121:[function(t,e){var n=t("lodash-amd/modern/utilities/escape");e.exports=function(){return function(t){t.registerPlainTextFormatter(n)}}},{"lodash-amd/modern/utilities/escape":95}],122:[function(t,e){"use strict";function n(t){for(var e=document.createTreeWalker(t,NodeFilter.SHOW_ALL,null,!1);e.nextNode();)if(e.currentNode&&(~["br"].indexOf(e.currentNode.nodeName.toLowerCase())||e.currentNode.length>0))return!0;return!1}e.exports=function(){return function(t){t.el.addEventListener("keydown",function(e){if(13===e.keyCode){var r=new t.api.Selection,i=r.range,o=r.getContaining(function(t){return"LI"===t.nodeName||/^(H[1-6])$/.test(t.nodeName)});o||(e.preventDefault(),t.transactionManager.run(function(){"BR"===t.el.lastChild.nodeName&&t.el.removeChild(t.el.lastChild);var e=document.createElement("br");i.insertNode(e),i.collapse(!1);var o=i.cloneRange();o.setEndAfter(t.el.lastChild,0);var s=o.cloneContents();if(!n(s)){var a=document.createElement("br");i.insertNode(a)}var u=i.cloneRange();u.setStartAfter(e,0),u.setEndAfter(e,0),r.selection.removeAllRanges(),r.selection.addRange(u)}))}}.bind(this)),""===t.getHTML().trim()&&t.setContent("")}}},{}],123:[function(t,e){var n=t("./patches/commands/bold"),r=t("./patches/commands/indent"),i=t("./patches/commands/insert-html"),o=t("./patches/commands/insert-list"),s=t("./patches/commands/outdent"),a=t("./patches/commands/create-link"),u=t("./patches/events");e.exports={commands:{bold:n,indent:r,insertHTML:i,insertList:o,outdent:s,createLink:a},events:u}},{"./patches/commands/bold":124,"./patches/commands/create-link":125,"./patches/commands/indent":126,"./patches/commands/insert-html":127,"./patches/commands/insert-list":128,"./patches/commands/outdent":129,"./patches/events":130}],124:[function(t,e){"use strict";e.exports=function(){return function(t){var e=new t.api.CommandPatch("bold");e.queryEnabled=function(){var e=new t.api.Selection,n=e.getContaining(function(t){return/^(H[1-6])$/.test(t.nodeName)});return t.api.CommandPatch.prototype.queryEnabled.apply(this,arguments)&&!n},t.commandPatches.bold=e}}},{}],125:[function(t,e){"use strict";e.exports=function(){return function(t){var e=new t.api.CommandPatch("createLink");t.commandPatches.createLink=e,e.execute=function(e){var n=new t.api.Selection;if(n.range.collapsed){var r=document.createElement("a");r.setAttribute("href",e),r.textContent=e,n.range.insertNode(r);var i=document.createRange();i.setStartBefore(r),i.setEndAfter(r),n.selection.removeAllRanges(),n.selection.addRange(i)}else t.api.CommandPatch.prototype.execute.call(this,e)}}}},{}],126:[function(t,e){"use strict";var n="\ufeff";e.exports=function(){return function(t){var e=new t.api.CommandPatch("indent");e.execute=function(e){t.transactionManager.run(function(){var r=new t.api.Selection,i=r.range,o="P"===i.commonAncestorContainer.nodeName&&"<br>"===i.commonAncestorContainer.innerHTML;if(o){var s=document.createTextNode(n);i.insertNode(s),i.setStart(s,0),i.setEnd(s,0),r.selection.removeAllRanges(),r.selection.addRange(i)}t.api.CommandPatch.prototype.execute.call(this,e),r=new t.api.Selection;var a=r.getContaining(function(t){return"BLOCKQUOTE"===t.nodeName});a&&a.removeAttribute("style")}.bind(this))},t.commandPatches.indent=e}}},{}],127:[function(t,e){"use strict";e.exports=function(){return function(t){var e=new t.api.CommandPatch("insertHTML"),n=t.element;e.execute=function(e){t.transactionManager.run(function(){function r(t){var e=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,null,!1),i=e.firstChild();if(i)do"SPAN"===i.nodeName?n.unwrap(t,i):(i.style.lineHeight=null,""===i.getAttribute("style")&&i.removeAttribute("style")),r(i);while(i=e.nextSibling())}t.api.CommandPatch.prototype.execute.call(this,e),r(t.el)}.bind(this))},t.commandPatches.insertHTML=e}}},{}],128:[function(t,e){"use strict";e.exports=function(){return function(t){var e=t.element,n=t.node,r=function(e){t.api.CommandPatch.call(this,e)};r.prototype=Object.create(t.api.CommandPatch.prototype),r.prototype.constructor=r,r.prototype.execute=function(r){t.transactionManager.run(function(){if(t.api.CommandPatch.prototype.execute.call(this,r),this.queryState()){var i=new t.api.Selection,o=i.getContaining(function(t){return"OL"===t.nodeName||"UL"===t.nodeName});if(o.nextElementSibling&&0===o.nextElementSibling.childNodes.length&&n.removeNode(o.nextElementSibling),o){var s=o.parentNode;s&&/^(H[1-6]|P)$/.test(s.nodeName)&&(i.placeMarkers(),n.insertAfter(o,s),i.selectMarkers(),2===s.childNodes.length&&n.isEmptyTextNode(s.firstChild)&&n.removeNode(s),0===s.childNodes.length&&n.removeNode(s))}var a=Array.prototype.slice.call(o.childNodes);a.forEach(function(t){var n=Array.prototype.slice.call(t.childNodes);n.forEach(function(n){if("SPAN"===n.nodeName){var r=n;e.unwrap(t,r)}else n.nodeType===Node.ELEMENT_NODE&&(n.style.lineHeight=null,""===n.getAttribute("style")&&n.removeAttribute("style"))})})}}.bind(this))},t.commandPatches.insertOrderedList=new r("insertOrderedList"),t.commandPatches.insertUnorderedList=new r("insertUnorderedList")}}},{}],129:[function(t,e){"use strict";e.exports=function(){return function(t){var e=new t.api.CommandPatch("outdent");e.execute=function(){t.transactionManager.run(function(){var e=new t.api.Selection,n=e.range,r=e.getContaining(function(t){return"BLOCKQUOTE"===t.nodeName});if("BLOCKQUOTE"===n.commonAncestorContainer.nodeName){e.placeMarkers(),e.selectMarkers(!0);var i=n.cloneContents();r.parentNode.insertBefore(i,r),n.deleteContents(),e.selectMarkers(),""===r.textContent&&r.parentNode.removeChild(r)}else{var o=e.getContaining(function(t){return"P"===t.nodeName});if(o){var s=new t.api.Node(o).nextAll();if(s.length){var a=document.createElement(r.nodeName);s.forEach(function(t){a.appendChild(t)}),r.parentNode.insertBefore(a,r.nextElementSibling)}e.placeMarkers(),r.parentNode.insertBefore(o,r.nextElementSibling),e.selectMarkers(),""===r.innerHTML&&r.parentNode.removeChild(r)}else t.api.CommandPatch.prototype.execute.call(this)}}.bind(this))},t.commandPatches.outdent=e}}},{}],130:[function(t,e){"use strict";e.exports=function(){return function(t){var e=t.element;t.allowsBlockElements()&&t.el.addEventListener("keyup",function(n){if(8===n.keyCode||46===n.keyCode){var r=new t.api.Selection,i=r.getContaining(function(t){return"P"===t.nodeName});i&&(t.undoManager&&t.undoManager.undo(),t.transactionManager.run(function(){r.placeMarkers();var t=Array.prototype.slice.call(i.childNodes);t.forEach(function(t){if("SPAN"===t.nodeName){var n=t;e.unwrap(i,n)}else t.nodeType===Node.ELEMENT_NODE&&(t.style.lineHeight=null,""===t.getAttribute("style")&&t.removeAttribute("style"))}),r.selectMarkers()}))}})}}},{}],131:[function(t,e){"use strict";e.exports=function(){return function(t){""===t.getHTML().trim()&&t.setContent("<p><br></p>")}}},{}],132:[function(t,e){function n(t,e){g.call(this),this.el=t,this.commands={},this.options=o(e||{},{allowBlockElements:!0,debug:!1,undo:{enabled:!0},defaultCommandPatches:["bold","indent","insertHTML","insertList","outdent","createLink"]}),this.commandPatches={},this._plainTextFormatterFactory=new r,this._htmlFormatterFactory=new i,this.api=new m(this),this.node=y,this.element=_,this.Immutable=k;var n=v(this);if(this.transactionManager=new n,this.undoManager=!1,this.options.undo.enabled){var w=b(this);this.undoManager=new w}this.el.setAttribute("contenteditable",!0),this.el.addEventListener("input",function(){this.transactionManager.run()}.bind(this),!1),this.allowsBlockElements()?(this.use(p()),this.use(c()),this.use(l())):this.use(d());var x=k.List.of(f,u),S=k.List.of(h.events),E=k.List(this.options.defaultCommandPatches).map(function(t){return h.commands[t]}),C=k.List.of("indent","insertList","outdent","redo","subscript","superscript","undo").map(function(t){return s[t]}),T=k.List().concat(x,S,E,C);T.forEach(function(t){this.use(t())}.bind(this)),this.use(a())}function r(){this.formatters=k.List()}function i(){this.formatters={sanitize:k.List(),normalize:k.List(),"export":k.List()}}var o=t("lodash-amd/modern/objects/defaults"),s=t("./plugins/core/commands"),a=t("./plugins/core/events"),u=t("./plugins/core/formatters/html/replace-nbsp-chars"),c=t("./plugins/core/formatters/html/enforce-p-elements"),l=t("./plugins/core/formatters/html/ensure-selectable-containers"),f=t("./plugins/core/formatters/plain-text/escape-html-characters"),d=t("./plugins/core/inline-elements-mode"),h=t("./plugins/core/patches"),p=t("./plugins/core/set-root-p-element"),m=t("./api"),v=t("./transaction-manager"),b=t("./undo-manager"),g=t("./event-emitter"),_=t("./element"),y=t("./node"),k=t("immutable/dist/immutable");n.prototype=Object.create(g.prototype),n.prototype.use=function(t){return t(this),this},n.prototype.setHTML=function(t,e){e&&(this._skipFormatters=!0),this.el.innerHTML!==t&&(this.el.innerHTML=t)},n.prototype.getHTML=function(){return this.el.innerHTML},n.prototype.getContent=function(){return this._htmlFormatterFactory.formatForExport(this.getHTML().replace(/<br>$/,""))},n.prototype.getTextContent=function(){return this.el.textContent},n.prototype.pushHistory=function(){if(this.options.undo.enabled){var t=this.undoManager.stack[this.undoManager.position],e=t&&t.replace(/<em class="scribe-marker">/g,"").replace(/<\/em>/g,"");if(!t||t&&this.getHTML()!==e){var n=new this.api.Selection;n.placeMarkers();var r=this.getHTML();return n.removeMarkers(),this.undoManager.push(r),!0}return!1}return!1},n.prototype.getCommand=function(t){return this.commands[t]||this.commandPatches[t]||new this.api.Command(t)},n.prototype.restoreFromHistory=function(t){this.setHTML(t,!0);var e=new this.api.Selection;e.selectMarkers(),this.trigger("content-changed")},n.prototype.allowsBlockElements=function(){return this.options.allowBlockElements},n.prototype.setContent=function(t){this.allowsBlockElements()||(t+="<br>"),this.setHTML(t),this.trigger("content-changed")},n.prototype.insertPlainText=function(t){this.insertHTML("<p>"+this._plainTextFormatterFactory.format(t)+"</p>")},n.prototype.insertHTML=function(t){this.getCommand("insertHTML").execute(this._htmlFormatterFactory.format(t))},n.prototype.isDebugModeEnabled=function(){return this.options.debug},n.prototype.registerHTMLFormatter=function(t,e){this._htmlFormatterFactory.formatters[t]=this._htmlFormatterFactory.formatters[t].push(e)},n.prototype.registerPlainTextFormatter=function(t){this._plainTextFormatterFactory.formatters=this._plainTextFormatterFactory.formatters.push(t)},r.prototype.format=function(t){var e=this.formatters.reduce(function(t,e){return e(t)},t);return e},i.prototype=Object.create(r.prototype),i.prototype.constructor=i,i.prototype.format=function(t){var e=this.formatters.sanitize.concat(this.formatters.normalize),n=e.reduce(function(t,e){return e(t)},t);return n},i.prototype.formatForExport=function(t){return this.formatters["export"].reduce(function(t,e){return e(t)},t)},e.exports=n},{"./api":99,"./element":106,"./event-emitter":107,"./node":108,"./plugins/core/commands":109,"./plugins/core/events":117,"./plugins/core/formatters/html/enforce-p-elements":118,"./plugins/core/formatters/html/ensure-selectable-containers":119,"./plugins/core/formatters/html/replace-nbsp-chars":120,"./plugins/core/formatters/plain-text/escape-html-characters":121,"./plugins/core/inline-elements-mode":122,"./plugins/core/patches":123,"./plugins/core/set-root-p-element":131,"./transaction-manager":133,"./undo-manager":134,"immutable/dist/immutable":54,"lodash-amd/modern/objects/defaults":84}],133:[function(t,e){var n=t("lodash-amd/modern/objects/assign");e.exports=function(t){function e(){this.history=[]}return n(e.prototype,{start:function(){this.history.push(1)},end:function(){this.history.pop(),0===this.history.length&&(t.pushHistory(),t.trigger("content-changed"))},run:function(t){this.start();try{t&&t()}finally{this.end()}}}),e}},{"lodash-amd/modern/objects/assign":83}],134:[function(t,e){"use strict";e.exports=function(t){function e(){this.position=-1,this.stack=[],this.debug=t.isDebugModeEnabled()}return e.prototype.maxStackSize=100,e.prototype.push=function(t){for(this.debug&&console.log("UndoManager.push: %s",t),this.stack.length=++this.position,this.stack.push(t);this.stack.length>this.maxStackSize;)this.stack.shift(),--this.position},e.prototype.undo=function(){return this.position>0?this.stack[--this.position]:void 0},e.prototype.redo=function(){return this.position<this.stack.length-1?this.stack[++this.position]:void 0},e}},{}],135:[function(t,e){"use strict";e.exports=function(){return function(t){t.registerPlainTextFormatter(function(t){return t.replace(/\n([ \t]*\n)+/g,"</p><p>").replace(/\n/g,"<br>")})}}},{}],136:[function(t,e){"use strict";e.exports=function(){return function(t){var e=new t.api.Command("createLink");e.nodeName="A",e.execute=function(){var e=new t.api.Selection,n=e.range,r=e.getContaining(function(t){return t.nodeName===this.nodeName}.bind(this)),i=r?r.href:"http://",o=window.prompt("Enter a link.",i);if(r&&(n.selectNode(r),e.selection.removeAllRanges(),e.selection.addRange(n)),o){var s=/^https?\:\/\//;if(!s.test(o))if(!/^mailto\:/.test(o)&&/@/.test(o)){var a=window.confirm("The URL you entered appears to be an email address. Do you want to add the required “mailto:” prefix?");a&&(o="mailto:"+o)}else{var u=window.confirm("The URL you entered appears to be a link. Do you want to add the required “http://” prefix?");u&&(o="http://"+o)}t.api.SimpleCommand.prototype.execute.call(this,o)}},e.queryState=function(){var e=new t.api.Selection;return!!e.getContaining(function(t){return t.nodeName===this.nodeName}.bind(this))},t.commands.linkPrompt=e}}},{}],137:[function(e,n,r){!function(e,i){"object"==typeof r?n.exports=i():"function"==typeof t&&t.amd?t(i):e.Spinner=i()}(this,function(){"use strict";function t(t,e){var n,r=document.createElement(t||"div");for(n in e)r[n]=e[n];return r}function e(t){for(var e=1,n=arguments.length;n>e;e++)t.appendChild(arguments[e]);return t}function n(t,e,n,r){var i=["opacity",e,~~(100*t),n,r].join("-"),o=.01+n/r*100,s=Math.max(1-(1-t)/e*(100-o),t),a=c.substring(0,c.indexOf("Animation")).toLowerCase(),u=a&&"-"+a+"-"||"";return f[i]||(d.insertRule("@"+u+"keyframes "+i+"{0%{opacity:"+s+"}"+o+"%{opacity:"+t+"}"+(o+.01)+"%{opacity:1}"+(o+e)%100+"%{opacity:"+t+"}100%{opacity:"+s+"}}",d.cssRules.length),f[i]=1),i}function r(t,e){var n,r,i=t.style;for(e=e.charAt(0).toUpperCase()+e.slice(1),r=0;r<l.length;r++)if(n=l[r]+e,void 0!==i[n])return n;return void 0!==i[e]?e:void 0}function i(t,e){for(var n in e)t.style[r(t,n)||n]=e[n];return t}function o(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)void 0===t[r]&&(t[r]=n[r])}return t}function s(t,e){return"string"==typeof t?t:t[e%t.length]}function a(t){this.opts=o(t||{},a.defaults,h)}function u(){function n(e,n){return t("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',n)}d.addRule(".spin-vml","behavior:url(#default#VML)"),a.prototype.lines=function(t,r){function o(){return i(n("group",{coordsize:l+" "+l,coordorigin:-c+" "+-c}),{width:l,height:l})}function a(t,a,u){e(d,e(i(o(),{rotation:360/r.lines*t+"deg",left:~~a}),e(i(n("roundrect",{arcsize:r.corners}),{width:c,height:r.width,left:r.radius,top:-r.width>>1,filter:u}),n("fill",{color:s(r.color,t),opacity:r.opacity}),n("stroke",{opacity:0}))))}var u,c=r.length+r.width,l=2*c,f=2*-(r.width+r.length)+"px",d=i(o(),{position:"absolute",top:f,left:f});if(r.shadow)for(u=1;u<=r.lines;u++)a(u,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(u=1;u<=r.lines;u++)a(u);return e(t,d)},a.prototype.opacity=function(t,e,n,r){var i=t.firstChild;r=r.shadow&&r.lines||0,i&&e+r<i.childNodes.length&&(i=i.childNodes[e+r],i=i&&i.firstChild,i=i&&i.firstChild,i&&(i.opacity=n))}}var c,l=["webkit","Moz","ms","O"],f={},d=function(){var n=t("style",{type:"text/css"});return e(document.getElementsByTagName("head")[0],n),n.sheet||n.styleSheet}(),h={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",position:"absolute"};a.defaults={},o(a.prototype,{spin:function(e){this.stop();var n=this,r=n.opts,o=n.el=i(t(0,{className:r.className}),{position:r.position,width:0,zIndex:r.zIndex});if(i(o,{left:r.left,top:r.top}),e&&e.insertBefore(o,e.firstChild||null),o.setAttribute("role","progressbar"),n.lines(o,n.opts),!c){var s,a=0,u=(r.lines-1)*(1-r.direction)/2,l=r.fps,f=l/r.speed,d=(1-r.opacity)/(f*r.trail/100),h=f/r.lines;!function p(){a++;for(var t=0;t<r.lines;t++)s=Math.max(1-(a+(r.lines-t)*h)%f*d,r.opacity),n.opacity(o,t*r.direction+u,s,r);n.timeout=n.el&&setTimeout(p,~~(1e3/l))}()}return n},stop:function(){var t=this.el;return t&&(clearTimeout(this.timeout),t.parentNode&&t.parentNode.removeChild(t),this.el=void 0),this},lines:function(r,o){function a(e,n){return i(t(),{position:"absolute",width:o.length+o.width+"px",height:o.width+"px",background:e,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/o.lines*l+o.rotate)+"deg) translate("+o.radius+"px,0)",borderRadius:(o.corners*o.width>>1)+"px"})}for(var u,l=0,f=(o.lines-1)*(1-o.direction)/2;l<o.lines;l++)u=i(t(),{position:"absolute",top:1+~(o.width/2)+"px",transform:o.hwaccel?"translate3d(0,0,0)":"",opacity:o.opacity,animation:c&&n(o.opacity,o.trail,f+l*o.direction,o.lines)+" "+1/o.speed+"s linear infinite"}),o.shadow&&e(u,i(a("#000","0 0 4px #000"),{top:"2px"})),e(r,e(u,a(s(o.color,l),"0 0 1px rgba(0,0,0,.1)")));return r},opacity:function(t,e,n){e<t.childNodes.length&&(t.childNodes[e].style.opacity=n)}});var p=i(t("group"),{behavior:"url(#default#VML)"});return!r(p,"transform")&&p.adj?u():c=r(p,"animation"),a})},{}],138:[function(t,e){"use strict";var n=t("./lodash"),r=t("./blocks"),i=function(t){this.type=t,this.block_type=r[this.type].prototype,this.can_be_rendered=this.block_type.toolbarEnabled,this._ensureElement()};Object.assign(i.prototype,t("./function-bind"),t("./renderable"),t("./events"),{tagName:"a",className:"st-block-control",attributes:function(){return{"data-type":this.block_type.type}},render:function(){return this.$el.html('<span class="st-icon">'+n.result(this.block_type,"icon_name")+"</span>"+n.result(this.block_type,"title")),this}}),e.exports=i},{"./blocks":156,"./events":166,"./function-bind":173,"./lodash":178,"./renderable":180}],139:[function(t,e){(function(n){"use strict";var r=t("./lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,o=t("./blocks"),s=t("./block-control"),a=t("./event-bus"),u=function(t,e){this.available_types=t||[],this.mediator=e,this._ensureElement(),this._bindFunctions(),this._bindMediatedEvents(),this.initialize()};Object.assign(u.prototype,t("./function-bind"),t("./mediated-events"),t("./renderable"),t("./events"),{bound:["handleControlButtonClick"],block_controls:null,className:"st-block-controls",eventNamespace:"block-controls",mediatedEvents:{render:"renderInContainer",show:"show",hide:"hide"},initialize:function(){for(var t in this.available_types)if(o.hasOwnProperty(t)){var e=new s(t);e.can_be_rendered&&this.$el.append(e.render().$el)}this.$el.delegate(".st-block-control","click",this.handleControlButtonClick),this.mediator.on("block-controls:show",this.renderInContainer)},show:function(){this.$el.addClass("st-block-controls--active"),a.trigger("block:controls:shown")},hide:function(){this.removeCurrentContainer(),this.$el.removeClass("st-block-controls--active"),a.trigger("block:controls:hidden")},handleControlButtonClick:function(t){t.stopPropagation(),this.mediator.trigger("block:create",i(t.currentTarget).attr("data-type"))},renderInContainer:function(t){this.removeCurrentContainer(),t.append(this.$el.detach()),t.addClass("with-st-controls"),this.currentContainer=t,this.show()},removeCurrentContainer:function(){r.isUndefined(this.currentContainer)||(this.currentContainer.removeClass("with-st-controls"),this.currentContainer=void 0)}}),e.exports=u}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./block-control":138,"./blocks":156,"./event-bus":165,"./events":166,"./function-bind":173,"./lodash":178,"./mediated-events":179,"./renderable":180}],140:[function(t,e){"use strict";var n=function(){this._ensureElement(),this._bindFunctions()};Object.assign(n.prototype,t("./function-bind"),t("./renderable"),{tagName:"a",className:"st-block-ui-btn st-block-ui-btn--delete st-icon",attributes:{html:"delete","data-icon":"bin"}}),e.exports=n},{"./function-bind":173,"./renderable":180}],141:[function(t,e){"use strict";var n=t("./lodash"),r=t("./utils"),i=t("./config"),o=t("./event-bus"),s=t("./blocks"),a=["convertToMarkdown","convertFromMarkdown","formatBar"],u=function(t,e,n){this.options=t,this.blockOptions=a.reduce(function(e,n){return e[n]=t[n],e},{}),this.instance_scope=e,this.mediator=n,this.blocks=[],this.blockCounts={},this.blockTypes={},this._setBlocksTypes(),this._setRequired(),this._bindMediatedEvents(),this.initialize()};Object.assign(u.prototype,t("./function-bind"),t("./mediated-events"),t("./events"),{eventNamespace:"block",mediatedEvents:{create:"createBlock",remove:"removeBlock",rerender:"rerenderBlock"},initialize:function(){},createBlock:function(t,e){if(t=r.classify(t),this.canCreateBlock(t)){var n=new s[t](e,this.instance_scope,this.mediator,this.blockOptions);this.blocks.push(n),this._incrementBlockTypeCount(t),this.mediator.trigger("block:render",n),this.triggerBlockCountUpdate(),this.mediator.trigger("block:limitReached",this.blockLimitReached()),o.trigger(e?"block:create:existing":"block:create:new",n),r.log("Block created of type "+t)}},removeBlock:function(t){var e=this.findBlockById(t),n=r.classify(e.type);this.mediator.trigger("block-controls:reset"),this.blocks=this.blocks.filter(function(t){return t.blockID!==e.blockID}),this._decrementBlockTypeCount(n),this.triggerBlockCountUpdate(),this.mediator.trigger("block:limitReached",this.blockLimitReached()),o.trigger("block:remove")},rerenderBlock:function(t){var e=this.findBlockById(t);n.isUndefined(e)||e.isEmpty()||!e.drop_options.re_render_on_reorder||e.beforeLoadingData()},triggerBlockCountUpdate:function(){this.mediator.trigger("block:countUpdate",this.blocks.length)},canCreateBlock:function(t){return this.blockLimitReached()?(r.log("Cannot add any more blocks. Limit reached."),!1):this.isBlockTypeAvailable(t)?this.canAddBlockType(t)?!0:(r.log("Block Limit reached for type "+t),!1):(r.log("Block type not available "+t),!1)},validateBlockTypesExist:function(t){return i.skipValidation||!t?!1:void(this.required||[]).forEach(function(t){if(this.isBlockTypeAvailable(t))if(0===this._getBlockTypeCount(t))r.log("Failed validation on required block type "+t),this.mediator.trigger("errors:add",{text:i18n.t("errors:type_missing",{type:t})});else{var e=this.getBlocksByType(t).filter(function(t){return!t.isEmpty()});if(e.length>0)return!1;this.mediator.trigger("errors:add",{text:i18n.t("errors:required_type_empty",{type:t})}),r.log("A required block type "+t+" is empty")}},this)},findBlockById:function(t){return this.blocks.find(function(e){return e.blockID===t})},getBlocksByType:function(t){return this.blocks.filter(function(e){return r.classify(e.type)===t})},getBlocksByIDs:function(t){return this.blocks.filter(function(e){return t.includes(e.blockID)})},blockLimitReached:function(){return 0!==this.options.blockLimit&&this.blocks.length>=this.options.blockLimit},isBlockTypeAvailable:function(t){return!n.isUndefined(this.blockTypes[t])},canAddBlockType:function(t){var e=this._getBlockTypeLimit(t);return!(0!==e&&this._getBlockTypeCount(t)>=e)},_setBlocksTypes:function(){this.blockTypes=r.flatten(n.isUndefined(this.options.blockTypes)?s:this.options.blockTypes)},_setRequired:function(){this.required=!1,Array.isArray(this.options.required)&&!n.isEmpty(this.options.required)&&(this.required=this.options.required)},_incrementBlockTypeCount:function(t){this.blockCounts[t]=n.isUndefined(this.blockCounts[t])?1:this.blockCounts[t]+1},_decrementBlockTypeCount:function(t){this.blockCounts[t]=n.isUndefined(this.blockCounts[t])?1:this.blockCounts[t]-1},_getBlockTypeCount:function(t){return n.isUndefined(this.blockCounts[t])?0:this.blockCounts[t]},_blockLimitReached:function(){return 0!==this.options.blockLimit&&this.blocks.length>=this.options.blockLimit},_getBlockTypeLimit:function(t){return this.isBlockTypeAvailable(t)?parseInt(n.isUndefined(this.options.blockTypeLimits[t])?0:this.options.blockTypeLimits[t],10):0}}),e.exports=u},{"./blocks":156,"./config":162,"./event-bus":165,"./events":166,"./function-bind":173,"./lodash":178,"./mediated-events":179,"./utils":184}],142:[function(t,e){"use strict";var n=["<div class='st-block-positioner__inner'>","<span class='st-block-positioner__selected-value'></span>","<select class='st-block-positioner__select'></select>","</div>"].join("\n"),r=function(t,e){this.mediator=e,this.$block=t,this._ensureElement(),this._bindFunctions(),this.initialize()};Object.assign(r.prototype,t("./function-bind"),t("./renderable"),{total_blocks:0,bound:["onBlockCountChange","onSelectChange","toggle","show","hide"],className:"st-block-positioner",visibleClass:"st-block-positioner--is-visible",initialize:function(){this.$el.append(n),this.$select=this.$(".st-block-positioner__select"),this.$select.on("change",this.onSelectChange),this.mediator.on("block:countUpdate",this.onBlockCountChange)},onBlockCountChange:function(t){t!==this.total_blocks&&(this.total_blocks=t,this.renderPositionList())},onSelectChange:function(){var t=this.$select.val();0!==t&&(this.mediator.trigger("block:changePosition",this.$block,t,1===t?"before":"after"),this.toggle())},renderPositionList:function(){for(var t="<option value='0'>"+i18n.t("general:position")+"</option>",e=1;e<=this.total_blocks;e++)t+="<option value="+e+">"+e+"</option>";this.$select.html(t)},toggle:function(){this.$select.val(0),this.$el.toggleClass(this.visibleClass)},show:function(){this.$el.addClass(this.visibleClass)},hide:function(){this.$el.removeClass(this.visibleClass)}}),e.exports=r},{"./function-bind":173,"./renderable":180}],143:[function(t,e){(function(n){"use strict";var r=t("./lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,o=t("./event-bus"),s=function(t,e){this.$block=t,this.blockID=this.$block.attr("id"),this.mediator=e,this._ensureElement(),this._bindFunctions(),this.initialize()};Object.assign(s.prototype,t("./function-bind"),t("./renderable"),{bound:["onMouseDown","onDragStart","onDragEnd","onDrop"],className:"st-block-ui-btn st-block-ui-btn--reorder st-icon",tagName:"a",attributes:function(){return{html:"reorder",draggable:"true","data-icon":"move"}},initialize:function(){this.$el.bind("mousedown touchstart",this.onMouseDown).bind("dragstart",this.onDragStart).bind("dragend touchend",this.onDragEnd),
this.$block.dropArea().bind("drop",this.onDrop)},blockId:function(){return this.$block.attr("id")},onMouseDown:function(){this.mediator.trigger("block-controls:hide"),o.trigger("block:reorder:down")},onDrop:function(t){t.preventDefault();var e=this.$block,n=t.originalEvent.dataTransfer.getData("text/plain"),s=i("#"+n);r.isUndefined(n)||r.isEmpty(s)||e.attr("id")===n||e.attr("data-instance")!==s.attr("data-instance")||e.after(s),this.mediator.trigger("block:rerender",n),o.trigger("block:reorder:dropped",n)},onDragStart:function(t){var e=i(t.currentTarget).parent();t.originalEvent.dataTransfer.setDragImage(this.$block[0],e.position().left,e.position().top),t.originalEvent.dataTransfer.setData("Text",this.blockId()),o.trigger("block:reorder:dragstart"),this.$block.addClass("st-block--dragging")},onDragEnd:function(){o.trigger("block:reorder:dragend"),this.$block.removeClass("st-block--dragging")},render:function(){return this}}),e.exports=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./event-bus":165,"./function-bind":173,"./lodash":178,"./renderable":180}],144:[function(t,e){"use strict";var n=t("./lodash"),r=t("./utils"),i=t("./event-bus");e.exports={blockStorage:{},createStore:function(t){this.blockStorage={type:r.underscored(this.type),data:t||{}}},save:function(){var t=this._serializeData();n.isEmpty(t)||this.setData(t)},getData:function(){return this.save(),this.blockStorage},getBlockData:function(){return this.save(),this.blockStorage.data},_getData:function(){return this.blockStorage.data},setData:function(t){r.log("Setting data for block "+this.blockID),Object.assign(this.blockStorage.data,t||{})},setAndLoadData:function(t){this.setData(t),this.beforeLoadingData()},_serializeData:function(){},loadData:function(){},beforeLoadingData:function(){r.log("loadData for "+this.blockID),i.trigger("editor/block/loadData"),this.loadData(this._getData())},_loadData:function(){r.log("_loadData is deprecated and will be removed in the future. Please use beforeLoadingData instead."),this.beforeLoadingData()},checkAndLoadData:function(){n.isEmpty(this._getData())||this.beforeLoadingData()}}},{"./event-bus":165,"./lodash":178,"./utils":184}],145:[function(t,e){(function(n){"use strict";var r=t("./lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,o=t("./utils"),s=function(t){var e=t.attr("data-st-name")||t.attr("name");return e||(e="Field"),o.capitalize(e)};e.exports={errors:[],valid:function(){return this.performValidations(),0===this.errors.length},performValidations:function(){this.resetErrors();var t=this.$(".st-required");t.each(function(t,e){this.validateField(e)}.bind(this)),this.validations.forEach(this.runValidator,this),this.$el.toggleClass("st-block--with-errors",this.errors.length>0)},validations:[],validateField:function(t){t=i(t);var e=t.attr("contenteditable")?t.text():t.val();0===e.length&&this.setError(t,i18n.t("errors:block_empty",{name:s(t)}))},runValidator:function(t){r.isUndefined(this[t])||this[t].call(this)},setError:function(t,e){var n=this.addMessage(e,"st-msg--error");t.addClass("st-error"),this.errors.push({field:t,reason:e,msg:n})},resetErrors:function(){this.errors.forEach(function(t){t.field.removeClass("st-error"),t.msg.remove()}),this.$messages.removeClass("st-block__messages--is-visible"),this.errors=[]}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lodash":178,"./utils":184}],146:[function(t,e){(function(n){"use strict";var r=t("./lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,o=t("scribe-editor"),s=t("scribe-plugin-formatter-plain-text-convert-new-lines-to-html"),a=t("scribe-plugin-link-prompt-command"),u=t("./config"),c=t("./utils"),l=t("./block_mixins"),f=t("./simple-block"),d=t("./block-reorder"),h=t("./block-deletion"),p=t("./block-positioner"),m=t("./event-bus"),v=t("spin.js"),b=function(){f.apply(this,arguments)};b.prototype=Object.create(f.prototype),b.prototype.constructor=b;var g=["<div class='st-block__ui-delete-controls'>","<label class='st-block__delete-label'>","<%= i18n.t('general:delete') %>","</label>","<a class='st-block-ui-btn st-block-ui-btn--confirm-delete st-icon' data-icon='tick'></a>","<a class='st-block-ui-btn st-block-ui-btn--deny-delete st-icon' data-icon='close'></a>","</div>"].join("\n");Object.assign(b.prototype,f.fn,t("./block-validations"),{bound:["_handleContentPaste","_onFocus","_onBlur","onDrop","onDeleteClick","clearInsertedStyles","getSelectionForFormatter","onBlockRender"],className:"st-block st-icon--add",attributes:function(){return Object.assign(f.fn.attributes.call(this),{"data-icon-after":"add"})},icon_name:"default",validationFailMsg:function(){return i18n.t("errors:validation_fail",{type:this.title()})},editorHTML:'<div class="st-block__editor"></div>',toolbarEnabled:!0,availableMixins:["droppable","pastable","uploadable","fetchable","ajaxable","controllable"],droppable:!1,pastable:!1,uploadable:!1,fetchable:!1,ajaxable:!1,drop_options:{},paste_options:{},upload_options:{},formattable:!0,_previousSelection:"",initialize:function(){},toMarkdown:function(t){return t},toHTML:function(t){return t},withMixin:function(t){if(r.isObject(t)){var e="initialize"+t.mixinName;r.isUndefined(this[e])&&(Object.assign(this,t),this[e]())}},render:function(){if(this.beforeBlockRender(),this._setBlockInner(),this.$editor=this.$inner.children().first(),this.mixinsRequireInputs=!1,this.availableMixins.forEach(function(t){if(this[t]){var e=l[c.classify(t)];!r.isUndefined(e.requireInputs)&&e.requireInputs&&(this.mixinsRequireInputs=!0)}},this),this.mixinsRequireInputs){var t=i("<div>",{"class":"st-block__inputs"});this.$inner.append(t),this.$inputs=t}return this.hasTextBlock()&&this._initTextBlocks(),this.availableMixins.forEach(function(t){this[t]&&this.withMixin(l[c.classify(t)])},this),this.formattable&&this._initFormatting(),this._blockPrepare(),this},remove:function(){this.ajaxable&&this.resolveAllInQueue(),this.$el.remove()},loading:function(){r.isUndefined(this.spinner)||this.ready(),this.spinner=new v(u.defaults.spinner),this.spinner.spin(this.$el[0]),this.$el.addClass("st--is-loading")},ready:function(){this.$el.removeClass("st--is-loading"),r.isUndefined(this.spinner)||(this.spinner.stop(),delete this.spinner)},_serializeData:function(){c.log("toData for "+this.blockID);var t={};return this.hasTextBlock()&&(t.text=this.getTextBlockHTML(),t.isHtml=!0),this.$(":input").not(".st-paste-block").length>0&&this.$(":input").each(function(e,n){n.getAttribute("name")&&(t[n.getAttribute("name")]=n.value)}),t},focus:function(){this.getTextBlock().focus()},blur:function(){this.getTextBlock().blur()},onFocus:function(){this.getTextBlock().bind("focus",this._onFocus)},onBlur:function(){this.getTextBlock().bind("blur",this._onBlur)},_onFocus:function(){this.trigger("blockFocus",this.$el)},_onBlur:function(){},onBlockRender:function(){this.focus()},onDrop:function(){},onDeleteClick:function(t){t.preventDefault();var e=function(t){t.preventDefault(),this.mediator.trigger("block:remove",this.blockID),this.remove()},n=function(t){t.preventDefault(),this.$el.removeClass("st-block--delete-active"),i.remove()};if(this.isEmpty())return void e.call(this,new Event("click"));this.$inner.append(r.template(g)),this.$el.addClass("st-block--delete-active");var i=this.$inner.find(".st-block__ui-delete-controls");this.$inner.on("click",".st-block-ui-btn--confirm-delete",e.bind(this)).on("click",".st-block-ui-btn--deny-delete",n.bind(this))},beforeLoadingData:function(){this.loading(),this.mixinsRequireInputs&&(this.$editor.show(),this.$inputs.hide()),f.fn.beforeLoadingData.call(this),this.ready()},execTextBlockCommand:function(t){if(r.isUndefined(this._scribe))throw"No Scribe instance found to send a command to";var e=this._scribe.getCommand(t);this._scribe.el.focus(),e.execute()},queryTextBlockCommandState:function(t){if(r.isUndefined(this._scribe))throw"No Scribe instance found to query command";var e=this._scribe.getCommand(t),n=new this._scribe.api.Selection;return n.range&&e.queryState()},_handleContentPaste:function(t){setTimeout(this.onContentPasted.bind(this,t,i(t.currentTarget)),0)},_getBlockClass:function(){return"st-block--"+this.className},_initUIComponents:function(){var t=new p(this.$el,this.mediator);this._withUIComponent(t,".st-block-ui-btn--reorder",t.toggle),this._withUIComponent(new d(this.$el,this.mediator)),this._withUIComponent(new h,".st-block-ui-btn--delete",this.onDeleteClick),this.onFocus(),this.onBlur()},_initFormatting:function(){var t=this;this.options.formatBar&&this.options.formatBar.commands.forEach(function(e){if(!r.isUndefined(e.keyCode)){var n=!1;t.$el.on("keyup",".st-text-block",function(t){(17===t.which||224===t.which||91===t.which)&&(n=!1)}).on("keydown",".st-text-block",{formatter:e},function(e){(17===e.which||224===e.which||91===e.which)&&(n=!0),e.which===e.data.formatter.keyCode&&n&&(e.preventDefault(),t.execTextBlockCommand(e.data.formatter.cmd))})}})},_initTextBlocks:function(){this.getTextBlock().bind("keyup",this.getSelectionForFormatter).bind("mouseup",this.getSelectionForFormatter).bind("DOMNodeInserted",this.clearInsertedStyles);var t=this.getTextBlock().get(0);if(!r.isUndefined(t)&&r.isUndefined(this._scribe)){var e={debug:u.scribeDebug};r.isObject(this.scribeOptions)&&(e=Object.assign(e,this.scribeOptions)),this._scribe=new o(t,e),this._scribe.use(s()),this._scribe.use(a()),r.isFunction(this.configureScribe)&&this.configureScribe.call(this,this._scribe)}},getSelectionForFormatter:function(){var t=this;setTimeout(function(){var e=window.getSelection(),n=e.toString().trim(),r="formatter:"+(""===n?"hide":"position");t.mediator.trigger(r,t),m.trigger(r,t)},1)},clearInsertedStyles:function(t){var e=t.target;e.removeAttribute("style")},hasTextBlock:function(){return this.getTextBlock().length>0},getTextBlock:function(){return r.isUndefined(this.text_block)&&(this.text_block=this.$(".st-text-block")),this.text_block},getTextBlockHTML:function(){return this._scribe.getContent()},setTextBlockHTML:function(t){return this._scribe.setContent(t)},isEmpty:function(){return r.isEmpty(this.getBlockData())}}),b.extend=t("./helpers/extend"),e.exports=b}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./block-deletion":140,"./block-positioner":142,"./block-reorder":143,"./block-validations":145,"./block_mixins":151,"./config":162,"./event-bus":165,"./helpers/extend":175,"./lodash":178,"./simple-block":181,"./utils":184,"scribe-editor":132,"scribe-plugin-formatter-plain-text-convert-new-lines-to-html":135,"scribe-plugin-link-prompt-command":136,"spin.js":137}],147:[function(t,e){"use strict";var n=t("../utils");e.exports={mixinName:"Ajaxable",ajaxable:!0,initializeAjaxable:function(){this._queued=[]},addQueuedItem:function(t,e){n.log("Adding queued item for "+this.blockID+" called "+t),this._queued.push({name:t,deferred:e})},removeQueuedItem:function(t){n.log("Removing queued item for "+this.blockID+" called "+t),this._queued=this._queued.filter(function(e){return e.name!==t})},hasItemsInQueue:function(){return this._queued.length>0},resolveAllInQueue:function(){this._queued.forEach(function(t){n.log("Aborting queued request: "+t.name),t.deferred.abort()},this)}}},{"../utils":184}],148:[function(t,e){(function(n){"use strict";var r="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,i=t("../utils");e.exports={mixinName:"Controllable",initializeControllable:function(){i.log("Adding controllable to block "+this.blockID),this.$control_ui=r("<div>",{"class":"st-block__control-ui"}),Object.keys(this.controls).forEach(function(t){this.addUiControl(t,this.controls[t].bind(this))},this),this.$inner.append(this.$control_ui)},getControlTemplate:function(t){return r("<a>",{"data-icon":t,"class":"st-icon st-block-control-ui-btn st-block-control-ui-btn--"+t})},addUiControl:function(t,e){this.$control_ui.append(this.getControlTemplate(t)),this.$control_ui.on("click",".st-block-control-ui-btn--"+t,e)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../utils":184}],149:[function(t,e){(function(n){"use strict";var r=t("../lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,o=t("../config"),s=t("../utils"),a=t("../event-bus");e.exports={mixinName:"Droppable",valid_drop_file_types:["File","Files","text/plain","text/uri-list"],requireInputs:!0,initializeDroppable:function(){s.log("Adding droppable to block "+this.blockID),this.drop_options=Object.assign({},o.defaults.Block.drop_options,this.drop_options);var t=i(r.template(this.drop_options.html,{block:this,_:r}));this.$editor.hide(),this.$inputs.append(t),this.$dropzone=t,this.$dropzone.dropArea().bind("drop",this._handleDrop.bind(this)),this.$inner.addClass("st-block__inner--droppable")},_handleDrop:function(t){t.preventDefault(),t=t.originalEvent;var e=i(t.target),n=t.dataTransfer.types;e.removeClass("st-dropzone--dragover"),n&&n.some(function(t){return this.valid_drop_file_types.includes(t)},this)&&this.onDrop(t.dataTransfer),a.trigger("block:content:dropped",this.blockID)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../config":162,"../event-bus":165,"../lodash":178,"../utils":184}],150:[function(t,e){(function(n){"use strict";var r=t("../lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null;e.exports={mixinName:"Fetchable",initializeFetchable:function(){this.withMixin(t("./ajaxable"))},fetch:function(t,e,n){var o=r.uniqueId(this.blockID+"_fetch"),s=i.ajax(t);return this.resetMessages(),this.addQueuedItem(o,s),r.isUndefined(e)||s.done(e.bind(this)),r.isUndefined(n)||s.fail(n.bind(this)),s.always(this.removeQueuedItem.bind(this,o)),s}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../lodash":178,"./ajaxable":147}],151:[function(t,e){"use strict";e.exports={Ajaxable:t("./ajaxable.js"),Controllable:t("./controllable.js"),Droppable:t("./droppable.js"),Fetchable:t("./fetchable.js"),Pastable:t("./pastable.js"),Uploadable:t("./uploadable.js")}},{"./ajaxable.js":147,"./controllable.js":148,"./droppable.js":149,"./fetchable.js":150,"./pastable.js":152,"./uploadable.js":153}],152:[function(t,e){(function(n){"use strict";var r=t("../lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,o=t("../config"),s=t("../utils");e.exports={mixinName:"Pastable",requireInputs:!0,initializePastable:function(){s.log("Adding pastable to block "+this.blockID),this.paste_options=Object.assign({},o.defaults.Block.paste_options,this.paste_options),this.$inputs.append(r.template(this.paste_options.html,this)),this.$(".st-paste-block").bind("click",function(){i(this).select()}).bind("paste",this._handleContentPaste).bind("submit",this._handleContentPaste)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../config":162,"../lodash":178,"../utils":184}],153:[function(t,e){"use strict";var n=t("../lodash"),r=t("../config"),i=t("../utils"),o=t("../extensions/file-uploader");e.exports={mixinName:"Uploadable",uploadsCount:0,requireInputs:!0,initializeUploadable:function(){i.log("Adding uploadable to block "+this.blockID),this.withMixin(t("./ajaxable")),this.upload_options=Object.assign({},r.defaults.Block.upload_options,this.upload_options),this.$inputs.append(n.template(this.upload_options.html,this))},uploader:function(t,e,n){return o(this,t,e,n)}}},{"../config":162,"../extensions/file-uploader":168,"../lodash":178,"../utils":184,"./ajaxable":147}],154:[function(t,e){"use strict";var n=t("../block"),r=t("../to-html");e.exports=n.extend({type:"Heading",title:function(){return i18n.t("blocks:heading:title")},editorHTML:'<div class="st-required st-text-block st-text-block--heading" contenteditable="true"></div>',scribeOptions:{allowBlockElements:!1},icon_name:"heading",loadData:function(t){this.setTextBlockHTML(this.options.convertFromMarkdown&&!t.isHtml?r(t.text,this.type):t.text)}})},{"../block":146,"../to-html":182}],155:[function(t,e){(function(n){"use strict";var r="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,i=t("../block");e.exports=i.extend({type:"image",title:function(){return i18n.t("blocks:image:title")},droppable:!0,uploadable:!0,icon_name:"image",loadData:function(t){this.$editor.html(r("<img>",{src:t.file.url}))},onBlockRender:function(){this.$inputs.find("button").bind("click",function(t){t.preventDefault()}),this.$inputs.find("input").on("change",function(t){this.onDrop(t.currentTarget)}.bind(this))},onDrop:function(t){var e=t.files[0],n="undefined"!=typeof URL?URL:"undefined"!=typeof webkitURL?webkitURL:null;/image/.test(e.type)&&(this.loading(),this.$inputs.hide(),this.$editor.html(r("<img>",{src:n.createObjectURL(e)})).show(),this.uploader(e,function(t){this.setData(t),this.ready()},function(){this.addMessage(i18n.t("blocks:image:upload_error")),this.ready()}))}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../block":146}],156:[function(t,e){"use strict";e.exports={Text:t("./text"),Quote:t("./quote"),Image:t("./image"),Heading:t("./heading"),List:t("./list"),Tweet:t("./tweet"),Video:t("./video")}},{"./heading":154,"./image":155,"./list":157,"./quote":158,"./text":159,"./tweet":160,"./video":161}],157:[function(t,e){"use strict";var n=t("../lodash"),r=t("../block"),i=t("../to-html"),o='<div class="st-text-block st-required" contenteditable="true"><ul><li></li></ul></div>';e.exports=r.extend({type:"list",title:function(){return i18n.t("blocks:list:title")},icon_name:"list",editorHTML:function(){return n.template(o,this)},loadData:function(t){this.setTextBlockHTML(this.options.convertFromMarkdown&&!t.isHtml?"<ul>"+i(t.text,this.type)+"</ul>":t.text)},onBlockRender:function(){this.checkForList=this.checkForList.bind(this),this.getTextBlock().on("click keyup",this.checkForList),this.focus()},checkForList:function(){0===this.$("ul").length&&document.execCommand("insertUnorderedList",!1,!1)},toHTML:function(t){return t=t.replace(/^ - (.+)$/gm,"<li>$1</li>").replace(/\n/gm,"")},onContentPasted:function(t,e){this.$("ul").html(this.pastedMarkdownToHTML(e[0].innerHTML)),this.getTextBlock().caretToEnd()},isEmpty:function(){return n.isEmpty(this.getBlockData().text)}})},{"../block":146,"../lodash":178,"../to-html":182}],158:[function(t,e){"use strict";var n=t("../lodash"),r=t("../block"),i=t("../to-html"),o=n.template(['<blockquote class="st-required st-text-block" contenteditable="true"></blockquote>','<label class="st-input-label"> <%= i18n.t("blocks:quote:credit_field") %></label>','<input maxlength="140" name="cite" placeholder="<%= i18n.t("blocks:quote:credit_field") %>"',' class="st-input-string st-required js-cite-input" type="text" />'].join("\n"));e.exports=r.extend({type:"quote",title:function(){return i18n.t("blocks:quote:title")},icon_name:"quote",editorHTML:function(){return o(this)},loadData:function(t){this.setTextBlockHTML(this.options.convertFromMarkdown&&!t.isHtml?i(t.text,this.type):t.text),this.$(".js-cite-input").val(t.cite)}})},{"../block":146,"../lodash":178,"../to-html":182}],159:[function(t,e){"use strict";var n=t("../block"),r=t("../to-html");e.exports=n.extend({type:"text",title:function(){return i18n.t("blocks:text:title")},editorHTML:'<div class="st-required st-text-block" contenteditable="true"></div>',icon_name:"text",loadData:function(t){this.setTextBlockHTML(this.options.convertFromMarkdown&&!t.isHtml?r(t.text,this.type):t.text)}})},{"../block":146,"../to-html":182}],160:[function(t,e){(function(n){"use strict";var r=t("../lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,o=t("../utils"),s=t("../block"),a=r.template(["<blockquote class='twitter-tweet' align='center'>","<p><%= text %></p>","&mdash; <%= user.name %> (@<%= user.screen_name %>)","<a href='<%= status_url %>' data-datetime='<%= created_at %>'><%= created_at %></a>","</blockquote>",'<script src="//platform.twitter.com/widgets.js" charset="utf-8"></script>'].join("\n"));e.exports=s.extend({type:"tweet",droppable:!0,pastable:!0,fetchable:!0,drop_options:{re_render_on_reorder:!0},title:function(){return i18n.t("blocks:tweet:title")},fetchUrl:function(t){return"/tweets/?tweet_id="+t},icon_name:"twitter",loadData:function(t){r.isUndefined(t.status_url)&&(t.status_url=""),this.$inner.find("iframe").remove(),this.$inner.prepend(a(t))},onContentPasted:function(t){var e=i(t.target),n=e.val();this.handleTwitterDropPaste(n)},handleTwitterDropPaste:function(t){if(!this.validTweetUrl(t))return void o.log("Invalid Tweet URL");var e=t.match(/[^\/]+$/);if(!r.isEmpty(e)){this.loading(),e=e[0];var n={url:this.fetchUrl(e),dataType:"json"};this.fetch(n,this.onTweetSuccess,this.onTweetFail)}},validTweetUrl:function(t){return o.isURI(t)&&-1!==t.indexOf("twitter")&&-1!==t.indexOf("status")},onTweetSuccess:function(t){var e={user:{profile_image_url:t.user.profile_image_url,profile_image_url_https:t.user.profile_image_url_https,screen_name:t.user.screen_name,name:t.user.name},id:t.id_str,text:t.text,created_at:t.created_at,entities:t.entities,status_url:"https://twitter.com/"+t.user.screen_name+"/status/"+t.id_str};this.setAndLoadData(e),this.ready()},onTweetFail:function(){this.addMessage(i18n.t("blocks:tweet:fetch_error")),this.ready()},onDrop:function(t){var e=t.getData("text/plain");this.handleTwitterDropPaste(e)}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../block":146,"../lodash":178,"../utils":184}],161:[function(t,e){"use strict";var n=t("../lodash"),r=t("../utils"),i=t("../block");e.exports=i.extend({providers:{vimeo:{regex:/(?:http[s]?:\/\/)?(?:www.)?vimeo.com\/(.+)/,html:'<iframe src="<%= protocol %>//player.vimeo.com/video/<%= remote_id %>?title=0&byline=0" width="580" height="320" frameborder="0"></iframe>'},youtube:{regex:/^.*(?:youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,html:'<iframe src="<%= protocol %>//www.youtube.com/embed/<%= remote_id %>" width="580" height="320" frameborder="0" allowfullscreen></iframe>'}},type:"video",title:function(){return i18n.t("blocks:video:title")},droppable:!0,pastable:!0,icon_name:"video",loadData:function(t){if(this.providers.hasOwnProperty(t.source)){var e=this.providers[t.source],r="file:"===window.location.protocol?"http:":window.location.protocol,i=e.square?"with-square-media":"with-sixteen-by-nine-media";this.$editor.addClass("st-block__editor--"+i).html(n.template(e.html,{protocol:r,remote_id:t.remote_id,width:this.$editor.width()}))}},onContentPasted:function(t){this.handleDropPaste(t.target.value)},matchVideoProvider:function(t,e,r){var i=t.regex.exec(r);return null==i||n.isUndefined(i[1])?{}:{source:e,remote_id:i[1]}},handleDropPaste:function(t){if(r.isURI(t))for(var e in this.providers)this.providers.hasOwnProperty(e)&&this.setAndLoadData(this.matchVideoProvider(this.providers[e],e,t))},onDrop:function(t){var e=t.getData("text/plain");this.handleDropPaste(e)}})},{"../block":146,"../lodash":178,"../utils":184}],162:[function(t,e){"use strict";var n={html:['<div class="st-block__dropzone">','<span class="st-icon"><%= _.result(block, "icon_name") %></span>','<p><%= i18n.t("general:drop", { block: "<span>" + _.result(block, "title") + "</span>" }) %>',"</p></div>"].join("\n"),re_render_on_reorder:!1},r={html:['<input type="text" placeholder="<%= i18n.t("general:paste") %>"',' class="st-block__paste-input st-paste-block">'].join("")},i={html:['<div class="st-block__upload-container">','<input type="file" type="st-file-upload">','<button class="st-upload-btn"><%= i18n.t("general:upload") %></button>',"</div>"].join("\n")};e.exports={debug:!1,scribeDebug:!1,skipValidation:!1,version:"0.4.0",language:"en",instances:[],defaults:{defaultType:!1,spinner:{className:"st-spinner",lines:9,length:8,width:3,radius:6,color:"#000",speed:1.4,trail:57,shadow:!1,left:"50%",top:"50%"},Block:{drop_options:n,paste_options:r,upload_options:i},blockLimit:0,blockTypeLimits:{},required:[],uploadUrl:"/attachments",baseImageUrl:"/sir-trevor-uploads/",errorsContainer:void 0,convertFromMarkdown:!0,formatBar:{commands:[{name:"Bold",title:"bold",cmd:"bold",keyCode:66,text:"B"},{name:"Italic",title:"italic",cmd:"italic",keyCode:73,text:"i"},{name:"Link",title:"link",iconName:"link",cmd:"linkPrompt",text:"link"},{name:"Unlink",title:"unlink",iconName:"link",cmd:"unlink",text:"link"}]}}}},{}],163:[function(t,e){(function(n){"use strict";var r=t("./lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,o=t("./config"),s=t("./utils"),a=t("./events"),u=t("./event-bus"),c=t("./form-events"),l=t("./block-controls"),f=t("./block-manager"),d=t("./floating-block-controls"),h=t("./format-bar"),p=t("./extensions/editor-store"),m=t("./error-handler"),v=function(t){this.initialize(t)};Object.assign(v.prototype,t("./function-bind"),t("./events"),{bound:["onFormSubmit","hideAllTheThings","changeBlockPosition","removeBlockDragOver","renderBlock","resetBlockControls","blockLimitReached"],events:{"block:reorder:dragend":"removeBlockDragOver","block:reorder:dropped":"removeBlockDragOver","block:content:dropped":"removeBlockDragOver"},initialize:function(t){return s.log("Init SirTrevor.Editor"),this.options=Object.assign({},o.defaults,t||{}),this.ID=r.uniqueId("st-editor-"),this._ensureAndSetElements()?(!r.isUndefined(this.options.onEditorRender)&&r.isFunction(this.options.onEditorRender)&&(this.onEditorRender=this.options.onEditorRender),this.mediator=Object.assign({},a),this._bindFunctions(),o.instances.push(this),this.build(),void c.bindFormSubmit(this.$form)):!1},build:function(){this.$el.hide(),this.errorHandler=new m(this.$outer,this.mediator,this.options.errorsContainer),this.store=new p(this.$el.val(),this.mediator),this.block_manager=new f(this.options,this.ID,this.mediator),this.block_controls=new l(this.block_manager.blockTypes,this.mediator),this.fl_block_controls=new d(this.$wrapper,this.ID,this.mediator),this.formatBar=new h(this.options.formatBar,this.mediator,this),this.mediator.on("block:changePosition",this.changeBlockPosition),this.mediator.on("block-controls:reset",this.resetBlockControls),this.mediator.on("block:limitReached",this.blockLimitReached),this.mediator.on("block:render",this.renderBlock),this.dataStore="Please use store.retrieve();",this._setEvents(),this.$wrapper.prepend(this.fl_block_controls.render().$el),this.$outer.append(this.block_controls.render().$el),i(window).bind("click",this.hideAllTheThings),this.createBlocks(),this.$wrapper.addClass("st-ready"),r.isUndefined(this.onEditorRender)||this.onEditorRender()},createBlocks:function(){var t=this.store.retrieve();t.data.length>0?t.data.forEach(function(t){this.mediator.trigger("block:create",t.type,t.data)},this):this.options.defaultType!==!1&&this.mediator.trigger("block:create",this.options.defaultType,{})},destroy:function(){this.formatBar.destroy(),this.fl_block_controls.destroy(),this.block_controls.destroy(),this.block_manager.blocks.forEach(function(t){this.mediator.trigger("block:remove",t.blockID)},this),this.mediator.stopListening(),this.stopListening(),o.instances=o.instances.filter(function(t){return t.ID!==this.ID},this),this.store.reset(),this.$outer.replaceWith(this.$el.detach())},reinitialize:function(t){this.destroy(),this.initialize(t||this.options)},resetBlockControls:function(){this.block_controls.renderInContainer(this.$wrapper),this.block_controls.hide()},blockLimitReached:function(t){this.$wrapper.toggleClass("st--block-limit-reached",t)},_setEvents:function(){Object.keys(this.events).forEach(function(t){u.on(t,this[this.events[t]],this)},this)},hideAllTheThings:function(){this.block_controls.hide(),this.formatBar.hide()},store:function(t,e){return s.log("The store method has been removed, please call store[methodName]"),this.store[t].call(this,e||{})},renderBlock:function(t){this._renderInPosition(t.render().$el),this.hideAllTheThings(),t.trigger("onRender")},removeBlockDragOver:function(){this.$outer.find(".st-drag-over").removeClass("st-drag-over")},changeBlockPosition:function(t,e){e-=1;var n=this.getBlockPosition(t),r=this.$wrapper.find(".st-block").eq(e),i=n>e?"Before":"After";r&&r.attr("id")!==t.attr("id")&&(this.hideAllTheThings(),t["insert"+i](r))},_renderInPosition:function(t){this.block_controls.currentContainer?this.block_controls.currentContainer.after(t):this.$wrapper.append(t)},validateAndSaveBlock:function(t,e){if((!o.skipValidation||e)&&!t.valid())return this.mediator.trigger("errors:add",{text:r.result(t,"validationFailMsg")}),void s.log("Block "+t.blockID+" failed validation");var n=t.getData();s.log("Adding data for block "+t.blockID+" to block store:",n),this.store.addData(n)},onFormSubmit:function(t){return t=t===!1?!1:!0,s.log("Handling form submission for Editor "+this.ID),this.mediator.trigger("errors:reset"),this.store.reset(),this.validateBlocks(t),this.block_manager.validateBlockTypesExist(t),this.mediator.trigger("errors:render"),this.$el.val(this.store.toString()),this.errorHandler.errors.length},validateBlocks:function(t){var e=this;this.$wrapper.find(".st-block").each(function(n,o){var s=e.block_manager.findBlockById(i(o).attr("id"));r.isUndefined(s)||e.validateAndSaveBlock(s,t)})},findBlockById:function(t){return this.block_manager.findBlockById(t)},getBlocksByType:function(t){return this.block_manager.getBlocksByType(t)},getBlocksByIDs:function(t){return this.block_manager.getBlocksByIDs(t)},getBlockPosition:function(t){return this.$wrapper.find(".st-block").index(t)},_ensureAndSetElements:function(){if(r.isUndefined(this.options.el)||r.isEmpty(this.options.el))return s.log("You must provide an el"),!1;this.$el=this.options.el,this.el=this.options.el[0],this.$form=this.$el.parents("form");var t=i("<div>").attr({id:this.ID,"class":"st-outer",dropzone:"copy link move"}),e=i("<div>").attr({"class":"st-blocks"});return this.$el.wrap(t).wrap(e),this.$outer=this.$form.find("#"+this.ID),this.$wrapper=this.$outer.find(".st-blocks"),!0}}),e.exports=v}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./block-controls":139,"./block-manager":141,"./config":162,"./error-handler":164,"./event-bus":165,"./events":166,"./extensions/editor-store":167,"./floating-block-controls":170,"./form-events":171,"./format-bar":172,"./function-bind":173,"./lodash":178,"./utils":184}],164:[function(t,e){(function(n){"use strict";var r=t("./lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,o=function(t,e,n){this.$wrapper=t,this.mediator=e,this.$el=n,r.isUndefined(this.$el)&&(this._ensureElement(),this.$wrapper.prepend(this.$el)),this.$el.hide(),this._bindFunctions(),this._bindMediatedEvents(),this.initialize()};Object.assign(o.prototype,t("./function-bind"),t("./mediated-events"),t("./renderable"),{errors:[],className:"st-errors",eventNamespace:"errors",mediatedEvents:{reset:"reset",add:"addMessage",render:"render"},initialize:function(){var t=i("<ul>");this.$el.append("<p>"+i18n.t("errors:title")+"</p>").append(t),this.$list=t},render:function(){return 0===this.errors.length?!1:(this.errors.forEach(this.createErrorItem,this),void this.$el.show())},createErrorItem:function(t){var e=i("<li>",{"class":"st-errors__msg",html:t.text});this.$list.append(e)},addMessage:function(t){this.errors.push(t)},reset:function(){return 0===this.errors.length?!1:(this.errors=[],this.$list.html(""),void this.$el.hide())}}),e.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./function-bind":173,"./lodash":178,"./mediated-events":179,
"./renderable":180}],165:[function(t,e){"use strict";e.exports=Object.assign({},t("./events"))},{"./events":166}],166:[function(t,e){"use strict";e.exports=t("eventablejs")},{eventablejs:3}],167:[function(t,e){"use strict";var n=t("../lodash"),r=t("../utils"),i=function(t,e){this.mediator=e,this.initialize(t?t.trim():"")};Object.assign(i.prototype,{initialize:function(t){this.store=this._parseData(t)||{data:[]}},retrieve:function(){return this.store},toString:function(t){return JSON.stringify(this.store,void 0,t)},reset:function(){r.log("Resetting the EditorStore"),this.store={data:[]}},addData:function(t){return this.store.data.push(t),this.store},_parseData:function(t){var e;if(0===t.length)return e;try{var r=JSON.parse(t);n.isUndefined(r.data)||(e=r)}catch(i){this.mediator.trigger("errors:add",{text:i18n.t("errors:load_fail")}),this.mediator.trigger("errors:render"),console.log("Sorry there has been a problem with parsing the JSON"),console.log(i)}return e}}),e.exports=i},{"../lodash":178,"../utils":184}],168:[function(t,e){(function(n){"use strict";var r=t("../lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,o=t("../config"),s=t("../utils"),a=t("../event-bus");e.exports=function(t,e,n,u){a.trigger("onUploadStart");var c=[t.blockID,(new Date).getTime(),"raw"].join("-"),l=new FormData;l.append("attachment[name]",e.name),l.append("attachment[file]",e),l.append("attachment[uid]",c),t.resetMessages();var f=function(){s.log("Upload callback called"),a.trigger("onUploadStop"),!r.isUndefined(n)&&r.isFunction(n)&&n.apply(t,arguments)},d=function(e,n){s.log("Upload callback error called"),a.trigger("onUploadStop"),!r.isUndefined(u)&&r.isFunction(u)&&u.call(t,n)},h=i.ajax({url:o.defaults.uploadUrl,data:l,cache:!1,contentType:!1,processData:!1,dataType:"json",type:"POST"});return t.addQueuedItem(c,h),h.done(f).fail(d).always(t.removeQueuedItem.bind(t,c)),h}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../config":162,"../event-bus":165,"../lodash":178,"../utils":184}],169:[function(t,e){(function(n){"use strict";var r="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,i=t("../utils"),o=t("../event-bus"),s=function(t){this.$form=t,this.initialize()};Object.assign(s.prototype,{initialize:function(){this.submitBtn=this.$form.find("input[type='submit']");var t=[];this.submitBtn.each(function(e,n){t.push(r(n).attr("value"))}),this.submitBtnTitles=t,this.canSubmit=!0,this.globalUploadCount=0,this._bindEvents()},setSubmitButton:function(t,e){this.submitBtn.attr("value",e)},resetSubmitButton:function(){var t=this.submitBtnTitles;this.submitBtn.each(function(e,n){r(n).attr("value",t[e])})},onUploadStart:function(){this.globalUploadCount++,i.log("onUploadStart called "+this.globalUploadCount),1===this.globalUploadCount&&this._disableSubmitButton()},onUploadStop:function(){this.globalUploadCount=this.globalUploadCount<=0?0:this.globalUploadCount-1,i.log("onUploadStop called "+this.globalUploadCount),0===this.globalUploadCount&&this._enableSubmitButton()},onError:function(){i.log("onError called"),this.canSubmit=!1},_disableSubmitButton:function(t){this.setSubmitButton(null,t||i18n.t("general:wait")),this.submitBtn.attr("disabled","disabled").addClass("disabled")},_enableSubmitButton:function(){this.resetSubmitButton(),this.submitBtn.removeAttr("disabled").removeClass("disabled")},_events:{disableSubmitButton:"_disableSubmitButton",enableSubmitButton:"_enableSubmitButton",setSubmitButton:"setSubmitButton",resetSubmitButton:"resetSubmitButton",onError:"onError",onUploadStart:"onUploadStart",onUploadStop:"onUploadStop"},_bindEvents:function(){Object.keys(this._events).forEach(function(t){o.on(t,this[this._events[t]],this)},this)}}),e.exports=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../event-bus":165,"../utils":184}],170:[function(t,e){(function(n){"use strict";var r=t("./lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,o=t("./event-bus"),s=function(t,e,n){this.$wrapper=t,this.instance_id=e,this.mediator=n,this._ensureElement(),this._bindFunctions(),this.initialize()};Object.assign(s.prototype,t("./function-bind"),t("./renderable"),t("./events"),{className:"st-block-controls__top",attributes:function(){return{"data-icon":"add"}},bound:["handleBlockMouseOut","handleBlockMouseOver","handleBlockClick","onDrop"],initialize:function(){this.$el.on("click",this.handleBlockClick).dropArea().bind("drop",this.onDrop),this.$wrapper.on("mouseover",".st-block",this.handleBlockMouseOver).on("mouseout",".st-block",this.handleBlockMouseOut).on("click",".st-block--with-plus",this.handleBlockClick)},onDrop:function(t){t.preventDefault();var e=this.$el,n=t.originalEvent.dataTransfer.getData("text/plain"),s=i("#"+n);r.isUndefined(n)||r.isEmpty(s)||e.attr("id")===n||this.instance_id!==s.attr("data-instance")||e.after(s),o.trigger("block:reorder:dropped",n)},handleBlockMouseOver:function(t){var e=i(t.currentTarget);e.hasClass("st-block--with-plus")||e.addClass("st-block--with-plus")},handleBlockMouseOut:function(t){var e=i(t.currentTarget);e.hasClass("st-block--with-plus")&&e.removeClass("st-block--with-plus")},handleBlockClick:function(t){t.stopPropagation(),this.mediator.trigger("block-controls:render",i(t.currentTarget))}}),e.exports=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./event-bus":165,"./events":166,"./function-bind":173,"./lodash":178,"./renderable":180}],171:[function(t,e){"use strict";var n=t("./config"),r=t("./utils"),i=t("./event-bus"),o=t("./extensions/submittable"),s=!1,a={bindFormSubmit:function(t){s||(new o(t),t.bind("submit",this.onFormSubmit),s=!0)},onBeforeSubmit:function(t){var e=0;return n.instances.forEach(function(n){e+=n.onFormSubmit(t)}),r.log("Total errors: "+e),e},onFormSubmit:function(t){var e=a.onBeforeSubmit();e>0&&(i.trigger("onError"),t.preventDefault())}};e.exports=a},{"./config":162,"./event-bus":165,"./extensions/submittable":169,"./utils":184}],172:[function(t,e){(function(n){"use strict";var r=t("./lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,o=t("./config"),s=t("./utils"),a=function(t,e,n){this.editor=n,this.options=Object.assign({},o.defaults.formatBar,t||{}),this.commands=this.options.commands,this.mediator=e,this._ensureElement(),this._bindFunctions(),this._bindMediatedEvents(),this.initialize.apply(this,arguments)};Object.assign(a.prototype,t("./function-bind"),t("./mediated-events"),t("./events"),t("./renderable"),{className:"st-format-bar",bound:["onFormatButtonClick","renderBySelection","hide"],eventNamespace:"formatter",mediatedEvents:{position:"renderBySelection",show:"show",hide:"hide"},initialize:function(){this.$btns=[],this.commands.forEach(function(t){var e=i("<button>",{"class":"st-format-btn st-format-btn--"+t.name+" "+(t.iconName?"st-icon":""),text:t.text,"data-cmd":t.cmd});this.$btns.push(e),e.appendTo(this.$el)},this),this.$b=i(document)},hide:function(){this.$el.removeClass("st-format-bar--is-ready"),this.$el.remove()},show:function(){this.editor.$outer.append(this.$el),this.$el.addClass("st-format-bar--is-ready"),this.$el.bind("click",".st-format-btn",this.onFormatButtonClick)},remove:function(){this.$el.remove()},renderBySelection:function(){this.highlightSelectedButtons(),this.show(),this.calculatePosition()},calculatePosition:function(){var t=window.getSelection(),e=t.getRangeAt(0),n=e.getBoundingClientRect(),r={},i=this.editor.$outer.get(0),o=i.getBoundingClientRect();r.top=n.top-o.top+"px",r.left=(n.left+n.right)/2-this.el.offsetWidth/2-o.left+"px",this.$el.css(r)},highlightSelectedButtons:function(){var t=s.getBlockBySelection();this.$btns.forEach(function(e){var n=i(e).data("cmd");e.toggleClass("st-format-btn--is-active",t.queryTextBlockCommandState(n))},this)},onFormatButtonClick:function(t){t.stopPropagation();var e=s.getBlockBySelection();if(r.isUndefined(e))throw"Associated block not found";var n=i(t.target),o=n.data("cmd");return r.isUndefined(o)?!1:(e.execTextBlockCommand(o),this.highlightSelectedButtons(),!1)}}),e.exports=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./config":162,"./events":166,"./function-bind":173,"./lodash":178,"./mediated-events":179,"./renderable":180,"./utils":184}],173:[function(t,e){"use strict";e.exports={bound:[],_bindFunctions:function(){this.bound.forEach(function(t){this[t]=this[t].bind(this)},this)}}},{}],174:[function(){(function(t){"use strict";function e(t){t.preventDefault()}function n(t){t.originalEvent.dataTransfer.dropEffect="copy",i(t.currentTarget).addClass("st-drag-over"),t.preventDefault()}function r(t){i(t.currentTarget).removeClass("st-drag-over"),t.preventDefault()}var i="undefined"!=typeof window?window.$:"undefined"!=typeof t?t.$:null;i.fn.dropArea=function(){return this.bind("dragenter",e).bind("dragover",n).bind("dragleave",r),this},i.fn.noDropArea=function(){return this.unbind("dragenter").unbind("dragover").unbind("dragleave"),this},i.fn.caretToEnd=function(){var t,e;return t=document.createRange(),t.selectNodeContents(this[0]),t.collapse(!1),e=window.getSelection(),e.removeAllRanges(),e.addRange(t),this}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],175:[function(t,e){"use strict";e.exports=function(t,e){var n,r=this;n=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return r.apply(this,arguments)},Object.assign(n,r,e);var i=function(){this.constructor=n};return i.prototype=r.prototype,n.prototype=new i,t&&Object.assign(n.prototype,t),n.__super__=r.prototype,n}},{}],176:[function(t,e){"use strict";var n=t("./lodash");t("object.assign").shim(),t("array.prototype.find"),t("./vendor/array-includes"),t("./helpers/event");var r=t("./utils"),i={config:t("./config"),log:r.log,Locales:t("./locales"),Events:t("./events"),EventBus:t("./event-bus"),EditorStore:t("./extensions/editor-store"),Submittable:t("./extensions/submittable"),FileUploader:t("./extensions/file-uploader"),BlockMixins:t("./block_mixins"),BlockPositioner:t("./block-positioner"),BlockReorder:t("./block-reorder"),BlockDeletion:t("./block-deletion"),BlockValidations:t("./block-validations"),BlockStore:t("./block-store"),BlockManager:t("./block-manager"),SimpleBlock:t("./simple-block"),Block:t("./block"),Blocks:t("./blocks"),BlockControl:t("./block-control"),BlockControls:t("./block-controls"),FloatingBlockControls:t("./floating-block-controls"),FormatBar:t("./format-bar"),Editor:t("./editor"),toMarkdown:t("./to-markdown"),toHTML:t("./to-html"),setDefaults:function(t){Object.assign(i.config.defaults,t||{})},getInstance:r.getInstance,setBlockOptions:function(t,e){var r=i.Blocks[t];n.isUndefined(r)||Object.assign(r.prototype,e||{})},runOnAllInstances:function(t){if(i.Editor.prototype.hasOwnProperty(t)){var e=Array.prototype.slice.call(arguments,1);Array.prototype.forEach.call(i.config.instances,function(n){n[t].apply(null,e)})}else i.log("method doesn't exist")}};Object.assign(i,t("./form-events")),e.exports=i},{"./block":146,"./block-control":138,"./block-controls":139,"./block-deletion":140,"./block-manager":141,"./block-positioner":142,"./block-reorder":143,"./block-store":144,"./block-validations":145,"./block_mixins":151,"./blocks":156,"./config":162,"./editor":163,"./event-bus":165,"./events":166,"./extensions/editor-store":167,"./extensions/file-uploader":168,"./extensions/submittable":169,"./floating-block-controls":170,"./form-events":171,"./format-bar":172,"./helpers/event":174,"./locales":177,"./lodash":178,"./simple-block":181,"./to-html":182,"./to-markdown":183,"./utils":184,"./vendor/array-includes":185,"array.prototype.find":2,"object.assign":51}],177:[function(t,e){"use strict";var n=t("./lodash"),r=t("./config"),i=t("./utils"),o={en:{general:{"delete":"Delete?",drop:"Drag __block__ here",paste:"Or paste URL here",upload:"...or choose a file",close:"close",position:"Position",wait:"Please wait...",link:"Enter a link"},errors:{title:"You have the following errors:",validation_fail:"__type__ block is invalid",block_empty:"__name__ must not be empty",type_missing:"You must have a block of type __type__",required_type_empty:"A required block type __type__ is empty",load_fail:"There was a problem loading the contents of the document"},blocks:{text:{title:"Text"},list:{title:"List"},quote:{title:"Quote",credit_field:"Credit"},image:{title:"Image",upload_error:"There was a problem with your upload"},video:{title:"Video"},tweet:{title:"Tweet",fetch_error:"There was a problem fetching your tweet"},embedly:{title:"Embedly",fetch_error:"There was a problem fetching your embed",key_missing:"An Embedly API key must be present"},heading:{title:"Heading"}}}};void 0===window.i18n?(i.log("Using i18n stub"),window.i18n={t:function(t,e){var i,s,a,u,c=t.split(":");for(s=o[r.language],u=0;u<c.length;u++)a=c[u],n.isUndefined(s[a])||(s=s[a]);return i=s,n.isString(i)?(i.indexOf("__")>=0&&Object.keys(e).forEach(function(t){i=i.replace("__"+t+"__",e[t])}),i):""}}):(i.log("Using i18next"),i18n.init({resStore:o,fallbackLng:r.language,ns:{namespaces:["general","blocks"],defaultNs:"general"}})),e.exports=o},{"./config":162,"./lodash":178,"./utils":184}],178:[function(t,e,n){"use strict";n.isEmpty=t("lodash.isempty"),n.isFunction=t("lodash.isfunction"),n.isObject=t("lodash.isobject"),n.isString=t("lodash.isstring"),n.isUndefined=t("lodash.isundefined"),n.result=t("lodash.result"),n.template=t("lodash.template"),n.uniqueId=t("lodash.uniqueid")},{"lodash.isempty":4,"lodash.isfunction":28,"lodash.isobject":29,"lodash.isstring":31,"lodash.isundefined":32,"lodash.result":33,"lodash.template":34,"lodash.uniqueid":50}],179:[function(t,e){"use strict";e.exports={mediatedEvents:{},eventNamespace:null,_bindMediatedEvents:function(){Object.keys(this.mediatedEvents).forEach(function(t){var e=this.mediatedEvents[t];t=this.eventNamespace?this.eventNamespace+":"+t:t,this.mediator.on(t,this[e].bind(this))},this)}}},{}],180:[function(t,e){(function(n){"use strict";var r=t("./lodash"),i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null;e.exports={tagName:"div",className:"sir-trevor__view",attributes:{},$:function(t){return this.$el.find(t)},render:function(){return this},destroy:function(){r.isUndefined(this.stopListening)||this.stopListening(),this.$el.remove()},_ensureElement:function(){if(this.el)this._setElement(this.el);else{var t,e=Object.assign({},r.result(this,"attributes"));this.id&&(e.id=this.id),this.className&&(e["class"]=this.className),e.html&&(t=e.html,delete e.html);var n=i("<"+this.tagName+">").attr(e);t&&n.html(t),this._setElement(n)}},_setElement:function(t){return this.$el=i(t),this.el=this.$el[0],this}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lodash":178}],181:[function(t,e){(function(n){"use strict";var r=t("./lodash"),i=t("./utils"),o="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,s=t("./block-reorder"),a=function(t,e,n,i){this.createStore(t),this.blockID=r.uniqueId("st-block-"),this.instanceID=e,this.mediator=n,this.options=i||{},this._ensureElement(),this._bindFunctions(),this.initialize.apply(this,arguments)};Object.assign(a.prototype,t("./function-bind"),t("./events"),t("./renderable"),t("./block-store"),{focus:function(){},valid:function(){return!0},className:"st-block",block_template:r.template("<div class='st-block__inner'><%= editor_html %></div>"),attributes:function(){return{id:this.blockID,"data-type":this.type,"data-instance":this.instanceID}},title:function(){return i.titleize(this.type.replace(/[\W_]/g," "))},blockCSSClass:function(){return this.blockCSSClass=i.toSlug(this.type),this.blockCSSClass},type:"","class":function(){return i.classify(this.type)},editorHTML:"",initialize:function(){},onBlockRender:function(){},beforeBlockRender:function(){},_setBlockInner:function(){var t=r.result(this,"editorHTML");this.$el.append(this.block_template({editor_html:t})),this.$inner=this.$el.find(".st-block__inner"),this.$inner.bind("click mouseover",function(t){t.stopPropagation()})},render:function(){return this.beforeBlockRender(),this._setBlockInner(),this._blockPrepare(),this},_blockPrepare:function(){this._initUI(),this._initMessages(),this.checkAndLoadData(),this.$el.addClass("st-item-ready"),this.on("onRender",this.onBlockRender),this.save()},_withUIComponent:function(t,e,n){this.$ui.append(t.render().$el),e&&n&&this.$ui.on("click",e,n)},_initUI:function(){var t=o("<div>",{"class":"st-block__ui"});this.$inner.append(t),this.$ui=t,this._initUIComponents()},_initMessages:function(){var t=o("<div>",{"class":"st-block__messages"});this.$inner.prepend(t),this.$messages=t},addMessage:function(t,e){var n=o("<span>",{html:t,"class":"st-msg "+e});return this.$messages.append(n).addClass("st-block__messages--is-visible"),n},resetMessages:function(){this.$messages.html("").removeClass("st-block__messages--is-visible")},_initUIComponents:function(){this._withUIComponent(new s(this.$el))}}),a.fn=a.prototype,a.extend=t("./helpers/extend"),e.exports=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./block-reorder":143,"./block-store":144,"./events":166,"./function-bind":173,"./helpers/extend":175,"./lodash":178,"./renderable":180,"./utils":184}],182:[function(t,e){"use strict";var n=t("./lodash"),r=t("./utils");e.exports=function(e,i){var o=t("./blocks");i=r.classify(i);var s=e,a="Text"===i;n.isUndefined(a)&&(a=!1),a&&(s="<p>"+s),s=s.replace(/\[([^\]]+)\]\(([^\)]+)\)/gm,function(t,e,n){return"<a href='"+n+"'>"+e.replace(/\n/g,"")+"</a>"}),s=r.reverse(r.reverse(s).replace(/_(?!\\)((_\\|[^_])*)_(?=$|[^\\])/gm,function(t,e){return">i/<"+e.replace(/\n/g,"").replace(/[\s]+$/,"")+">i<"}).replace(/\*\*(?!\\)((\*\*\\|[^\*\*])*)\*\*(?=$|[^\\])/gm,function(t,e){return">b/<"+e.replace(/\n/g,"").replace(/[\s]+$/,"")+">b<"})),s=s.replace(/^\> (.+)$/gm,"$1");var u;return o.hasOwnProperty(i)&&(u=o[i],!n.isUndefined(u.prototype.toHTML)&&n.isFunction(u.prototype.toHTML)&&(s=u.prototype.toHTML(s))),a&&(s=s.replace(/\n\s*\n/gm,"</p><p>"),s=s.replace(/\n/gm,"<br>")),s=s.replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/\n/g,"<br>").replace(/\*\*/,"").replace(/__/,""),s=s.replace(/\\\*/g,"*").replace(/\\\[/g,"[").replace(/\\\]/g,"]").replace(/\\\_/g,"_").replace(/\\\(/g,"(").replace(/\\\)/g,")").replace(/\\\-/g,"-"),a&&(s+="</p>"),s}},{"./blocks":156,"./lodash":178,"./utils":184}],183:[function(t,e){"use strict";var n=t("./lodash"),r=t("./utils");e.exports=function(e,i){function o(t,e,r){return n.isUndefined(r)&&(r=""),"**"+e.replace(/<(.)?br(.)?>/g,"")+"**"+r}function s(t,e,r){return n.isUndefined(r)&&(r=""),"_"+e.replace(/<(.)?br(.)?>/g,"")+"_"+r}var a=t("./blocks");i=r.classify(i);var u=e;u=u.replace(/&nbsp;/g," "),u=u.replace(/( class=(")?Mso[a-zA-Z]+(")?)/g,"").replace(/<!--(.*?)-->/g,"").replace(/\/\*(.*?)\*\//g,"").replace(/<(\/)*(meta|link|span|\\?xml:|st1:|o:|font)(.*?)>/gi,"");var c,l,f=["style","script","applet","embed","noframes","noscript"];for(l=0;l<f.length;l++)c=new RegExp("<"+f[l]+".*?"+f[l]+"(.*?)>","gi"),u=u.replace(c,"");u=u.replace(/\*/g,"\\*").replace(/\[/g,"\\[").replace(/\]/g,"\\]").replace(/\_/g,"\\_").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\-/g,"\\-");var d=["em","i","strong","b"];for(l=0;l<d.length;l++)c=new RegExp("<"+d[l]+"><br></"+d[l]+">","gi"),u=u.replace(c,"<br>");u=u.replace(/<(\w+)(?:\s+\w+="[^"]+(?:"\$[^"]+"[^"]+)?")*>\s*<\/\1>/gim,"").replace(/\n/gm,"").replace(/<a.*?href=[""'](.*?)[""'].*?>(.*?)<\/a>/gim,function(t,e,n){return"["+n.trim().replace(/<(.)?br(.)?>/g,"")+"]("+e+")"}).replace(/<strong>(?:\s*)(.*?)(\s)*?<\/strong>/gim,o).replace(/<b>(?:\s*)(.*?)(\s*)?<\/b>/gim,o).replace(/<em>(?:\s*)(.*?)(\s*)?<\/em>/gim,s).replace(/<i>(?:\s*)(.*?)(\s*)?<\/i>/gim,s),u=u.replace(/([^<>]+)(<div>)/g,"$1\n$2").replace(/<div><div>/g,"\n<div>").replace(/(?:<div>)([^<>]+)(?:<div>)/g,"$1\n").replace(/(?:<div>)(?:<br>)?([^<>]+)(?:<br>)?(?:<\/div>)/g,"$1\n").replace(/<\/p>/g,"\n\n").replace(/<(.)?br(.)?>/g,"\n").replace(/&lt;/g,"<").replace(/&gt;/g,">");var h;return a.hasOwnProperty(i)&&(h=a[i],!n.isUndefined(h.prototype.toMarkdown)&&n.isFunction(h.prototype.toMarkdown)&&(u=h.prototype.toMarkdown(u))),u=u.replace(/<\/?[^>]+(>|$)/g,"")}},{"./blocks":156,"./lodash":178,"./utils":184}],184:[function(t,e){(function(n){"use strict";var r="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,i=t("./lodash"),o=t("./config"),s=/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/,a={getInstance:function(t){return i.isUndefined(t)?o.instances[0]:i.isString(t)?o.instances.find(function(e){return e.ID===t}):o.instances[t]},getInstanceBySelection:function(){return a.getInstance(r(window.getSelection().anchorNode).parents(".st-block").data("instance"))},getBlockBySelection:function(){return a.getInstanceBySelection().findBlockById(r(window.getSelection().anchorNode).parents(".st-block").get(0).id)},log:function(){!i.isUndefined(console)&&o.debug&&console.log.apply(console,arguments)},isURI:function(t){return s.test(t)},titleize:function(t){return null===t?"":(t=String(t).toLowerCase(),t.replace(/(?:^|\s|-)\S/g,function(t){return t.toUpperCase()}))},classify:function(t){return a.titleize(String(t).replace(/[\W_]/g," ")).replace(/\s/g,"")},capitalize:function(t){return t.charAt(0).toUpperCase()+t.substring(1).toLowerCase()},flatten:function(t){var e={};return(Array.isArray(t)?t:Object.keys(t)).forEach(function(t){e[t]=!0}),e},underscored:function(t){return t.trim().replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},reverse:function(t){return t.split("").reverse().join("")},toSlug:function(t){return t.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-")}};e.exports=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./config":162,"./lodash":178}],185:[function(){"use strict";[].includes||(Array.prototype.includes=function(t){if(void 0===this||null===this)throw new TypeError("Cannot convert this value to object");var e=Object(this),n=parseInt(e.length)||0;if(0===n)return!1;var r,i=parseInt(arguments[1])||0;for(i>=0?r=i:(r=n+i,0>r&&(r=0));n>r;){var o=e[r];if(t===o||t!==t&&o!==o)return!0;r++}return!1})},{}]},{},[1])(1)});